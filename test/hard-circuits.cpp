// This file contains many quantum circuits that are expected to be hard to simulate using DDs.

#include "dd/Definitions.hpp"
#include "dd/Export.hpp"
#include "dd/GateMatrixDefinitions.hpp"
#include "dd/LimTable.hpp"
#include "dd/Package.hpp"
#include "dd/QuantumCircuitSimulation.hpp"
#include "dd/QuantumGate.hpp"

#include "gmock/gmock.h"
#include "gtest/gtest.h"
#include <iomanip>
#include <memory>
#include <random>
#include <sstream>

using namespace dd::literals;

// Randomly generated circuit on 3 qubis, containing 30 gates.
TEST(LimTest, hardCircuit_3) {
dd::QuantumCircuit circuit(3);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Ymat, 2_pc, 0_nc, 1);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Hmat, 1_nc, 2_nc, 0);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 0_nc, 2_pc, 1);
circuit.addGate(dd::Tdagmat, 2_nc, 0);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tmat, 0_nc, 1);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 2_nc, 0_nc, 1);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Ymat, 1_pc, 2_pc, 0);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 4 qubis, containing 40 gates.
TEST(LimTest, hardCircuit_4) {
dd::QuantumCircuit circuit(4);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 1_pc, 0_pc, 2);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 1_pc, 2_nc, 0);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Smat, 1_nc, 2);
circuit.addGate(dd::Xmat, 0_pc, 2_pc, 3);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Zmat, 2_pc, 0);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Tmat, 2_pc, 0);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Zmat, 1_nc, 2);
circuit.addGate(dd::Zmat, 0_nc, 1_nc, 3);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Hmat, 3_pc, 2);
circuit.addGate(dd::Tmat, 0_nc, 2);
circuit.addGate(dd::Smat, 3_pc, 2_pc, 0);
circuit.addGate(dd::Ymat, 0_pc, 3);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Smat, 0_pc, 2);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Xmat, 1_nc, 2);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 2_pc, 3_nc, 0);
circuit.addGate(dd::Hmat, 0_pc, 1);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Ymat, 1_pc, 0_pc, 2);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Hmat, 0_pc, 2_nc, 3);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 5 qubis, containing 50 gates.
TEST(LimTest, hardCircuit_5) {
dd::QuantumCircuit circuit(5);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 1_pc, 0);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Ymat, 4_nc, 1);
circuit.addGate(dd::Ymat, 1_pc, 0_pc, 2);
circuit.addGate(dd::Tdagmat, 0_nc, 4_pc, 1);
circuit.addGate(dd::Hmat, 2_pc, 1);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tmat, 3_nc, 1_pc, 2);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Smat, 4_pc, 0_nc, 2);
circuit.addGate(dd::Ymat, 0_nc, 3);
circuit.addGate(dd::Smat, 2_pc, 4);
circuit.addGate(dd::Hmat, 2_nc, 1);
circuit.addGate(dd::Hmat, 0_pc, 2);
circuit.addGate(dd::Smat, 1_pc, 3_pc, 0);
circuit.addGate(dd::Hmat, 1_nc, 2_nc, 3);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tdagmat, 0_pc, 3);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Hmat, 3_pc, 1_nc, 0);
circuit.addGate(dd::Zmat, 2_nc, 4);
circuit.addGate(dd::Xmat, 1_pc, 2);
circuit.addGate(dd::Smat, 2_pc, 1_pc, 4);
circuit.addGate(dd::Xmat, 3_nc, 0_nc, 4);
circuit.addGate(dd::Ymat, 1_pc, 2);
circuit.addGate(dd::Tmat, 2_pc, 4_pc, 3);
circuit.addGate(dd::Hmat, 2_nc, 1_nc, 3);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Smat, 4_nc, 2);
circuit.addGate(dd::Tmat, 1_pc, 2);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Ymat, 1_nc, 2); // triggers an error
circuit.addGate(dd::Xmat, 2);

raceCircuitQMDDvsLIMDD(circuit);
}

TEST(LimTest, hardCircuit_5_minimized) {
dd::QuantumCircuit circuit(5);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 1_pc, 0);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Ymat, 4_nc, 1);
circuit.addGate(dd::Ymat, 1_pc, 0_pc, 2);
circuit.addGate(dd::Tdagmat, 0_nc, 4_pc, 1);
circuit.addGate(dd::Hmat, 2_pc, 1);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tmat, 3_nc, 1_pc, 2);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Zmat, 2);
//circuit.addGate(dd::Tmat, 4);
//circuit.addGate(dd::Smat, 4_pc, 0_nc, 2);
//circuit.addGate(dd::Ymat, 0_nc, 3);
//circuit.addGate(dd::Smat, 2_pc, 4);
//circuit.addGate(dd::Hmat, 2_nc, 1);
//circuit.addGate(dd::Hmat, 0_pc, 2);
//circuit.addGate(dd::Smat, 1_pc, 3_pc, 0);
//circuit.addGate(dd::Hmat, 1_nc, 2_nc, 3);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tdagmat, 0_pc, 3);
circuit.addGate(dd::Tdagmat, 0);
//circuit.addGate(dd::Hmat, 3_pc, 1_nc, 0);
//circuit.addGate(dd::Zmat, 2_nc, 4);
//circuit.addGate(dd::Xmat, 1_pc, 2);
circuit.addGate(dd::Smat, 2_pc, 1_pc, 4);
circuit.addGate(dd::Xmat, 3_nc, 0_nc, 4);
circuit.addGate(dd::Ymat, 1_pc, 2);
//circuit.addGate(dd::Tmat, 2_pc, 4_pc, 3);
//circuit.addGate(dd::Hmat, 2_nc, 1_nc, 3);
//circuit.addGate(dd::Hmat, 1);
//circuit.addGate(dd::Xmat, 1);
//circuit.addGate(dd::Ymat, 3);
//circuit.addGate(dd::Smat, 4_nc, 2);
//circuit.addGate(dd::Tmat, 1_pc, 2);
//circuit.addGate(dd::Hmat, 0);
//circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Ymat, 1_nc, 2); // triggers an error

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 6 qubis, containing 60 gates.
TEST(LimTest, hardCircuit_6) {
dd::QuantumCircuit circuit(6);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Xmat, 5_pc, 1_nc, 0);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Zmat, 1_pc, 3);
circuit.addGate(dd::Smat, 0_nc, 4);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tdagmat, 3_pc, 4);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tdagmat, 0_nc, 2);
circuit.addGate(dd::Xmat, 5_pc, 4_pc, 3);
circuit.addGate(dd::Tdagmat, 3_nc, 5_pc, 0);
circuit.addGate(dd::Xmat, 4_nc, 1);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Smat, 0_nc, 2);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Zmat, 4_nc, 3_nc, 1);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 1_pc, 0);
circuit.addGate(dd::Ymat, 4_pc, 0);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 0_nc, 1_pc, 2);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 1_pc, 5);
circuit.addGate(dd::Hmat, 1_pc, 2);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Ymat, 1_nc, 0);
circuit.addGate(dd::Tdagmat, 3_nc, 2);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Ymat, 3_pc, 5_pc, 0);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Tdagmat, 3_nc, 4_pc, 2);
circuit.addGate(dd::Tmat, 4_nc, 5);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tmat, 1_pc, 2);
circuit.addGate(dd::Zmat, 2_pc, 4_nc, 1);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Hmat, 2_pc, 4_nc, 3);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Ymat, 0_pc, 2_nc, 5);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Tmat, 2);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 7 qubis, containing 70 gates.
TEST(LimTest, hardCircuit_7) {
dd::QuantumCircuit circuit(7);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 3_nc, 5_pc, 4);
circuit.addGate(dd::Smat, 1_pc, 6);
circuit.addGate(dd::Ymat, 6_pc, 5);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Ymat, 1_pc, 2_pc, 5);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Tmat, 5_nc, 1_pc, 4);
circuit.addGate(dd::Xmat, 1_nc, 3);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 5_nc, 6);
circuit.addGate(dd::Smat, 5_nc, 3);
circuit.addGate(dd::Tmat, 1_nc, 6_nc, 0);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Xmat, 3_nc, 6);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 1_nc, 6);
circuit.addGate(dd::Xmat, 3_pc, 4);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Hmat, 2_nc, 6_pc, 4);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 4_pc, 1);
circuit.addGate(dd::Xmat, 6_pc, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Zmat, 5_nc, 0_pc, 6);
circuit.addGate(dd::Hmat, 3_nc, 2);
circuit.addGate(dd::Xmat, 2_pc, 3);
circuit.addGate(dd::Hmat, 6_nc, 1_nc, 2);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 1_pc, 6);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Tdagmat, 0_nc, 2);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Smat, 3_pc, 5_pc, 6);
circuit.addGate(dd::Hmat, 0_nc, 3_pc, 5);
circuit.addGate(dd::Smat, 4_nc, 5_nc, 6);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Zmat, 5_nc, 4_nc, 1);
circuit.addGate(dd::Xmat, 4_pc, 3_nc, 6);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 1_pc, 0);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Hmat, 5_pc, 3_nc, 6);
circuit.addGate(dd::Ymat, 4_nc, 1);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Ymat, 3_pc, 1_nc, 6);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Xmat, 1_nc, 0_nc, 2);
circuit.addGate(dd::Tdagmat, 3_pc, 0);
circuit.addGate(dd::Xmat, 5_nc, 1);
circuit.addGate(dd::Tdagmat, 4_pc, 1_nc, 2);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 8 qubis, containing 80 gates.
TEST(LimTest, hardCircuit_8) {
dd::QuantumCircuit circuit(8);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Tdagmat, 2_nc, 5);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Smat, 2_pc, 4_pc, 7);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 6_nc, 2);
circuit.addGate(dd::Smat, 5_pc, 7_nc, 2);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 2_nc, 5);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Smat, 4_nc, 5);
circuit.addGate(dd::Smat, 2_pc, 0);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Tdagmat, 2_pc, 6);
circuit.addGate(dd::Ymat, 2_nc, 0_nc, 4);
circuit.addGate(dd::Zmat, 1_pc, 0_nc, 6);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Xmat, 7_nc, 5_nc, 6);
circuit.addGate(dd::Ymat, 7_pc, 4_pc, 0);
circuit.addGate(dd::Tmat, 2_pc, 4_pc, 7);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Ymat, 7_pc, 0);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 3_nc, 6);
circuit.addGate(dd::Hmat, 5_nc, 1);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 0_pc, 7_pc, 1);
circuit.addGate(dd::Tmat, 2_nc, 0_pc, 4);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Smat, 2_pc, 7_pc, 0);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Tdagmat, 1_nc, 6_pc, 3);
circuit.addGate(dd::Tmat, 7_pc, 3_pc, 4);
circuit.addGate(dd::Tdagmat, 7_nc, 6);
circuit.addGate(dd::Zmat, 5_nc, 4_nc, 6);
circuit.addGate(dd::Ymat, 1_nc, 6_pc, 3);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Tdagmat, 3_nc, 4);
circuit.addGate(dd::Tdagmat, 3_pc, 2_nc, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 5_pc, 4_pc, 3);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Zmat, 5_nc, 2);
circuit.addGate(dd::Xmat, 2_nc, 7);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 7_pc, 3);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Smat, 6_pc, 1_pc, 0);
circuit.addGate(dd::Hmat, 2_pc, 0_nc, 3);
circuit.addGate(dd::Zmat, 2_nc, 4_pc, 6);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Hmat, 5_nc, 4);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 9 qubis, containing 90 gates.
TEST(LimTest, hardCircuit_9) {
dd::QuantumCircuit circuit(9);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tmat, 4_pc, 7_pc, 8);
circuit.addGate(dd::Ymat, 8_pc, 1_nc, 7);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Hmat, 2_pc, 8);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5_pc, 4_nc, 6);
circuit.addGate(dd::Xmat, 2_pc, 3);
circuit.addGate(dd::Smat, 8_nc, 2);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Smat, 8_pc, 6_pc, 4);
circuit.addGate(dd::Zmat, 7_pc, 2_nc, 3);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tdagmat, 8_pc, 1_nc, 0);
circuit.addGate(dd::Ymat, 4_nc, 1);
circuit.addGate(dd::Tdagmat, 8_pc, 7_pc, 3);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Tmat, 3_nc, 5_pc, 6);
circuit.addGate(dd::Ymat, 4_nc, 2);
circuit.addGate(dd::Hmat, 0_pc, 3_nc, 4);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Xmat, 1_pc, 0_pc, 3);
circuit.addGate(dd::Hmat, 1_nc, 4_pc, 7);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Hmat, 1_pc, 3);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Xmat, 8_nc, 4_nc, 5);
circuit.addGate(dd::Tdagmat, 2_nc, 3_pc, 1);
circuit.addGate(dd::Hmat, 7_nc, 4);
circuit.addGate(dd::Tmat, 4_pc, 8);
circuit.addGate(dd::Smat, 8_nc, 5_pc, 3);
circuit.addGate(dd::Hmat, 7_pc, 1_pc, 3);
circuit.addGate(dd::Tmat, 7_pc, 5);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tmat, 6_nc, 8_nc, 7);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Xmat, 1_pc, 8_pc, 5);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Zmat, 3_pc, 6);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Tdagmat, 1_nc, 0);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Hmat, 2_pc, 8);
circuit.addGate(dd::Tmat, 1_pc, 0_nc, 4);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Tmat, 4_nc, 8);
circuit.addGate(dd::Tmat, 1_pc, 8);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 2_pc, 1);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Smat, 4_nc, 5);
circuit.addGate(dd::Zmat, 2_pc, 1);
circuit.addGate(dd::Hmat, 3_pc, 2_nc, 1);
circuit.addGate(dd::Tdagmat, 2_nc, 8_nc, 7);
circuit.addGate(dd::Smat, 6_nc, 3);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tdagmat, 8_nc, 2);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 7_pc, 6);
circuit.addGate(dd::Tmat, 1_nc, 6_nc, 0);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 5);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 10 qubis, containing 100 gates.
TEST(LimTest, hardCircuit_10) {
dd::QuantumCircuit circuit(10);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tdagmat, 5_pc, 2_pc, 7);
circuit.addGate(dd::Ymat, 8_pc, 7_nc, 0);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Hmat, 7_pc, 9);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 1_nc, 5_pc, 4);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Zmat, 3_nc, 7);
circuit.addGate(dd::Hmat, 8_pc, 3_pc, 4);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 3_pc, 5_nc, 2);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tdagmat, 3_pc, 7_nc, 2);
circuit.addGate(dd::Ymat, 7_pc, 2);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 3_pc, 2_nc, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tmat, 9_nc, 6_nc, 4);
circuit.addGate(dd::Smat, 2_nc, 7_pc, 0);
circuit.addGate(dd::Zmat, 0_nc, 7_pc, 3);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Smat, 0_pc, 3);
circuit.addGate(dd::Ymat, 3_nc, 5_nc, 9);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Xmat, 7_nc, 2);
circuit.addGate(dd::Ymat, 2_pc, 7);
circuit.addGate(dd::Smat, 1_pc, 8);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tdagmat, 7_pc, 3_nc, 0);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Xmat, 4_pc, 7_nc, 5);
circuit.addGate(dd::Zmat, 4_pc, 3);
circuit.addGate(dd::Smat, 7_pc, 5);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Tdagmat, 9_pc, 2_pc, 3);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tmat, 2_nc, 6_nc, 7);
circuit.addGate(dd::Xmat, 8_pc, 6);
circuit.addGate(dd::Tmat, 8_pc, 6_pc, 7);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 2_pc, 3);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tdagmat, 6_nc, 7);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Hmat, 4_pc, 6);
circuit.addGate(dd::Tmat, 2_pc, 0_nc, 6);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tmat, 3_nc, 2);
circuit.addGate(dd::Tmat, 2_pc, 4);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 9_pc, 4);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Smat, 9_nc, 3);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tdagmat, 9_nc, 4_nc, 5);
circuit.addGate(dd::Smat, 4_pc, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 0_nc, 6);
circuit.addGate(dd::Hmat, 6_nc, 0);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Zmat, 0_pc, 1_pc, 4);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Zmat, 1_pc, 0_pc, 7);
circuit.addGate(dd::Ymat, 2_pc, 0_nc, 8);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 8_nc, 5_nc, 4);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 11 qubis, containing 110 gates.
TEST(LimTest, hardCircuit_11) {
dd::QuantumCircuit circuit(11);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Zmat, 7_pc, 1);
circuit.addGate(dd::Tmat, 7_nc, 6_pc, 9);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Zmat, 8_nc, 5);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Xmat, 2_pc, 4_nc, 8);
circuit.addGate(dd::Tdagmat, 2_nc, 6);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Smat, 1_nc, 10);
circuit.addGate(dd::Ymat, 7_nc, 8);
circuit.addGate(dd::Ymat, 6_nc, 4);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Ymat, 10_pc, 3_pc, 6);
circuit.addGate(dd::Tdagmat, 6_nc, 0_pc, 4);
circuit.addGate(dd::Xmat, 0_pc, 8);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Zmat, 9_pc, 2_nc, 6);
circuit.addGate(dd::Tdagmat, 1_pc, 5_nc, 6);
circuit.addGate(dd::Tdagmat, 2_pc, 0);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 10_nc, 2);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Zmat, 3_pc, 9);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Hmat, 1_nc, 8_nc, 9);
circuit.addGate(dd::Xmat, 10_nc, 0);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Xmat, 9_pc, 7_pc, 0);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Zmat, 8_pc, 2);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tdagmat, 7_pc, 9_nc, 1);
circuit.addGate(dd::Hmat, 2_pc, 10_nc, 8);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Hmat, 6_nc, 0);
circuit.addGate(dd::Zmat, 5_pc, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Ymat, 2_pc, 3_nc, 4);
circuit.addGate(dd::Zmat, 4_nc, 10_pc, 7);
circuit.addGate(dd::Ymat, 6_pc, 10_nc, 3);
circuit.addGate(dd::Hmat, 9_pc, 2_pc, 4);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tdagmat, 3_pc, 5_nc, 4);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 0_nc, 4);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Hmat, 7_nc, 3_nc, 5);
circuit.addGate(dd::Xmat, 4_pc, 10_nc, 6);
circuit.addGate(dd::Zmat, 1_pc, 7);
circuit.addGate(dd::Xmat, 3_nc, 4_nc, 5);
circuit.addGate(dd::Xmat, 10_nc, 4_nc, 5);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tmat, 10_pc, 0_pc, 9);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Xmat, 10_nc, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 1_nc, 10_nc, 2);
circuit.addGate(dd::Tmat, 1_pc, 9);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Smat, 4_pc, 5);
circuit.addGate(dd::Tdagmat, 6_pc, 0_nc, 7);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 2_nc, 7_pc, 8);
circuit.addGate(dd::Zmat, 5_nc, 7_pc, 4);
circuit.addGate(dd::Zmat, 7_nc, 10);
circuit.addGate(dd::Hmat, 3_pc, 5_nc, 8);
circuit.addGate(dd::Tmat, 2_nc, 0_nc, 6);
circuit.addGate(dd::Tdagmat, 9_pc, 0_pc, 1);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Xmat, 7);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 12 qubis, containing 120 gates.
TEST(LimTest, hardCircuit_12) {
dd::QuantumCircuit circuit(12);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Zmat, 9_nc, 4_nc, 10);
circuit.addGate(dd::Zmat, 5_pc, 0_nc, 4);
circuit.addGate(dd::Hmat, 2_pc, 6_pc, 7);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Zmat, 0_pc, 10);
circuit.addGate(dd::Xmat, 8_nc, 7_pc, 9);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Ymat, 6_nc, 7);
circuit.addGate(dd::Tdagmat, 1_pc, 0);
circuit.addGate(dd::Ymat, 0_pc, 2);
circuit.addGate(dd::Hmat, 2_nc, 11);
circuit.addGate(dd::Tmat, 1_pc, 11_nc, 9);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 0_pc, 3);
circuit.addGate(dd::Smat, 4_pc, 9);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Xmat, 11_nc, 7_nc, 0);
circuit.addGate(dd::Smat, 3_pc, 7);
circuit.addGate(dd::Xmat, 6_pc, 1_pc, 9);
circuit.addGate(dd::Ymat, 2_nc, 10);
circuit.addGate(dd::Zmat, 6_pc, 4_pc, 2);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 6_nc, 8_pc, 9);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 5_nc, 7);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tmat, 9_nc, 8_pc, 1);
circuit.addGate(dd::Zmat, 2_pc, 11_nc, 5);
circuit.addGate(dd::Hmat, 9_nc, 4);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tdagmat, 9_nc, 3);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Tmat, 4_nc, 5);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tmat, 7_nc, 3);
circuit.addGate(dd::Zmat, 5_nc, 8);
circuit.addGate(dd::Ymat, 3_nc, 11);
circuit.addGate(dd::Ymat, 9_nc, 5);
circuit.addGate(dd::Xmat, 0_nc, 3_nc, 11);
circuit.addGate(dd::Xmat, 1_nc, 11_nc, 4);
circuit.addGate(dd::Tmat, 6_nc, 5_pc, 11);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Smat, 4_pc, 5);
circuit.addGate(dd::Xmat, 10_nc, 6);
circuit.addGate(dd::Xmat, 6_pc, 1_nc, 4);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Zmat, 10_pc, 11_nc, 4);
circuit.addGate(dd::Tdagmat, 1_pc, 7_nc, 5);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Smat, 4_nc, 1_nc, 2);
circuit.addGate(dd::Tdagmat, 10_nc, 2_nc, 9);
circuit.addGate(dd::Smat, 10_pc, 0);
circuit.addGate(dd::Tmat, 6_nc, 1_pc, 3);
circuit.addGate(dd::Ymat, 11_pc, 7);
circuit.addGate(dd::Zmat, 1_nc, 6_pc, 3);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Zmat, 11_pc, 4_nc, 9);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Smat, 2_pc, 0_pc, 3);
circuit.addGate(dd::Tdagmat, 0_nc, 3);
circuit.addGate(dd::Tmat, 9_pc, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tdagmat, 1_nc, 11_pc, 6);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Smat, 2_pc, 1_nc, 5);
circuit.addGate(dd::Smat, 0_pc, 4_pc, 11);
circuit.addGate(dd::Xmat, 7_pc, 2_nc, 0);
circuit.addGate(dd::Zmat, 5_nc, 7);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Tmat, 4_pc, 6_pc, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Zmat, 7_pc, 11_nc, 0);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Smat, 11_pc, 5);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Zmat, 11_nc, 3_nc, 6);
circuit.addGate(dd::Tmat, 0_nc, 8);
circuit.addGate(dd::Tmat, 2_pc, 4);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Hmat, 11_nc, 3_pc, 6);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Xmat, 11_pc, 4);
circuit.addGate(dd::Zmat, 7_nc, 0_nc, 1);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Ymat, 0_pc, 9);
circuit.addGate(dd::Ymat, 5_nc, 9);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tdagmat, 10_pc, 5_nc, 6);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 13 qubis, containing 130 gates.
TEST(LimTest, hardCircuit_13) {
dd::QuantumCircuit circuit(13);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 7_pc, 9);
circuit.addGate(dd::Xmat, 5_pc, 12);
circuit.addGate(dd::Hmat, 8_pc, 3_pc, 12);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Hmat, 12_pc, 8);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tmat, 3_pc, 10_nc, 11);
circuit.addGate(dd::Zmat, 2_nc, 5_nc, 7);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 8_nc, 7);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Zmat, 0_nc, 2);
circuit.addGate(dd::Tmat, 1_pc, 5);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Hmat, 5_pc, 3);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Ymat, 0_nc, 9_nc, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Ymat, 7_nc, 8);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Smat, 12_pc, 5);
circuit.addGate(dd::Tdagmat, 9_nc, 0);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Ymat, 5_pc, 12_nc, 8);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Zmat, 7_pc, 12);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Ymat, 3_pc, 8);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Xmat, 9_nc, 4_nc, 8);
circuit.addGate(dd::Zmat, 0_pc, 11);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Xmat, 2_pc, 1_pc, 4);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tmat, 5_pc, 12);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tdagmat, 0_pc, 11);
circuit.addGate(dd::Zmat, 11_nc, 12_pc, 6);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Xmat, 0_nc, 5_nc, 9);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Hmat, 7_nc, 6);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Smat, 12_pc, 3_pc, 0);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Zmat, 4_pc, 0);
circuit.addGate(dd::Hmat, 1_nc, 8_pc, 5);
circuit.addGate(dd::Tdagmat, 12_pc, 10);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Xmat, 1_nc, 0);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 7_nc, 0_pc, 11);
circuit.addGate(dd::Xmat, 5_nc, 9);
circuit.addGate(dd::Zmat, 3_pc, 10_pc, 7);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Zmat, 1_nc, 8_nc, 2);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 0_pc, 11_nc, 2);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Hmat, 12_nc, 1_nc, 10);
circuit.addGate(dd::Smat, 9_nc, 12_nc, 0);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Hmat, 7_nc, 1);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Ymat, 12_nc, 4_pc, 2);
circuit.addGate(dd::Xmat, 6_pc, 1_nc, 4);
circuit.addGate(dd::Tdagmat, 11_nc, 5);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tdagmat, 5_pc, 1);
circuit.addGate(dd::Ymat, 2_nc, 0);
circuit.addGate(dd::Xmat, 4_nc, 3);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Tdagmat, 11_nc, 5_pc, 1);
circuit.addGate(dd::Ymat, 11_pc, 0_nc, 6);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Ymat, 7_pc, 12_pc, 6);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 6_nc, 11_nc, 5);
circuit.addGate(dd::Tmat, 11_nc, 12_nc, 1);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 7_nc, 0);
circuit.addGate(dd::Xmat, 5_nc, 12);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Tdagmat, 9_nc, 7_pc, 4);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Zmat, 6_pc, 5);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tdagmat, 5_nc, 7);
circuit.addGate(dd::Tdagmat, 1_pc, 5_nc, 4);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 8_pc, 0_nc, 3);
circuit.addGate(dd::Tdagmat, 9_nc, 5_nc, 10);
circuit.addGate(dd::Ymat, 1_nc, 7_nc, 10);
circuit.addGate(dd::Tmat, 5_nc, 2);
circuit.addGate(dd::Smat, 12_nc, 8);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 14 qubis, containing 140 gates.
TEST(LimTest, hardCircuit_14) {
dd::QuantumCircuit circuit(14);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tdagmat, 9_pc, 13);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Ymat, 11_pc, 7_nc, 5);
circuit.addGate(dd::Tmat, 2_nc, 7_nc, 3);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Hmat, 9_pc, 13);
circuit.addGate(dd::Tmat, 13_nc, 8);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 6_pc, 0);
circuit.addGate(dd::Tdagmat, 4_pc, 13);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 3_pc, 13_pc, 6);
circuit.addGate(dd::Tdagmat, 9_nc, 13_nc, 7);
circuit.addGate(dd::Tdagmat, 9_nc, 5_nc, 3);
circuit.addGate(dd::Ymat, 3_pc, 1_nc, 11);
circuit.addGate(dd::Xmat, 12_nc, 13);
circuit.addGate(dd::Smat, 13_pc, 11_nc, 5);
circuit.addGate(dd::Xmat, 5_nc, 4_pc, 10);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Zmat, 13_pc, 4);
circuit.addGate(dd::Hmat, 9_nc, 8_nc, 4);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Zmat, 9_nc, 5_nc, 6);
circuit.addGate(dd::Smat, 5_nc, 3_pc, 12);
circuit.addGate(dd::Smat, 3_nc, 10_pc, 4);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Smat, 7_nc, 4_pc, 5);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Hmat, 12_nc, 6_pc, 10);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Hmat, 1_pc, 4);
circuit.addGate(dd::Ymat, 3_nc, 13_pc, 0);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tdagmat, 7_nc, 12);
circuit.addGate(dd::Xmat, 2_pc, 3);
circuit.addGate(dd::Hmat, 4_pc, 6);
circuit.addGate(dd::Hmat, 0_nc, 7_nc, 3);
circuit.addGate(dd::Xmat, 5_pc, 1);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Zmat, 8_pc, 1_pc, 6);
circuit.addGate(dd::Tmat, 6_pc, 10_pc, 2);
circuit.addGate(dd::Hmat, 1_pc, 0);
circuit.addGate(dd::Zmat, 1_pc, 12);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Hmat, 8_nc, 2);
circuit.addGate(dd::Ymat, 8_nc, 13);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 12_pc, 10);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Zmat, 1_pc, 12);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 10_nc, 3);
circuit.addGate(dd::Tdagmat, 4_pc, 13_nc, 8);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tdagmat, 10_pc, 7);
circuit.addGate(dd::Ymat, 13_nc, 3);
circuit.addGate(dd::Hmat, 2_pc, 4_nc, 3);
circuit.addGate(dd::Smat, 7_nc, 3);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tmat, 9_pc, 1);
circuit.addGate(dd::Tdagmat, 7_nc, 13);
circuit.addGate(dd::Zmat, 0_nc, 8_nc, 11);
circuit.addGate(dd::Zmat, 9_nc, 5);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Xmat, 9_pc, 3);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Smat, 8_nc, 10_pc, 6);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Xmat, 3_pc, 0_pc, 1);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 2_pc, 10);
circuit.addGate(dd::Tdagmat, 0_pc, 11_nc, 8);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4_pc, 3);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Tmat, 9_nc, 8);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 2_pc, 10_nc, 3);
circuit.addGate(dd::Tmat, 13_nc, 5);
circuit.addGate(dd::Xmat, 6_nc, 1_nc, 8);
circuit.addGate(dd::Hmat, 10_pc, 9_pc, 7);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Smat, 8_pc, 4_nc, 5);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 0_pc, 4);
circuit.addGate(dd::Xmat, 3_pc, 12_nc, 13);
circuit.addGate(dd::Zmat, 13_nc, 3_pc, 4);
circuit.addGate(dd::Tmat, 1_pc, 9_nc, 11);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tmat, 0_pc, 12_pc, 6);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 13_pc, 4_nc, 12);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Tmat, 11_nc, 1_nc, 13);
circuit.addGate(dd::Zmat, 11_nc, 8_pc, 12);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Xmat, 7_nc, 10);
circuit.addGate(dd::Ymat, 4_nc, 5);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 15 qubis, containing 150 gates.
TEST(LimTest, hardCircuit_15) {
dd::QuantumCircuit circuit(15);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tdagmat, 14_nc, 12);
circuit.addGate(dd::Tdagmat, 0_pc, 14_pc, 9);
circuit.addGate(dd::Zmat, 3_nc, 8_nc, 11);
circuit.addGate(dd::Tmat, 0_nc, 4_pc, 8);
circuit.addGate(dd::Tmat, 12_pc, 14_nc, 10);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tmat, 12_nc, 9);
circuit.addGate(dd::Ymat, 1_nc, 8);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 1_pc, 5);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 2_pc, 9);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 1_pc, 5_pc, 14);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Ymat, 12_pc, 6_nc, 8);
circuit.addGate(dd::Tdagmat, 8_nc, 14);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Xmat, 0_nc, 3_pc, 1);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 12_nc, 1_pc, 8);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tmat, 8_pc, 12);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10_pc, 12_pc, 1);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tmat, 14_pc, 1);
circuit.addGate(dd::Tmat, 12_nc, 6_nc, 13);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tmat, 11_pc, 13_nc, 1);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Tmat, 6_pc, 10_nc, 7);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Xmat, 12_nc, 11);
circuit.addGate(dd::Hmat, 9_pc, 2_pc, 1);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Tdagmat, 7_nc, 12_nc, 11);
circuit.addGate(dd::Hmat, 9_nc, 0_nc, 4);
circuit.addGate(dd::Tdagmat, 9_nc, 1);
circuit.addGate(dd::Zmat, 9_nc, 3);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Tmat, 5_nc, 12_nc, 6);
circuit.addGate(dd::Zmat, 4_pc, 5_pc, 10);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Zmat, 2_pc, 8);
circuit.addGate(dd::Xmat, 10_pc, 12);
circuit.addGate(dd::Zmat, 13_pc, 0);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Tmat, 6_nc, 9);
circuit.addGate(dd::Tdagmat, 5_pc, 14_nc, 11);
circuit.addGate(dd::Hmat, 6_nc, 11);
circuit.addGate(dd::Ymat, 3_nc, 13);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Smat, 0_pc, 4);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Ymat, 4_nc, 3_nc, 0);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Tdagmat, 5_pc, 3_nc, 8);
circuit.addGate(dd::Ymat, 1_nc, 11_pc, 13);
circuit.addGate(dd::Tdagmat, 12_pc, 7_pc, 13);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 13_nc, 10);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Xmat, 8_pc, 2_nc, 14);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Ymat, 5_nc, 4_nc, 12);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 3_nc, 11);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 9_nc, 10);
circuit.addGate(dd::Smat, 5_pc, 12_nc, 0);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Smat, 11_nc, 14);
circuit.addGate(dd::Smat, 6_nc, 14_nc, 3);
circuit.addGate(dd::Smat, 9_pc, 10_nc, 6);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tdagmat, 12_nc, 6);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Smat, 2_pc, 11);
circuit.addGate(dd::Zmat, 6_nc, 1_pc, 3);
circuit.addGate(dd::Xmat, 11_nc, 5);
circuit.addGate(dd::Zmat, 7_pc, 2);
circuit.addGate(dd::Xmat, 5_pc, 9);
circuit.addGate(dd::Hmat, 9_nc, 6_nc, 12);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Smat, 0_pc, 1);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 5_pc, 8);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tmat, 3_pc, 12_nc, 9);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Ymat, 9_pc, 11);
circuit.addGate(dd::Tdagmat, 10_pc, 14);
circuit.addGate(dd::Tdagmat, 0_nc, 11);
circuit.addGate(dd::Zmat, 8_pc, 14);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Smat, 13_pc, 11);
circuit.addGate(dd::Hmat, 11_pc, 7_nc, 9);
circuit.addGate(dd::Smat, 4_pc, 13);
circuit.addGate(dd::Ymat, 9_nc, 4);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Hmat, 5_nc, 4_pc, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tdagmat, 9_pc, 8);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 16 qubis, containing 160 gates.
TEST(LimTest, hardCircuit_16) {
dd::QuantumCircuit circuit(16);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Tdagmat, 5_nc, 12);
circuit.addGate(dd::Tmat, 1_pc, 2);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 15_nc, 4_nc, 13);
circuit.addGate(dd::Zmat, 1_pc, 12_pc, 13);
circuit.addGate(dd::Ymat, 7_nc, 3_nc, 15);
circuit.addGate(dd::Smat, 8_pc, 4);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Ymat, 5_nc, 0_nc, 4);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Xmat, 0_pc, 1);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 3_pc, 8);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 0_pc, 1_nc, 9);
circuit.addGate(dd::Tmat, 1_nc, 3_nc, 4);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Tdagmat, 15_pc, 0);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Tdagmat, 3_nc, 0);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Zmat, 5_nc, 2);
circuit.addGate(dd::Tmat, 7_pc, 11);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 7_pc, 13_pc, 8);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Tmat, 12_pc, 3);
circuit.addGate(dd::Tmat, 15_nc, 7_nc, 13);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tmat, 4_pc, 15_nc, 13);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 1_nc, 14_pc, 5);
circuit.addGate(dd::Tmat, 3_pc, 2);
circuit.addGate(dd::Xmat, 4_nc, 14_nc, 0);
circuit.addGate(dd::Tdagmat, 0_pc, 15_pc, 3);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Hmat, 12_nc, 1);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Zmat, 2_nc, 4_pc, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 12_nc, 2_pc, 13);
circuit.addGate(dd::Ymat, 9_pc, 2);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Zmat, 7_pc, 0_pc, 6);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Xmat, 2_pc, 11_pc, 6);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 14_pc, 3_pc, 7);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tmat, 13_pc, 10);
circuit.addGate(dd::Xmat, 14_pc, 8);
circuit.addGate(dd::Xmat, 5_pc, 2);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Zmat, 7_nc, 1);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 14_pc, 9_pc, 13);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Xmat, 15_pc, 8);
circuit.addGate(dd::Xmat, 8_pc, 7);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Ymat, 11_nc, 5_nc, 3);
circuit.addGate(dd::Smat, 12_nc, 13);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tdagmat, 5_pc, 7);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Ymat, 7_nc, 2);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Xmat, 7_pc, 14_nc, 10);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 5_nc, 6_nc, 12);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Xmat, 11_nc, 0);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 5_nc, 14);
circuit.addGate(dd::Smat, 5_pc, 11_nc, 14);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Smat, 1_nc, 9);
circuit.addGate(dd::Smat, 6_pc, 10_nc, 8);
circuit.addGate(dd::Hmat, 15_pc, 10);
circuit.addGate(dd::Tmat, 2_nc, 13);
circuit.addGate(dd::Zmat, 13_pc, 14);
circuit.addGate(dd::Tmat, 4_nc, 14);
circuit.addGate(dd::Ymat, 8_pc, 2_nc, 13);
circuit.addGate(dd::Zmat, 2_pc, 14_pc, 5);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Smat, 7_nc, 10);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tdagmat, 15_nc, 3_nc, 7);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Hmat, 13_nc, 6);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Smat, 1_nc, 6_pc, 2);
circuit.addGate(dd::Smat, 13_nc, 14);
circuit.addGate(dd::Tmat, 1_nc, 11);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 0_pc, 11_pc, 6);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tmat, 8_pc, 9);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Ymat, 9_pc, 1);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Smat, 5_nc, 14);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tdagmat, 0_nc, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Smat, 8_nc, 14);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Tdagmat, 5_pc, 14);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Xmat, 14_nc, 10);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Ymat, 8_nc, 12);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 17 qubis, containing 170 gates.
TEST(LimTest, hardCircuit_17) {
dd::QuantumCircuit circuit(17);

circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Tdagmat, 5_pc, 12_pc, 11);
circuit.addGate(dd::Smat, 16_pc, 1_nc, 9);
circuit.addGate(dd::Tmat, 6_nc, 8_nc, 1);
circuit.addGate(dd::Zmat, 15_pc, 14);
circuit.addGate(dd::Zmat, 6_pc, 13);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Xmat, 1_nc, 0_nc, 2);
circuit.addGate(dd::Ymat, 14_pc, 8);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tdagmat, 9_pc, 2_pc, 8);
circuit.addGate(dd::Zmat, 5_pc, 16);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Tmat, 8_nc, 0);
circuit.addGate(dd::Smat, 8_nc, 4_pc, 3);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 4_nc, 12);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Tmat, 10_nc, 1_nc, 4);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Hmat, 16_pc, 14);
circuit.addGate(dd::Hmat, 13_nc, 11_nc, 7);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Xmat, 4_pc, 15);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Zmat, 7_pc, 10_pc, 4);
circuit.addGate(dd::Ymat, 7_nc, 14_pc, 9);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tmat, 15_pc, 16);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 0_nc, 11_pc, 3);
circuit.addGate(dd::Smat, 16_pc, 14);
circuit.addGate(dd::Smat, 2_nc, 11_pc, 0);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Ymat, 9_nc, 14);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Ymat, 5_nc, 8);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 15_pc, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Xmat, 5_pc, 13_nc, 6);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Xmat, 3_nc, 5);
circuit.addGate(dd::Tdagmat, 5_pc, 11_nc, 1);
circuit.addGate(dd::Tmat, 8_pc, 15);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Hmat, 5_pc, 15_pc, 7);
circuit.addGate(dd::Tdagmat, 8_nc, 7);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Xmat, 6_pc, 1);
circuit.addGate(dd::Tmat, 5_pc, 15_pc, 10);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Ymat, 4_nc, 12_pc, 3);
circuit.addGate(dd::Tmat, 8_pc, 2_pc, 6);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Ymat, 16_pc, 6);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Zmat, 6_nc, 16);
circuit.addGate(dd::Smat, 11_pc, 16);
circuit.addGate(dd::Ymat, 4_pc, 3_pc, 15);
circuit.addGate(dd::Tdagmat, 2_pc, 12);
circuit.addGate(dd::Tdagmat, 14_pc, 6_nc, 15);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 5_nc, 11);
circuit.addGate(dd::Smat, 16_nc, 12);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 2_nc, 11_pc, 15);
circuit.addGate(dd::Tdagmat, 1_pc, 11_nc, 2);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Zmat, 7_pc, 9_nc, 2);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Ymat, 14_pc, 9);
circuit.addGate(dd::Xmat, 4_pc, 11_nc, 2);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Zmat, 8_nc, 1_nc, 10);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Xmat, 14_pc, 8_nc, 12);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Ymat, 10_nc, 2);
circuit.addGate(dd::Zmat, 0_pc, 9);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Tdagmat, 10_pc, 13);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Ymat, 5_pc, 2);
circuit.addGate(dd::Tdagmat, 7_pc, 15);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Tdagmat, 15_pc, 2);
circuit.addGate(dd::Ymat, 12_pc, 11_pc, 2);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 1_nc, 14_pc, 13);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 13_pc, 6_pc, 7);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 11_pc, 5_nc, 9);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Smat, 13_pc, 8_nc, 11);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Zmat, 5_pc, 6);
circuit.addGate(dd::Tdagmat, 9_nc, 8);
circuit.addGate(dd::Smat, 1_pc, 3);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Hmat, 3_nc, 5);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Ymat, 9_pc, 10_pc, 0);
circuit.addGate(dd::Zmat, 3_nc, 4_nc, 10);
circuit.addGate(dd::Ymat, 1_nc, 6_pc, 8);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tmat, 4_nc, 7);
circuit.addGate(dd::Xmat, 8_pc, 14_pc, 5);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Ymat, 7);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 18 qubis, containing 180 gates.
TEST(LimTest, hardCircuit_18) {
dd::QuantumCircuit circuit(18);

circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Smat, 0_pc, 11_nc, 9);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 9_nc, 3_pc, 10);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Ymat, 12_nc, 16_pc, 1);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Smat, 1_pc, 2);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Tmat, 0_nc, 3_nc, 9);
circuit.addGate(dd::Zmat, 3_pc, 13_nc, 17);
circuit.addGate(dd::Hmat, 0_nc, 16);
circuit.addGate(dd::Ymat, 16_pc, 17);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Zmat, 1_nc, 8);
circuit.addGate(dd::Ymat, 7_pc, 3_nc, 9);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tmat, 11_nc, 14);
circuit.addGate(dd::Tdagmat, 0_nc, 16_nc, 7);
circuit.addGate(dd::Ymat, 13_pc, 5_nc, 12);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Hmat, 11_nc, 0);
circuit.addGate(dd::Zmat, 16_nc, 0);
circuit.addGate(dd::Hmat, 4_pc, 8);
circuit.addGate(dd::Tdagmat, 14_pc, 4);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 6_nc, 8);
circuit.addGate(dd::Tmat, 11_pc, 12_pc, 2);
circuit.addGate(dd::Zmat, 15_nc, 12_nc, 2);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Smat, 14_nc, 17);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Xmat, 14_nc, 11);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Zmat, 9_pc, 15);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 3_pc, 12);
circuit.addGate(dd::Ymat, 2_nc, 15);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 3_nc, 13);
circuit.addGate(dd::Hmat, 16_pc, 1);
circuit.addGate(dd::Xmat, 12_nc, 0);
circuit.addGate(dd::Zmat, 7_nc, 6);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 15_nc, 16_pc, 5);
circuit.addGate(dd::Ymat, 6_pc, 13);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Zmat, 1_pc, 16);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 8_nc, 10_nc, 13);
circuit.addGate(dd::Ymat, 3_pc, 11_pc, 16);
circuit.addGate(dd::Xmat, 17_pc, 11_nc, 5);
circuit.addGate(dd::Ymat, 7_nc, 14_nc, 10);
circuit.addGate(dd::Tmat, 9_nc, 17);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Hmat, 9_pc, 2_nc, 12);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Tdagmat, 13_pc, 6);
circuit.addGate(dd::Tdagmat, 1_nc, 4_pc, 9);
circuit.addGate(dd::Smat, 3_nc, 14_nc, 11);
circuit.addGate(dd::Tdagmat, 4_pc, 10);
circuit.addGate(dd::Zmat, 4_nc, 0);
circuit.addGate(dd::Hmat, 7_nc, 14_pc, 16);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Tdagmat, 15_pc, 2);
circuit.addGate(dd::Tmat, 6_nc, 4_pc, 12);
circuit.addGate(dd::Zmat, 11_pc, 12_pc, 9);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Tmat, 8_pc, 3);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Hmat, 2_pc, 7_nc, 8);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Ymat, 14_pc, 3);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 3_nc, 7);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Xmat, 7_pc, 8_nc, 16);
circuit.addGate(dd::Tdagmat, 8_nc, 4);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Hmat, 15_pc, 17_nc, 6);
circuit.addGate(dd::Tmat, 1_pc, 10);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Zmat, 9_nc, 14_nc, 10);
circuit.addGate(dd::Zmat, 7_pc, 13_nc, 9);
circuit.addGate(dd::Tmat, 12_pc, 9_pc, 15);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Xmat, 1_nc, 7);
circuit.addGate(dd::Zmat, 15_nc, 14_nc, 8);
circuit.addGate(dd::Smat, 8_nc, 1_pc, 15);
circuit.addGate(dd::Zmat, 14_pc, 11_pc, 7);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Zmat, 7_pc, 12_pc, 8);
circuit.addGate(dd::Tmat, 9_nc, 14);
circuit.addGate(dd::Ymat, 2_pc, 0_pc, 15);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Hmat, 6_nc, 0_nc, 9);
circuit.addGate(dd::Ymat, 7_nc, 12_pc, 13);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Tdagmat, 14_nc, 11);
circuit.addGate(dd::Smat, 17_pc, 9);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Ymat, 10_pc, 4_nc, 16);
circuit.addGate(dd::Xmat, 11_pc, 7);
circuit.addGate(dd::Smat, 2_pc, 3_pc, 1);
circuit.addGate(dd::Smat, 5_nc, 14_pc, 9);
circuit.addGate(dd::Tdagmat, 13_nc, 12);
circuit.addGate(dd::Xmat, 12_nc, 4_pc, 2);
circuit.addGate(dd::Ymat, 10_nc, 11);
circuit.addGate(dd::Hmat, 15_pc, 9_pc, 14);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tmat, 7_pc, 11);
circuit.addGate(dd::Hmat, 1_pc, 5_nc, 7);
circuit.addGate(dd::Tdagmat, 11_pc, 1);
circuit.addGate(dd::Ymat, 1_nc, 8_nc, 5);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Ymat, 0_pc, 6_nc, 13);
circuit.addGate(dd::Xmat, 3_nc, 13_pc, 9);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Zmat, 12_pc, 11);
circuit.addGate(dd::Smat, 2_nc, 16);
circuit.addGate(dd::Tmat, 10_pc, 13_nc, 17);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Smat, 2_nc, 9);
circuit.addGate(dd::Zmat, 16_pc, 1);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 15_nc, 1);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tdagmat, 2_pc, 17_nc, 15);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tmat, 1_pc, 0);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Ymat, 6_nc, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 10_nc, 6);
circuit.addGate(dd::Smat, 0_pc, 15);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 19 qubis, containing 190 gates.
TEST(LimTest, hardCircuit_19) {
dd::QuantumCircuit circuit(19);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 3_pc, 14);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 9_pc, 4);
circuit.addGate(dd::Tdagmat, 5_pc, 7);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Hmat, 16_pc, 10);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Zmat, 4_nc, 18);
circuit.addGate(dd::Tdagmat, 15_pc, 12_nc, 3);
circuit.addGate(dd::Zmat, 16_nc, 6_nc, 15);
circuit.addGate(dd::Tmat, 0_nc, 3);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Zmat, 5_nc, 0);
circuit.addGate(dd::Zmat, 1_nc, 16_nc, 8);
circuit.addGate(dd::Tdagmat, 12_pc, 16_pc, 18);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tdagmat, 1_pc, 0);
circuit.addGate(dd::Xmat, 4_pc, 2);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Hmat, 1_pc, 14);
circuit.addGate(dd::Smat, 11_nc, 14);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Zmat, 10_nc, 7_pc, 18);
circuit.addGate(dd::Xmat, 7_pc, 14);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Ymat, 1_pc, 6_pc, 14);
circuit.addGate(dd::Smat, 11_pc, 16_nc, 12);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Zmat, 0_pc, 3);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Zmat, 11_pc, 4);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Ymat, 7_pc, 15_nc, 3);
circuit.addGate(dd::Tmat, 1_pc, 10);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Ymat, 12_pc, 10_nc, 3);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4_nc, 6_nc, 9);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tmat, 6_pc, 14_nc, 7);
circuit.addGate(dd::Zmat, 1_nc, 8_pc, 14);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Zmat, 16_pc, 12);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Ymat, 6_nc, 0_pc, 1);
circuit.addGate(dd::Smat, 15_pc, 14_pc, 0);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tmat, 14_nc, 8_pc, 16);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Zmat, 8_pc, 3_nc, 18);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Zmat, 9_pc, 8_pc, 13);
circuit.addGate(dd::Hmat, 0_nc, 13_nc, 18);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Tdagmat, 1_nc, 15);
circuit.addGate(dd::Smat, 18_pc, 0);
circuit.addGate(dd::Hmat, 13_pc, 0_pc, 9);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Tmat, 1_pc, 2_pc, 14);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tmat, 4_pc, 0_pc, 10);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Smat, 0_nc, 16_pc, 14);
circuit.addGate(dd::Xmat, 14_pc, 4_nc, 13);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Smat, 18_nc, 2);
circuit.addGate(dd::Tmat, 0_pc, 3);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Ymat, 10_nc, 5);
circuit.addGate(dd::Smat, 15_nc, 7);
circuit.addGate(dd::Xmat, 9_pc, 2);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Hmat, 2_nc, 15_pc, 13);
circuit.addGate(dd::Zmat, 2_pc, 16_pc, 8);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Tdagmat, 4_nc, 14);
circuit.addGate(dd::Xmat, 9_nc, 11_pc, 15);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Hmat, 5_nc, 6);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Smat, 10_pc, 6);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tmat, 18_nc, 9_pc, 7);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Xmat, 7_nc, 9);
circuit.addGate(dd::Tmat, 7_nc, 15_pc, 18);
circuit.addGate(dd::Tmat, 9_pc, 12_pc, 10);
circuit.addGate(dd::Tmat, 9_pc, 15_pc, 12);
circuit.addGate(dd::Hmat, 17_pc, 6);
circuit.addGate(dd::Zmat, 5_pc, 9);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Ymat, 6_nc, 16);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tdagmat, 7_nc, 8_nc, 10);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Ymat, 16_nc, 6);
circuit.addGate(dd::Smat, 2_pc, 6_pc, 0);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Smat, 18_nc, 4);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Xmat, 10_pc, 12);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Zmat, 12_nc, 5_pc, 8);
circuit.addGate(dd::Ymat, 5_nc, 18);
circuit.addGate(dd::Xmat, 0_nc, 18_nc, 4);
circuit.addGate(dd::Ymat, 1_nc, 14_pc, 3);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Smat, 17_nc, 4);
circuit.addGate(dd::Zmat, 18_pc, 16);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tmat, 10_pc, 3);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Xmat, 1_nc, 0);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Zmat, 6_pc, 9_nc, 7);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Ymat, 17_pc, 13);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Tdagmat, 11_pc, 14_pc, 1);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tdagmat, 12_pc, 5_pc, 8);
circuit.addGate(dd::Xmat, 6_nc, 4);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Hmat, 11_pc, 0);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tmat, 18_pc, 11);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Xmat, 10_nc, 3);
circuit.addGate(dd::Smat, 0_nc, 8);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 0_pc, 12_nc, 1);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 20 qubis, containing 200 gates.
TEST(LimTest, hardCircuit_20) {
dd::QuantumCircuit circuit(20);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 8_nc, 3);
circuit.addGate(dd::Ymat, 19_pc, 16);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tdagmat, 10_pc, 15_pc, 2);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 3_nc, 11_pc, 18);
circuit.addGate(dd::Smat, 14_pc, 8);
circuit.addGate(dd::Ymat, 18_nc, 4_nc, 15);
circuit.addGate(dd::Tmat, 15_nc, 1_pc, 19);
circuit.addGate(dd::Tmat, 5_nc, 11);
circuit.addGate(dd::Hmat, 13_nc, 7_nc, 9);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 7_nc, 4_nc, 13);
circuit.addGate(dd::Tmat, 18_pc, 15);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Zmat, 6_pc, 12_nc, 9);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Hmat, 12_nc, 5);
circuit.addGate(dd::Tdagmat, 19_pc, 14_pc, 4);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Tmat, 15_pc, 10_pc, 4);
circuit.addGate(dd::Tmat, 17_nc, 0);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tdagmat, 17_pc, 6);
circuit.addGate(dd::Zmat, 18_nc, 4_nc, 0);
circuit.addGate(dd::Ymat, 4_nc, 10_pc, 1);
circuit.addGate(dd::Xmat, 0_nc, 1);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Tmat, 6_pc, 16);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Zmat, 0_nc, 17);
circuit.addGate(dd::Tmat, 3_nc, 1_nc, 11);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tmat, 6_nc, 16);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Hmat, 18_nc, 16_nc, 15);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Ymat, 13_pc, 16_pc, 10);
circuit.addGate(dd::Hmat, 7_pc, 3_pc, 11);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Zmat, 15_pc, 12);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Tmat, 1_pc, 8);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Tmat, 18_pc, 8_nc, 11);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Smat, 8_pc, 3_nc, 6);
circuit.addGate(dd::Smat, 10_nc, 17);
circuit.addGate(dd::Ymat, 4_pc, 11_pc, 7);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tmat, 3_nc, 2_pc, 4);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Ymat, 7_pc, 4);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Smat, 2_nc, 8);
circuit.addGate(dd::Tmat, 18_nc, 5_nc, 6);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Xmat, 16_pc, 13);
circuit.addGate(dd::Ymat, 12_nc, 3_nc, 16);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 19_nc, 8);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Xmat, 11_nc, 7_pc, 3);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tmat, 7_pc, 16_pc, 13);
circuit.addGate(dd::Smat, 4_nc, 3_nc, 5);
circuit.addGate(dd::Ymat, 1_nc, 18);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tmat, 7_pc, 9_nc, 5);
circuit.addGate(dd::Ymat, 9_nc, 12);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Smat, 5_nc, 19_pc, 11);
circuit.addGate(dd::Zmat, 15_nc, 2_nc, 8);
circuit.addGate(dd::Tdagmat, 15_nc, 4_nc, 3);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Zmat, 14_pc, 3);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 6_nc, 11);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Zmat, 7_pc, 11);
circuit.addGate(dd::Ymat, 16_pc, 15_nc, 18);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tdagmat, 2_pc, 14_nc, 6);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tmat, 0_pc, 13);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Tmat, 1_pc, 14_pc, 7);
circuit.addGate(dd::Ymat, 7_pc, 1_pc, 19);
circuit.addGate(dd::Zmat, 9_pc, 19);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Xmat, 1_pc, 17);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tdagmat, 2_pc, 19_nc, 5);
circuit.addGate(dd::Tdagmat, 3_nc, 15_nc, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Ymat, 11_nc, 17);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Hmat, 15_pc, 13);
circuit.addGate(dd::Smat, 0_nc, 2_pc, 1);
circuit.addGate(dd::Xmat, 14_pc, 7_nc, 13);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Ymat, 8_nc, 18_nc, 0);
circuit.addGate(dd::Xmat, 5_nc, 11);
circuit.addGate(dd::Xmat, 1_pc, 5);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Tmat, 11_pc, 19_pc, 1);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tmat, 1_pc, 17);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 3_pc, 10_pc, 16);
circuit.addGate(dd::Ymat, 2_pc, 4_nc, 13);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 12_nc, 4_nc, 18);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Smat, 8_pc, 16_pc, 10);
circuit.addGate(dd::Tmat, 3_nc, 18);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Zmat, 7_nc, 17);
circuit.addGate(dd::Tdagmat, 12_pc, 11);
circuit.addGate(dd::Ymat, 0_pc, 10_nc, 8);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tdagmat, 17_nc, 5_nc, 12);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Ymat, 15_nc, 9_pc, 11);
circuit.addGate(dd::Smat, 13_nc, 9);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Zmat, 8_pc, 4_nc, 19);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Ymat, 6_pc, 13_nc, 11);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Smat, 19_nc, 5_pc, 11);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Xmat, 3_nc, 4);
circuit.addGate(dd::Tdagmat, 15_pc, 7_pc, 17);
circuit.addGate(dd::Hmat, 5_nc, 0_nc, 1);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tmat, 5_nc, 17_nc, 2);
circuit.addGate(dd::Hmat, 10_pc, 6_pc, 17);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tdagmat, 14_pc, 7);
circuit.addGate(dd::Tdagmat, 17_pc, 19);
circuit.addGate(dd::Ymat, 19);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 21 qubis, containing 210 gates.
TEST(LimTest, hardCircuit_21) {
dd::QuantumCircuit circuit(21);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Zmat, 5_nc, 14);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Smat, 5_pc, 7);
circuit.addGate(dd::Zmat, 17_pc, 11_pc, 2);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Ymat, 17_pc, 6_nc, 7);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Xmat, 19_nc, 10_nc, 15);
circuit.addGate(dd::Smat, 8_pc, 16_nc, 12);
circuit.addGate(dd::Xmat, 4_nc, 10_nc, 12);
circuit.addGate(dd::Hmat, 1_nc, 17_nc, 7);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 6_nc, 12_nc, 16);
circuit.addGate(dd::Tmat, 4_pc, 2);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Zmat, 13_nc, 5_pc, 8);
circuit.addGate(dd::Zmat, 1_pc, 7);
circuit.addGate(dd::Xmat, 0_nc, 5);
circuit.addGate(dd::Tmat, 18_pc, 2);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Smat, 8_pc, 5);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 9_pc, 11_pc, 13);
circuit.addGate(dd::Tmat, 10_nc, 8);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Tdagmat, 7_pc, 2);
circuit.addGate(dd::Zmat, 13_nc, 4_nc, 6);
circuit.addGate(dd::Ymat, 15_nc, 12_pc, 5);
circuit.addGate(dd::Xmat, 1_nc, 9);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tmat, 14_pc, 3);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Zmat, 12_nc, 1);
circuit.addGate(dd::Tmat, 18_pc, 11_nc, 12);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Tmat, 6_nc, 10_nc, 11);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Tdagmat, 0_pc, 4);
circuit.addGate(dd::Hmat, 9_pc, 10_pc, 11);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Zmat, 4_pc, 19);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tmat, 18_pc, 16);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tmat, 1_pc, 17_nc, 16);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Smat, 8_pc, 7_nc, 4);
circuit.addGate(dd::Smat, 12_nc, 17);
circuit.addGate(dd::Ymat, 16_pc, 20_pc, 7);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tmat, 17_nc, 5_nc, 3);
circuit.addGate(dd::Tdagmat, 8_nc, 2);
circuit.addGate(dd::Ymat, 14_pc, 7_nc, 3);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Smat, 15_pc, 13);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 14_pc, 17);
circuit.addGate(dd::Ymat, 8_nc, 20_nc, 3);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Zmat, 15_nc, 9);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 9_pc, 13_nc, 4);
circuit.addGate(dd::Xmat, 15_nc, 9);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tdagmat, 6_nc, 2_pc, 12);
circuit.addGate(dd::Xmat, 8_pc, 7_nc, 3);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tmat, 17_pc, 2);
circuit.addGate(dd::Xmat, 10_pc, 3_pc, 5);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Hmat, 4_nc, 0);
circuit.addGate(dd::Ymat, 4_pc, 8_pc, 10);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Xmat, 2_nc, 0_nc, 20);
circuit.addGate(dd::Smat, 20_nc, 12_pc, 6);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Tdagmat, 18_pc, 15_pc, 16);
circuit.addGate(dd::Tmat, 7_nc, 8_nc, 10);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Zmat, 11_pc, 7);
circuit.addGate(dd::Ymat, 1_pc, 9_nc, 16);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Tdagmat, 3_pc, 17_nc, 16);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tmat, 9_pc, 19);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Tmat, 20_nc, 11_pc, 4);
circuit.addGate(dd::Tmat, 16_pc, 12_pc, 1);
circuit.addGate(dd::Ymat, 16_pc, 20_pc, 2);
circuit.addGate(dd::Xmat, 6_pc, 3_pc, 17);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Tdagmat, 19_pc, 20_nc, 2);
circuit.addGate(dd::Tdagmat, 15_nc, 11_nc, 9);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Ymat, 20_nc, 4);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Hmat, 10_pc, 12);
circuit.addGate(dd::Smat, 11_nc, 18_pc, 4);
circuit.addGate(dd::Xmat, 19_pc, 14_nc, 4);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Ymat, 5_nc, 8_nc, 13);
circuit.addGate(dd::Xmat, 10_nc, 7);
circuit.addGate(dd::Xmat, 2_pc, 0);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tmat, 14_pc, 7_pc, 3);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Tmat, 18_pc, 2);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Tdagmat, 17_pc, 16_pc, 3);
circuit.addGate(dd::Hmat, 18_pc, 10);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Zmat, 8_nc, 10);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 0_pc, 9_pc, 4);
circuit.addGate(dd::Tmat, 12_nc, 18);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Zmat, 7_nc, 16);
circuit.addGate(dd::Tdagmat, 4_pc, 20);
circuit.addGate(dd::Ymat, 10_pc, 8_nc, 7);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 19_nc, 9_nc, 20);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 5_nc, 20_pc, 3);
circuit.addGate(dd::Smat, 12_nc, 15);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Zmat, 4_pc, 18_nc, 8);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Ymat, 19_pc, 17_nc, 9);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 17_nc, 5_pc, 13);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Xmat, 6_nc, 9);
circuit.addGate(dd::Tdagmat, 15_pc, 17_pc, 2);
circuit.addGate(dd::Hmat, 12_nc, 3_nc, 0);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Tmat, 13_nc, 1_nc, 7);
circuit.addGate(dd::Hmat, 20_pc, 3_pc, 8);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Tdagmat, 19_pc, 18);
circuit.addGate(dd::Tdagmat, 15_pc, 17);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 7_pc, 13);
circuit.addGate(dd::Ymat, 16_pc, 12_pc, 15);
circuit.addGate(dd::Zmat, 18_pc, 12);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Tdagmat, 8_pc, 14_pc, 20);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Hmat, 6_pc, 2);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Tmat, 13_nc, 5_pc, 8);
circuit.addGate(dd::Xmat, 15);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 22 qubis, containing 220 gates.
TEST(LimTest, hardCircuit_22) {
dd::QuantumCircuit circuit(22);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Zmat, 15_nc, 21_nc, 9);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 14_nc, 4_nc, 17);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tdagmat, 12_nc, 8_nc, 17);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Zmat, 20_nc, 9_nc, 12);
circuit.addGate(dd::Hmat, 1_pc, 16_pc, 9);
circuit.addGate(dd::Xmat, 15_pc, 19_pc, 0);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Smat, 20_pc, 18_nc, 0);
circuit.addGate(dd::Ymat, 3_nc, 6);
circuit.addGate(dd::Xmat, 6_pc, 12_pc, 14);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Ymat, 3_nc, 18);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Xmat, 15_pc, 7_pc, 14);
circuit.addGate(dd::Hmat, 21_pc, 14);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Zmat, 17_nc, 1_pc, 5);
circuit.addGate(dd::Smat, 11_nc, 21);
circuit.addGate(dd::Ymat, 8_nc, 5_pc, 4);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Smat, 15_nc, 20_nc, 11);
circuit.addGate(dd::Tmat, 10_pc, 14_pc, 12);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Zmat, 8_nc, 17_nc, 9);
circuit.addGate(dd::Smat, 6_pc, 8_pc, 11);
circuit.addGate(dd::Hmat, 11_pc, 17_pc, 0);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Hmat, 11_nc, 2_pc, 18);
circuit.addGate(dd::Xmat, 19_nc, 1);
circuit.addGate(dd::Zmat, 3_nc, 2);
circuit.addGate(dd::Tdagmat, 13_pc, 4);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Ymat, 6_nc, 13);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Ymat, 10_pc, 17);
circuit.addGate(dd::Zmat, 16_pc, 15_pc, 20);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 5_pc, 2_nc, 13);
circuit.addGate(dd::Tmat, 13_pc, 15);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 19_pc, 11);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Smat, 16_nc, 21);
circuit.addGate(dd::Ymat, 0_nc, 18);
circuit.addGate(dd::Ymat, 15_pc, 17);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Xmat, 19_pc, 20_nc, 21);
circuit.addGate(dd::Smat, 15_nc, 18);
circuit.addGate(dd::Smat, 15_pc, 7_pc, 1);
circuit.addGate(dd::Hmat, 15_nc, 14_nc, 0);
circuit.addGate(dd::Ymat, 0_pc, 18_nc, 17);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Hmat, 10_nc, 20);
circuit.addGate(dd::Hmat, 1_nc, 21_pc, 17);
circuit.addGate(dd::Smat, 21_pc, 5);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tdagmat, 9_pc, 15);
circuit.addGate(dd::Zmat, 7_nc, 18);
circuit.addGate(dd::Smat, 7_nc, 17_pc, 8);
circuit.addGate(dd::Hmat, 2_pc, 7);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Smat, 16_nc, 21_nc, 8);
circuit.addGate(dd::Xmat, 17_nc, 21);
circuit.addGate(dd::Xmat, 16_nc, 14);
circuit.addGate(dd::Smat, 15_nc, 8);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Zmat, 20_pc, 4_nc, 16);
circuit.addGate(dd::Ymat, 3_pc, 6_nc, 16);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Xmat, 5_pc, 0);
circuit.addGate(dd::Hmat, 3_nc, 4_pc, 9);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tdagmat, 3_nc, 15_pc, 2);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Smat, 8_nc, 3);
circuit.addGate(dd::Tdagmat, 18_nc, 15);
circuit.addGate(dd::Smat, 5_pc, 17);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Zmat, 7_nc, 8);
circuit.addGate(dd::Tmat, 19_pc, 1);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Tdagmat, 20_nc, 2);
circuit.addGate(dd::Zmat, 11_nc, 18_nc, 19);
circuit.addGate(dd::Zmat, 8_nc, 19_nc, 13);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Ymat, 17_pc, 3_pc, 11);
circuit.addGate(dd::Zmat, 0_nc, 15);
circuit.addGate(dd::Zmat, 15_pc, 1);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Ymat, 6_nc, 11_pc, 9);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 4_nc, 16);
circuit.addGate(dd::Zmat, 1_nc, 12);
circuit.addGate(dd::Hmat, 18_nc, 1);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 1_nc, 18_pc, 19);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 3_nc, 0_pc, 1);
circuit.addGate(dd::Zmat, 19_pc, 17);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Ymat, 8_nc, 10);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Tdagmat, 13_pc, 20_pc, 21);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Smat, 6_nc, 7);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tmat, 20_nc, 14_nc, 6);
circuit.addGate(dd::Tdagmat, 21_nc, 1_nc, 8);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Hmat, 18_nc, 12);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Hmat, 18_nc, 10_pc, 19);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Zmat, 10_pc, 13_pc, 2);
circuit.addGate(dd::Hmat, 13_pc, 17_pc, 1);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Xmat, 19_nc, 7);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Tmat, 21_nc, 7_nc, 13);
circuit.addGate(dd::Xmat, 21_nc, 10);
circuit.addGate(dd::Xmat, 4_nc, 18_nc, 3);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Ymat, 21_nc, 2_nc, 8);
circuit.addGate(dd::Tdagmat, 8_nc, 20);
circuit.addGate(dd::Xmat, 15_nc, 2_nc, 14);
circuit.addGate(dd::Hmat, 8_nc, 4);
circuit.addGate(dd::Smat, 2_nc, 4_pc, 5);
circuit.addGate(dd::Ymat, 0_nc, 8);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tdagmat, 3_nc, 10_pc, 6);
circuit.addGate(dd::Tdagmat, 21_nc, 17);
circuit.addGate(dd::Smat, 8_nc, 0);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Tdagmat, 15_nc, 1);
circuit.addGate(dd::Hmat, 17_nc, 12);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Zmat, 4_nc, 7_nc, 5);
circuit.addGate(dd::Hmat, 16_pc, 14);
circuit.addGate(dd::Tdagmat, 21_pc, 15_nc, 17);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 16_pc, 3);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 4_pc, 3);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 11_nc, 16_nc, 12);
circuit.addGate(dd::Xmat, 9_nc, 7_nc, 19);
circuit.addGate(dd::Ymat, 11_nc, 16);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 23 qubis, containing 230 gates.
TEST(LimTest, hardCircuit_23) {
dd::QuantumCircuit circuit(23);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Tmat, 2_nc, 13);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 14_nc, 3_nc, 16);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Tmat, 15_nc, 12_nc, 4);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Hmat, 21_pc, 3_pc, 18);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Smat, 1_nc, 22_pc, 20);
circuit.addGate(dd::Zmat, 2_pc, 1_nc, 7);
circuit.addGate(dd::Zmat, 3_pc, 6);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Smat, 14_nc, 19);
circuit.addGate(dd::Zmat, 14_pc, 17_pc, 13);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Ymat, 20_nc, 21_nc, 1);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Hmat, 18_pc, 4);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tmat, 15_nc, 16);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Ymat, 5_nc, 12_pc, 7);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Smat, 9_pc, 15);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Tdagmat, 0_pc, 16);
circuit.addGate(dd::Smat, 14_nc, 18);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Hmat, 13_pc, 19_pc, 4);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 12_nc, 21);
circuit.addGate(dd::Hmat, 15_pc, 1);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tmat, 12_nc, 19);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tdagmat, 6_pc, 22);
circuit.addGate(dd::Tmat, 3_nc, 12);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tmat, 14_nc, 15);
circuit.addGate(dd::Xmat, 14_pc, 17_nc, 18);
circuit.addGate(dd::Hmat, 21_pc, 15);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tmat, 7_pc, 0);
circuit.addGate(dd::Tmat, 22_pc, 18_nc, 5);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Tdagmat, 18_pc, 9_nc, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Hmat, 11_nc, 3);
circuit.addGate(dd::Xmat, 3_nc, 11_nc, 10);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tdagmat, 18_nc, 6_nc, 0);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Tdagmat, 4_nc, 11_pc, 22);
circuit.addGate(dd::Tdagmat, 22_pc, 9_pc, 21);
circuit.addGate(dd::Tdagmat, 10_pc, 20_nc, 14);
circuit.addGate(dd::Hmat, 15_pc, 3);
circuit.addGate(dd::Tmat, 12_pc, 13_nc, 14);
circuit.addGate(dd::Tmat, 3_pc, 13_pc, 5);
circuit.addGate(dd::Hmat, 10_pc, 19_pc, 15);
circuit.addGate(dd::Smat, 21_pc, 6);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Xmat, 15_pc, 6_pc, 8);
circuit.addGate(dd::Tmat, 20_pc, 22);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tmat, 9_nc, 17);
circuit.addGate(dd::Hmat, 8_nc, 2_nc, 4);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Zmat, 18_pc, 0);
circuit.addGate(dd::Xmat, 1_nc, 16_nc, 8);
circuit.addGate(dd::Smat, 18_nc, 19_nc, 20);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Zmat, 22_pc, 11_nc, 19);
circuit.addGate(dd::Xmat, 9_nc, 17);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Zmat, 16_nc, 19);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 21_nc, 10_nc, 18);
circuit.addGate(dd::Xmat, 12_pc, 14_pc, 17);
circuit.addGate(dd::Tdagmat, 11_pc, 19);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Hmat, 11_nc, 6_nc, 12);
circuit.addGate(dd::Zmat, 13_nc, 5);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tmat, 19_nc, 22_nc, 8);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Ymat, 19_nc, 14);
circuit.addGate(dd::Tmat, 22_nc, 5_pc, 16);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Zmat, 2_pc, 11_pc, 12);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Tdagmat, 12_nc, 6);
circuit.addGate(dd::Tmat, 20_pc, 19_nc, 22);
circuit.addGate(dd::Tdagmat, 18_nc, 20_nc, 16);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Xmat, 20_pc, 0_nc, 13);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Tdagmat, 0_nc, 2_pc, 16);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Xmat, 19_pc, 17);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Xmat, 21_pc, 12_nc, 7);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Xmat, 4_nc, 10);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Xmat, 17_nc, 15);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Smat, 6_pc, 20_nc, 0);
circuit.addGate(dd::Smat, 2_nc, 4);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 17_pc, 0);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Smat, 16_nc, 14_pc, 15);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Xmat, 20_nc, 15_nc, 21);
circuit.addGate(dd::Zmat, 9_nc, 21);
circuit.addGate(dd::Tdagmat, 18_pc, 13_nc, 2);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Smat, 14_pc, 16_pc, 4);
circuit.addGate(dd::Smat, 15_nc, 0_pc, 13);
circuit.addGate(dd::Ymat, 16_pc, 17);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Ymat, 22_nc, 13);
circuit.addGate(dd::Tmat, 9_nc, 18_nc, 13);
circuit.addGate(dd::Ymat, 15_nc, 5);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 1_nc, 5);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tmat, 16_nc, 2_nc, 8);
circuit.addGate(dd::Tdagmat, 12_nc, 16);
circuit.addGate(dd::Tmat, 0_nc, 12);
circuit.addGate(dd::Zmat, 14_nc, 12_pc, 8);
circuit.addGate(dd::Tdagmat, 21_nc, 13);
circuit.addGate(dd::Zmat, 5_pc, 16_nc, 14);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Smat, 3_pc, 6_nc, 18);
circuit.addGate(dd::Tdagmat, 12_nc, 16_pc, 14);
circuit.addGate(dd::Zmat, 5_pc, 14);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Tdagmat, 21_nc, 1);
circuit.addGate(dd::Tdagmat, 19_nc, 22);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tdagmat, 22_nc, 9);
circuit.addGate(dd::Ymat, 4_pc, 9);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 22_nc, 6_nc, 19);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Tmat, 18_nc, 5);
circuit.addGate(dd::Smat, 15_pc, 1_nc, 9);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Xmat, 8_pc, 18_pc, 12);
circuit.addGate(dd::Smat, 0_nc, 3_nc, 1);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Smat, 9_pc, 10_pc, 8);
circuit.addGate(dd::Zmat, 18);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 24 qubis, containing 240 gates.
TEST(LimTest, hardCircuit_24) {
dd::QuantumCircuit circuit(24);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Ymat, 2_pc, 20_nc, 0);
circuit.addGate(dd::Smat, 10_nc, 9);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Tdagmat, 0_nc, 16);
circuit.addGate(dd::Xmat, 11_pc, 0_pc, 15);
circuit.addGate(dd::Tmat, 10_pc, 22);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 18_pc, 6);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tmat, 16_pc, 12);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Hmat, 2_pc, 11_nc, 16);
circuit.addGate(dd::Tdagmat, 3_nc, 15_nc, 5);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Ymat, 15_pc, 1_nc, 16);
circuit.addGate(dd::Tmat, 12_pc, 15_pc, 18);
circuit.addGate(dd::Hmat, 23_pc, 9_nc, 0);
circuit.addGate(dd::Smat, 4_pc, 10);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15_pc, 13_pc, 16);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Zmat, 4_nc, 12);
circuit.addGate(dd::Tmat, 9_pc, 21_pc, 3);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Smat, 1_pc, 14_nc, 18);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Ymat, 2_nc, 1_pc, 21);
circuit.addGate(dd::Tdagmat, 11_nc, 19);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Zmat, 2_nc, 8);
circuit.addGate(dd::Tdagmat, 22_nc, 18_nc, 19);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Tdagmat, 9_nc, 12);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tdagmat, 23_pc, 5_nc, 12);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Zmat, 21_pc, 3_nc, 7);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Xmat, 11_pc, 6_pc, 9);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Ymat, 18_pc, 1_nc, 8);
circuit.addGate(dd::Zmat, 18_nc, 20_pc, 3);
circuit.addGate(dd::Tmat, 21_nc, 19);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Xmat, 19_pc, 3);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Ymat, 12_nc, 19);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Xmat, 3_pc, 22_nc, 1);
circuit.addGate(dd::Ymat, 9_pc, 20);
circuit.addGate(dd::Xmat, 16_nc, 22);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Xmat, 6_nc, 5_pc, 8);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Xmat, 11_nc, 1);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 23_pc, 17);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Ymat, 19_nc, 17);
circuit.addGate(dd::Tmat, 3_pc, 7);
circuit.addGate(dd::Tdagmat, 9_nc, 15);
circuit.addGate(dd::Smat, 18_pc, 10);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Ymat, 23_nc, 16);
circuit.addGate(dd::Xmat, 11_pc, 14_pc, 9);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 7_pc, 21);
circuit.addGate(dd::Ymat, 14_nc, 12);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Smat, 20_nc, 5);
circuit.addGate(dd::Ymat, 6_nc, 5);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Xmat, 1_nc, 11_pc, 19);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Ymat, 1_nc, 10_nc, 11);
circuit.addGate(dd::Hmat, 16_pc, 2_nc, 10);
circuit.addGate(dd::Zmat, 18_pc, 23);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Xmat, 2_nc, 9);
circuit.addGate(dd::Tmat, 16_pc, 12_nc, 15);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Ymat, 1_nc, 16);
circuit.addGate(dd::Tmat, 5_nc, 12);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Hmat, 11_pc, 6);
circuit.addGate(dd::Tdagmat, 19_pc, 22_nc, 16);
circuit.addGate(dd::Hmat, 10_nc, 17_nc, 18);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 20_nc, 13);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Hmat, 3_nc, 19_pc, 16);
circuit.addGate(dd::Hmat, 18_nc, 16);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Ymat, 21_pc, 0_nc, 17);
circuit.addGate(dd::Ymat, 12_pc, 13);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Smat, 23_pc, 3);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Xmat, 16_nc, 20_nc, 23);
circuit.addGate(dd::Ymat, 18_pc, 14_nc, 13);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Xmat, 20_nc, 17);
circuit.addGate(dd::Xmat, 10_pc, 11);
circuit.addGate(dd::Xmat, 17_pc, 21_pc, 9);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Smat, 9_nc, 11);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Smat, 19_nc, 8);
circuit.addGate(dd::Tmat, 14_nc, 0_pc, 21);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tdagmat, 1_nc, 14_pc, 10);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Xmat, 11_pc, 15);
circuit.addGate(dd::Tmat, 14_pc, 17_pc, 0);
circuit.addGate(dd::Zmat, 18_pc, 14);
circuit.addGate(dd::Ymat, 21_nc, 7_pc, 20);
circuit.addGate(dd::Tmat, 16_nc, 10_pc, 1);
circuit.addGate(dd::Zmat, 9_pc, 0_pc, 14);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Zmat, 11_nc, 22);
circuit.addGate(dd::Hmat, 13_nc, 4_nc, 22);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tmat, 22_nc, 5_pc, 13);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tmat, 0_nc, 1_nc, 12);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Hmat, 8_pc, 20_nc, 18);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Ymat, 13_nc, 21);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Xmat, 21_pc, 11);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Xmat, 4_nc, 16);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 8_pc, 19);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 20_nc, 7);
circuit.addGate(dd::Smat, 20_nc, 11);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Hmat, 3_nc, 15);
circuit.addGate(dd::Smat, 10_pc, 2_pc, 20);
circuit.addGate(dd::Tdagmat, 18_pc, 2);
circuit.addGate(dd::Smat, 23_nc, 9);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tmat, 18_pc, 3);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Xmat, 12_pc, 22_nc, 11);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tmat, 14_pc, 2_nc, 22);
circuit.addGate(dd::Tdagmat, 12_pc, 0_pc, 2);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Tmat, 9_pc, 0);
circuit.addGate(dd::Tmat, 12_pc, 4);
circuit.addGate(dd::Xmat, 8_nc, 23_nc, 2);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Tdagmat, 1_nc, 21_nc, 8);
circuit.addGate(dd::Zmat, 19_nc, 9_pc, 15);
circuit.addGate(dd::Ymat, 17_pc, 1_pc, 4);
circuit.addGate(dd::Tdagmat, 7_nc, 15);
circuit.addGate(dd::Hmat, 9_nc, 8_pc, 19);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Ymat, 17_nc, 11_nc, 21);
circuit.addGate(dd::Hmat, 17_nc, 1);
circuit.addGate(dd::Zmat, 11_nc, 22_nc, 0);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Ymat, 20_nc, 14_pc, 2);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Xmat, 16_pc, 10_nc, 9);
circuit.addGate(dd::Ymat, 20_nc, 9_nc, 4);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Ymat, 11_pc, 23);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 16_pc, 6);
circuit.addGate(dd::Smat, 9_pc, 20_nc, 22);
circuit.addGate(dd::Hmat, 19_nc, 17);
circuit.addGate(dd::Zmat, 15);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 25 qubis, containing 250 gates.
TEST(LimTest, hardCircuit_25) {
dd::QuantumCircuit circuit(25);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Zmat, 7_nc, 4);
circuit.addGate(dd::Smat, 15_nc, 18_nc, 23);
circuit.addGate(dd::Tdagmat, 3_nc, 20_pc, 23);
circuit.addGate(dd::Ymat, 16_nc, 8_nc, 13);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tdagmat, 16_pc, 9);
circuit.addGate(dd::Hmat, 7_pc, 12);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Tdagmat, 24_nc, 20_pc, 0);
circuit.addGate(dd::Zmat, 9_nc, 6_pc, 12);
circuit.addGate(dd::Hmat, 8_nc, 18_nc, 3);
circuit.addGate(dd::Tmat, 16_pc, 13_nc, 17);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Zmat, 13_pc, 24);
circuit.addGate(dd::Tdagmat, 23_nc, 24);
circuit.addGate(dd::Ymat, 15_pc, 0_pc, 7);
circuit.addGate(dd::Hmat, 22_pc, 10_nc, 5);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Smat, 12_nc, 20_nc, 11);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tmat, 0_nc, 17);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Zmat, 12_nc, 13_nc, 1);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Zmat, 11_nc, 22_pc, 24);
circuit.addGate(dd::Tdagmat, 18_nc, 19);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Ymat, 5_nc, 16_pc, 15);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Zmat, 0_nc, 13);
circuit.addGate(dd::Smat, 4_nc, 23);
circuit.addGate(dd::Tmat, 12_nc, 8);
circuit.addGate(dd::Ymat, 19_nc, 20_pc, 8);
circuit.addGate(dd::Smat, 0_nc, 8);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Smat, 22_nc, 15_pc, 9);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Tdagmat, 10_nc, 2);
circuit.addGate(dd::Smat, 17_nc, 6);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Zmat, 5_pc, 7);
circuit.addGate(dd::Ymat, 18_pc, 11_nc, 1);
circuit.addGate(dd::Tdagmat, 5_pc, 6_pc, 2);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Hmat, 5_pc, 6_pc, 19);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Tdagmat, 5_nc, 17_nc, 24);
circuit.addGate(dd::Hmat, 10_pc, 23_nc, 4);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Smat, 13_pc, 15);
circuit.addGate(dd::Tmat, 10_nc, 9);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Zmat, 10_pc, 21_nc, 19);
circuit.addGate(dd::Zmat, 14_pc, 2);
circuit.addGate(dd::Smat, 9_nc, 13);
circuit.addGate(dd::Xmat, 15_pc, 3);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Tdagmat, 7_nc, 9_pc, 5);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tmat, 8_pc, 9);
circuit.addGate(dd::Hmat, 6_nc, 16_nc, 23);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Tdagmat, 10_pc, 5);
circuit.addGate(dd::Zmat, 9_nc, 5);
circuit.addGate(dd::Tdagmat, 15_pc, 14_nc, 9);
circuit.addGate(dd::Ymat, 19_nc, 10);
circuit.addGate(dd::Zmat, 16_pc, 18_nc, 9);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tmat, 21_nc, 9);
circuit.addGate(dd::Smat, 20_pc, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Hmat, 7_nc, 17);
circuit.addGate(dd::Ymat, 15_nc, 2);
circuit.addGate(dd::Ymat, 6_pc, 7_pc, 18);
circuit.addGate(dd::Zmat, 21_nc, 15);
circuit.addGate(dd::Ymat, 23_pc, 15_nc, 24);
circuit.addGate(dd::Zmat, 10_pc, 14);
circuit.addGate(dd::Xmat, 18_pc, 7);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Zmat, 23_pc, 14);
circuit.addGate(dd::Xmat, 22_nc, 17);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Tmat, 13_pc, 22_pc, 1);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Smat, 11_nc, 6);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Ymat, 6_nc, 16);
circuit.addGate(dd::Tdagmat, 1_pc, 23_pc, 8);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Zmat, 3_pc, 7);
circuit.addGate(dd::Tmat, 23_nc, 13);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Ymat, 4_nc, 0_nc, 23);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 20_pc, 9);
circuit.addGate(dd::Ymat, 21_nc, 23);
circuit.addGate(dd::Xmat, 21_nc, 23_nc, 13);
circuit.addGate(dd::Xmat, 19_pc, 24);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Xmat, 23_pc, 11);
circuit.addGate(dd::Hmat, 20_nc, 10_pc, 5);
circuit.addGate(dd::Hmat, 9_pc, 12_pc, 11);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Ymat, 0_pc, 1_nc, 8);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Hmat, 20_nc, 10_nc, 6);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Xmat, 11_nc, 10_pc, 23);
circuit.addGate(dd::Tdagmat, 1_nc, 7_nc, 20);
circuit.addGate(dd::Ymat, 13_pc, 11_nc, 3);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 13_nc, 19);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 11_nc, 4_pc, 16);
circuit.addGate(dd::Tdagmat, 21_pc, 7_pc, 16);
circuit.addGate(dd::Tdagmat, 2_nc, 5_pc, 0);
circuit.addGate(dd::Zmat, 13_pc, 10);
circuit.addGate(dd::Tmat, 18_pc, 4_pc, 5);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Smat, 4_nc, 0);
circuit.addGate(dd::Xmat, 9_pc, 7);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Tmat, 3_pc, 22);
circuit.addGate(dd::Tdagmat, 3_pc, 18);
circuit.addGate(dd::Tdagmat, 14_nc, 4_pc, 22);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Zmat, 3_pc, 14);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Tmat, 10_nc, 6);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Tdagmat, 20_pc, 22_nc, 16);
circuit.addGate(dd::Smat, 10_nc, 1);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Xmat, 2_pc, 10_pc, 22);
circuit.addGate(dd::Tdagmat, 22_pc, 11);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Ymat, 6_pc, 9_nc, 3);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tmat, 0_nc, 15);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Xmat, 11_nc, 18_nc, 21);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Zmat, 20_pc, 19_nc, 16);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Tmat, 12_nc, 3_nc, 1);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Tdagmat, 24_pc, 15);
circuit.addGate(dd::Hmat, 18_pc, 22);
circuit.addGate(dd::Tmat, 9_pc, 15_nc, 4);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Hmat, 6_pc, 22_pc, 0);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Zmat, 10_nc, 4);
circuit.addGate(dd::Hmat, 4_pc, 14_nc, 20);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 18_pc, 20_nc, 16);
circuit.addGate(dd::Tdagmat, 22_pc, 13);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Zmat, 11_pc, 15_pc, 14);
circuit.addGate(dd::Hmat, 21_nc, 20);
circuit.addGate(dd::Hmat, 10_pc, 22_nc, 15);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Zmat, 11_pc, 22_pc, 13);
circuit.addGate(dd::Hmat, 9_pc, 1_nc, 16);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Ymat, 4_nc, 3_pc, 19);
circuit.addGate(dd::Zmat, 1_pc, 12);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Xmat, 17_pc, 20);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Hmat, 8_nc, 15_pc, 5);
circuit.addGate(dd::Tmat, 21_pc, 14_pc, 17);
circuit.addGate(dd::Smat, 12_pc, 20);
circuit.addGate(dd::Xmat, 1_nc, 9);
circuit.addGate(dd::Xmat, 6_nc, 1);
circuit.addGate(dd::Zmat, 18_nc, 17);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Tmat, 21_nc, 10);
circuit.addGate(dd::Tdagmat, 24_nc, 17_pc, 22);
circuit.addGate(dd::Tmat, 24_nc, 2_pc, 5);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tmat, 8_pc, 15);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Zmat, 16_nc, 17);
circuit.addGate(dd::Xmat, 18_pc, 6);
circuit.addGate(dd::Xmat, 0_nc, 4_pc, 22);
circuit.addGate(dd::Xmat, 16_pc, 17_nc, 0);
circuit.addGate(dd::Hmat, 11_pc, 7_pc, 18);
circuit.addGate(dd::Tmat, 3_nc, 14);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Tmat, 8_pc, 23_nc, 24);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Ymat, 5_nc, 0_nc, 10);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Ymat, 12_nc, 7);
circuit.addGate(dd::Tdagmat, 5);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 26 qubis, containing 260 gates.
TEST(LimTest, hardCircuit_26) {
dd::QuantumCircuit circuit(26);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Hmat, 25_pc, 19);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Hmat, 21_nc, 5_pc, 9);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Ymat, 9_nc, 8_nc, 14);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Smat, 4_nc, 12_pc, 20);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Ymat, 20_nc, 1_nc, 10);
circuit.addGate(dd::Xmat, 20_nc, 6_nc, 0);
circuit.addGate(dd::Tmat, 19_nc, 23_pc, 4);
circuit.addGate(dd::Tdagmat, 22_nc, 23_pc, 17);
circuit.addGate(dd::Tdagmat, 8_nc, 20);
circuit.addGate(dd::Xmat, 2_pc, 8);
circuit.addGate(dd::Tdagmat, 2_nc, 8_nc, 3);
circuit.addGate(dd::Zmat, 8_pc, 17_pc, 11);
circuit.addGate(dd::Xmat, 2_nc, 24_nc, 6);
circuit.addGate(dd::Hmat, 22_nc, 6_pc, 20);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Smat, 16_nc, 6);
circuit.addGate(dd::Tmat, 25_nc, 18);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Tmat, 21_pc, 16);
circuit.addGate(dd::Ymat, 3_pc, 2);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Xmat, 25);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Tmat, 25_pc, 0_pc, 11);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Ymat, 13_pc, 17_pc, 21);
circuit.addGate(dd::Tdagmat, 16_nc, 2_nc, 24);
circuit.addGate(dd::Tdagmat, 4_pc, 24_pc, 7);
circuit.addGate(dd::Ymat, 19_pc, 0_pc, 9);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 18_pc, 11);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Xmat, 15_nc, 14);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Ymat, 3_pc, 0);
circuit.addGate(dd::Tmat, 16_pc, 8);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Tmat, 18_pc, 4_nc, 10);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Zmat, 20_pc, 7_nc, 2);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Hmat, 5_nc, 13);
circuit.addGate(dd::Tmat, 16_pc, 11);
circuit.addGate(dd::Tmat, 23_nc, 2);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tmat, 4_nc, 21);
circuit.addGate(dd::Tmat, 10_nc, 0);
circuit.addGate(dd::Smat, 21_nc, 19_pc, 6);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tmat, 2_nc, 6);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Smat, 2_pc, 13_pc, 17);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Xmat, 24_pc, 15_nc, 9);
circuit.addGate(dd::Hmat, 24_nc, 16);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 16_pc, 12_nc, 24);
circuit.addGate(dd::Hmat, 16_nc, 2);
circuit.addGate(dd::Hmat, 2_nc, 1);
circuit.addGate(dd::Zmat, 9_nc, 3_nc, 0);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Zmat, 25_nc, 11_nc, 7);
circuit.addGate(dd::Tmat, 13_nc, 3_pc, 23);
circuit.addGate(dd::Tmat, 17_pc, 19_pc, 2);
circuit.addGate(dd::Xmat, 8_pc, 14_nc, 16);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 25_pc, 15);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Hmat, 11_nc, 18);
circuit.addGate(dd::Smat, 15_nc, 10);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Ymat, 24_pc, 17_pc, 1);
circuit.addGate(dd::Tmat, 6_pc, 23);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tmat, 9_pc, 18_pc, 23);
circuit.addGate(dd::Tdagmat, 6_nc, 15_pc, 3);
circuit.addGate(dd::Zmat, 12_nc, 7);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Ymat, 21_nc, 15);
circuit.addGate(dd::Hmat, 2_nc, 1_pc, 18);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Smat, 11_nc, 13);
circuit.addGate(dd::Zmat, 21_pc, 19_nc, 1);
circuit.addGate(dd::Tdagmat, 18_pc, 15);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 7_nc, 13_nc, 17);
circuit.addGate(dd::Xmat, 1_nc, 16);
circuit.addGate(dd::Ymat, 25_nc, 4);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Tdagmat, 11_nc, 2);
circuit.addGate(dd::Zmat, 0_pc, 16_nc, 13);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Xmat, 0_nc, 22);
circuit.addGate(dd::Smat, 17_pc, 6);
circuit.addGate(dd::Ymat, 22_pc, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Zmat, 24_nc, 2_nc, 6);
circuit.addGate(dd::Ymat, 11_pc, 6);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Xmat, 0_nc, 16);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Zmat, 14_pc, 13_pc, 3);
circuit.addGate(dd::Xmat, 19_nc, 21);
circuit.addGate(dd::Tdagmat, 17_nc, 21);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Xmat, 21_nc, 10_pc, 25);
circuit.addGate(dd::Tdagmat, 22_pc, 2_pc, 6);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Zmat, 14_pc, 21);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Xmat, 3_nc, 10_pc, 7);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Zmat, 7_pc, 22_pc, 18);
circuit.addGate(dd::Zmat, 22_nc, 19_nc, 5);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Xmat, 0_nc, 23);
circuit.addGate(dd::Xmat, 20_pc, 3);
circuit.addGate(dd::Hmat, 22_nc, 7_pc, 12);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Ymat, 24_nc, 20);
circuit.addGate(dd::Tmat, 23_pc, 0);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 20_nc, 9);
circuit.addGate(dd::Tdagmat, 6_pc, 20_pc, 1);
circuit.addGate(dd::Xmat, 9_nc, 13);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Ymat, 0_nc, 1);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Xmat, 6_pc, 12_nc, 13);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Hmat, 9_nc, 16_pc, 5);
circuit.addGate(dd::Tmat, 3_nc, 25);
circuit.addGate(dd::Zmat, 20_nc, 17);
circuit.addGate(dd::Xmat, 20_pc, 16_nc, 8);
circuit.addGate(dd::Zmat, 22_pc, 16_pc, 25);
circuit.addGate(dd::Zmat, 10_pc, 6_pc, 9);
circuit.addGate(dd::Xmat, 23_pc, 14);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Tmat, 21_pc, 25);
circuit.addGate(dd::Tdagmat, 16_pc, 1);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Tdagmat, 19_nc, 9);
circuit.addGate(dd::Zmat, 17_nc, 7);
circuit.addGate(dd::Ymat, 12_nc, 2_nc, 20);
circuit.addGate(dd::Tmat, 15_pc, 17_nc, 10);
circuit.addGate(dd::Hmat, 0_pc, 25_nc, 17);
circuit.addGate(dd::Smat, 22_nc, 14_pc, 3);
circuit.addGate(dd::Xmat, 11_pc, 13_pc, 5);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Xmat, 8_nc, 25_nc, 12);
circuit.addGate(dd::Smat, 9_pc, 6);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tmat, 12_nc, 21);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 3_pc, 4);
circuit.addGate(dd::Hmat, 9_pc, 7);
circuit.addGate(dd::Smat, 4_pc, 2);
circuit.addGate(dd::Ymat, 0_nc, 19_pc, 18);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Hmat, 5_pc, 15);
circuit.addGate(dd::Smat, 9_pc, 2);
circuit.addGate(dd::Tdagmat, 22_pc, 17_pc, 13);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Ymat, 18_nc, 19);
circuit.addGate(dd::Tdagmat, 19_pc, 22);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Zmat, 6_pc, 11);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 18_pc, 12);
circuit.addGate(dd::Tdagmat, 18_pc, 11);
circuit.addGate(dd::Xmat, 1_nc, 4_pc, 21);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Tdagmat, 25_pc, 15);
circuit.addGate(dd::Ymat, 18_nc, 4_nc, 25);
circuit.addGate(dd::Smat, 0_pc, 12_pc, 25);
circuit.addGate(dd::Xmat, 18_pc, 25);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Smat, 1_pc, 4_pc, 0);
circuit.addGate(dd::Tdagmat, 19_pc, 4_nc, 24);
circuit.addGate(dd::Tmat, 0);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 27 qubis, containing 270 gates.
TEST(LimTest, hardCircuit_27) {
dd::QuantumCircuit circuit(27);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Hmat, 11_pc, 19);
circuit.addGate(dd::Zmat, 25_nc, 11);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Tdagmat, 26_pc, 3);
circuit.addGate(dd::Tdagmat, 2_pc, 9);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Smat, 2_pc, 16_nc, 1);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Smat, 13_pc, 1);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 2_pc, 7);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 10_pc, 17_pc, 12);
circuit.addGate(dd::Tmat, 18_nc, 17);
circuit.addGate(dd::Tdagmat, 22_nc, 4_nc, 3);
circuit.addGate(dd::Tdagmat, 1_pc, 14);
circuit.addGate(dd::Tdagmat, 6_nc, 5);
circuit.addGate(dd::Hmat, 6_pc, 13_nc, 16);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Xmat, 20_nc, 3_nc, 25);
circuit.addGate(dd::Tmat, 15_pc, 13);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tdagmat, 5_nc, 26);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Smat, 5_pc, 6);
circuit.addGate(dd::Hmat, 8_pc, 14_pc, 4);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 1_nc, 24_nc, 16);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Zmat, 19_pc, 25);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Hmat, 23_nc, 2_pc, 21);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Xmat, 1_pc, 9_nc, 0);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Xmat, 24_pc, 11);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Hmat, 3_nc, 4);
circuit.addGate(dd::Hmat, 10_nc, 13);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Tdagmat, 17_pc, 2_pc, 12);
circuit.addGate(dd::Smat, 7_pc, 18_nc, 0);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 10_pc, 25);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tdagmat, 17_nc, 18);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Hmat, 13_nc, 2);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tdagmat, 17_nc, 19);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Tmat, 12_nc, 13_nc, 18);
circuit.addGate(dd::Smat, 1_pc, 23_nc, 11);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Ymat, 6_pc, 9_pc, 15);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Ymat, 21_nc, 19_nc, 20);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Smat, 15_nc, 7_nc, 18);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Tdagmat, 5_pc, 12_nc, 23);
circuit.addGate(dd::Tmat, 24_nc, 23_nc, 2);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Xmat, 0_pc, 3);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Zmat, 0_pc, 4);
circuit.addGate(dd::Tmat, 4_pc, 22_nc, 0);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 25_pc, 16);
circuit.addGate(dd::Tmat, 18_pc, 8_nc, 9);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Tmat, 1_nc, 17_pc, 7);
circuit.addGate(dd::Tmat, 5_pc, 15);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Hmat, 9_nc, 7_nc, 18);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Xmat, 21_pc, 4);
circuit.addGate(dd::Ymat, 1_nc, 14_pc, 15);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Smat, 14_nc, 16_nc, 15);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 20_nc, 22_pc, 26);
circuit.addGate(dd::Zmat, 5_pc, 7_nc, 1);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 0_nc, 25);
circuit.addGate(dd::Zmat, 10_nc, 7_pc, 1);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Zmat, 7_pc, 0);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Smat, 26_nc, 16);
circuit.addGate(dd::Tmat, 17_pc, 10);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Zmat, 19_nc, 3);
circuit.addGate(dd::Hmat, 0_pc, 21_pc, 24);
circuit.addGate(dd::Zmat, 25_nc, 4_pc, 14);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Smat, 16_nc, 10);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tmat, 5_pc, 1_pc, 22);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Smat, 3_pc, 5_nc, 20);
circuit.addGate(dd::Hmat, 14_pc, 25);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Xmat, 19_pc, 14);
circuit.addGate(dd::Tmat, 20_nc, 7);
circuit.addGate(dd::Ymat, 3_nc, 25);
circuit.addGate(dd::Tdagmat, 5_nc, 24);
circuit.addGate(dd::Ymat, 26_nc, 24);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Xmat, 24_pc, 26);
circuit.addGate(dd::Xmat, 2_nc, 22);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Xmat, 12_nc, 10);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 22_pc, 2);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Smat, 22_pc, 11);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Xmat, 7_nc, 6);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Zmat, 21_nc, 0_pc, 26);
circuit.addGate(dd::Tdagmat, 23_pc, 16);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Zmat, 8_nc, 10);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Ymat, 6_pc, 20);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tdagmat, 4_nc, 14);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Xmat, 24_pc, 14);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Tdagmat, 23_pc, 1_pc, 16);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tdagmat, 14_nc, 8);
circuit.addGate(dd::Ymat, 16_pc, 12);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Ymat, 5_pc, 1_nc, 2);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Xmat, 23_nc, 12);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Smat, 3_pc, 19_pc, 20);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Xmat, 13_nc, 21_pc, 18);
circuit.addGate(dd::Zmat, 8_pc, 21_pc, 7);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Xmat, 1_pc, 7_nc, 12);
circuit.addGate(dd::Xmat, 20_nc, 12_nc, 0);
circuit.addGate(dd::Ymat, 16_nc, 20);
circuit.addGate(dd::Smat, 7_nc, 13);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Hmat, 13_pc, 24_nc, 17);
circuit.addGate(dd::Smat, 17_nc, 24);
circuit.addGate(dd::Tdagmat, 16_pc, 23);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Smat, 12_pc, 18_nc, 23);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Zmat, 19_pc, 16);
circuit.addGate(dd::Tdagmat, 20_pc, 25_pc, 12);
circuit.addGate(dd::Ymat, 6_nc, 7_pc, 16);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Zmat, 15_nc, 12_nc, 23);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Zmat, 22_nc, 18_pc, 1);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 5_pc, 26);
circuit.addGate(dd::Tmat, 17_pc, 6_nc, 1);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Smat, 22_pc, 11);
circuit.addGate(dd::Tmat, 25_pc, 12_nc, 18);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 21_pc, 24_pc, 16);
circuit.addGate(dd::Tdagmat, 14_nc, 19_nc, 2);
circuit.addGate(dd::Hmat, 6_pc, 15);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tdagmat, 23_nc, 15);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Hmat, 12_pc, 20_nc, 21);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Hmat, 13_pc, 25);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Hmat, 5_pc, 25_pc, 23);
circuit.addGate(dd::Tmat, 10_nc, 18_nc, 5);
circuit.addGate(dd::Smat, 19_pc, 5);
circuit.addGate(dd::Hmat, 10_nc, 3_pc, 0);
circuit.addGate(dd::Tmat, 25_pc, 10);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Hmat, 22_pc, 13_pc, 12);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Ymat, 23_nc, 12_nc, 24);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Tmat, 15_pc, 4);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tdagmat, 9);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 28 qubis, containing 280 gates.
TEST(LimTest, hardCircuit_28) {
dd::QuantumCircuit circuit(28);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tdagmat, 7_nc, 24_nc, 25);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Tdagmat, 18_pc, 15);
circuit.addGate(dd::Tdagmat, 25_pc, 17);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Smat, 12_pc, 7_nc, 21);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Smat, 20_pc, 4);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Xmat, 23_pc, 27);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Ymat, 4_pc, 1_pc, 22);
circuit.addGate(dd::Tmat, 9_nc, 10);
circuit.addGate(dd::Tdagmat, 18_nc, 17_nc, 26);
circuit.addGate(dd::Tdagmat, 5_pc, 25);
circuit.addGate(dd::Tdagmat, 27_nc, 21);
circuit.addGate(dd::Hmat, 6_pc, 7_nc, 3);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Xmat, 22_nc, 6_nc, 4);
circuit.addGate(dd::Tmat, 9_pc, 3);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tdagmat, 17_nc, 1);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Smat, 27_pc, 13);
circuit.addGate(dd::Hmat, 23_pc, 13_pc, 16);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 5_nc, 24_nc, 8);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Zmat, 18_pc, 7);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Hmat, 19_nc, 21_pc, 14);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Xmat, 12_pc, 27_nc, 7);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Xmat, 15_pc, 24);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Hmat, 24_nc, 5);
circuit.addGate(dd::Hmat, 22_nc, 2);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Tdagmat, 3_pc, 23_pc, 26);
circuit.addGate(dd::Smat, 15_nc, 26_pc, 2);
circuit.addGate(dd::Xmat, 6_pc, 25);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tdagmat, 20_pc, 14);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 15_nc, 6);
circuit.addGate(dd::Tmat, 4_nc, 22);
circuit.addGate(dd::Xmat, 1_pc, 16);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Smat, 5_pc, 17);
circuit.addGate(dd::Tmat, 27);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Smat, 1_pc, 19_nc, 24);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Ymat, 15_pc, 10_pc, 22);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Ymat, 4_nc, 24_nc, 3);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 12_nc, 7_nc, 21);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Tdagmat, 9_pc, 7_nc, 2);
circuit.addGate(dd::Tmat, 1_nc, 18_nc, 7);
circuit.addGate(dd::Xmat, 14_pc, 26_nc, 18);
circuit.addGate(dd::Xmat, 6_pc, 15);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Zmat, 13_pc, 12);
circuit.addGate(dd::Tmat, 0_pc, 16_nc, 21);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Smat, 18_pc, 6);
circuit.addGate(dd::Tmat, 23_pc, 16_nc, 22);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Tmat, 27_nc, 24_pc, 14);
circuit.addGate(dd::Tmat, 15_pc, 20);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Hmat, 13_nc, 16_nc, 18);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Xmat, 19_pc, 8);
circuit.addGate(dd::Ymat, 8_nc, 11_pc, 0);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 16_nc, 9_nc, 18);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 18_nc, 23_pc, 27);
circuit.addGate(dd::Zmat, 25_pc, 6_pc, 27);
circuit.addGate(dd::Tdagmat, 4_nc, 24);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Hmat, 25_pc, 18_nc, 23);
circuit.addGate(dd::Tdagmat, 25_nc, 2_pc, 16);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Smat, 9_nc, 1);
circuit.addGate(dd::Tmat, 1_pc, 23);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Zmat, 26_nc, 7);
circuit.addGate(dd::Hmat, 2_pc, 20_pc, 14);
circuit.addGate(dd::Zmat, 18_nc, 11_pc, 17);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Smat, 15_nc, 12);
circuit.addGate(dd::Ymat, 4_nc, 22);
circuit.addGate(dd::Ymat, 5_nc, 25_pc, 19);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Hmat, 15_pc, 10_pc, 17);
circuit.addGate(dd::Zmat, 7_pc, 8_pc, 0);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Xmat, 25_pc, 23);
circuit.addGate(dd::Tmat, 7_nc, 6);
circuit.addGate(dd::Ymat, 16_nc, 7);
circuit.addGate(dd::Tdagmat, 5_nc, 13);
circuit.addGate(dd::Ymat, 15_nc, 22);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Xmat, 12_pc, 16);
circuit.addGate(dd::Xmat, 25_nc, 26);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Xmat, 27_nc, 23);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 12_pc, 5);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Smat, 5_nc, 26);
circuit.addGate(dd::Smat, 11_nc, 12);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Smat, 22_pc, 20_nc, 17);
circuit.addGate(dd::Xmat, 25);
circuit.addGate(dd::Tmat, 14_nc, 23_nc, 19);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Zmat, 12_nc, 23);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 11_pc, 25);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Tdagmat, 8_nc, 12);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Xmat, 27_pc, 15);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Tdagmat, 27_nc, 12_pc, 19);
circuit.addGate(dd::Xmat, 3_nc, 2);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tdagmat, 15_nc, 8);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Xmat, 7_nc, 12_nc, 23);
circuit.addGate(dd::Xmat, 16_nc, 13_nc, 0);
circuit.addGate(dd::Tmat, 15_nc, 17_nc, 0);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Tdagmat, 18_pc, 2_pc, 27);
circuit.addGate(dd::Smat, 1_pc, 27);
circuit.addGate(dd::Xmat, 5_pc, 21);
circuit.addGate(dd::Zmat, 8_pc, 7_pc, 6);
circuit.addGate(dd::Tdagmat, 14_nc, 19);
circuit.addGate(dd::Ymat, 3_nc, 16);
circuit.addGate(dd::Smat, 5_nc, 11);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Hmat, 17_pc, 26_nc, 14);
circuit.addGate(dd::Smat, 7_nc, 12);
circuit.addGate(dd::Tdagmat, 0_pc, 19);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Smat, 5_pc, 4_nc, 13);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Zmat, 11_pc, 15);
circuit.addGate(dd::Tdagmat, 8_nc, 21_pc, 1);
circuit.addGate(dd::Ymat, 1_pc, 13_nc, 15);
circuit.addGate(dd::Tmat, 20_pc, 19);
circuit.addGate(dd::Ymat, 27_nc, 26_nc, 11);
circuit.addGate(dd::Xmat, 27_pc, 6);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Ymat, 22_nc, 8);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tdagmat, 5_pc, 18_pc, 12);
circuit.addGate(dd::Tdagmat, 8_pc, 14);
circuit.addGate(dd::Ymat, 18_pc, 11_nc, 3);
circuit.addGate(dd::Tdagmat, 1_pc, 21_nc, 7);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Ymat, 5_pc, 22_pc, 2);
circuit.addGate(dd::Tdagmat, 27_nc, 14_nc, 5);
circuit.addGate(dd::Hmat, 3_pc, 4);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Tdagmat, 7_nc, 9);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Hmat, 26_pc, 17_nc, 9);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Hmat, 19_pc, 8);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Hmat, 21_pc, 17_pc, 20);
circuit.addGate(dd::Ymat, 2_pc, 4_pc, 9);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Tdagmat, 17_nc, 0_pc, 4);
circuit.addGate(dd::Tmat, 2_pc, 1);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Hmat, 4_pc, 27_nc, 7);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Tmat, 20_nc, 16_pc, 11);
circuit.addGate(dd::Ymat, 3_pc, 26_pc, 4);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tmat, 12_pc, 6_nc, 4);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Xmat, 26_nc, 22_pc, 10);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Smat, 2_pc, 19);
circuit.addGate(dd::Ymat, 7_pc, 2);
circuit.addGate(dd::Zmat, 25_pc, 4_pc, 3);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 6_nc, 19_pc, 14);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tmat, 1_nc, 26);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Ymat, 1_pc, 24_pc, 18);
circuit.addGate(dd::Smat, 3);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 29 qubis, containing 290 gates.
TEST(LimTest, hardCircuit_29) {
dd::QuantumCircuit circuit(29);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Hmat, 1_nc, 22_nc, 4);
circuit.addGate(dd::Hmat, 20_pc, 25);
circuit.addGate(dd::Tmat, 24_nc, 5);
circuit.addGate(dd::Hmat, 13_pc, 22);
circuit.addGate(dd::Smat, 6_nc, 1);
circuit.addGate(dd::Xmat, 2_nc, 17);
circuit.addGate(dd::Tdagmat, 7_nc, 13);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Tdagmat, 8_nc, 19);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Ymat, 23_pc, 12);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 6_pc, 27);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Xmat, 8_pc, 18_pc, 11);
circuit.addGate(dd::Tmat, 1_pc, 0);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Zmat, 24_pc, 16);
circuit.addGate(dd::Zmat, 6_nc, 26_pc, 21);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Smat, 23_nc, 14);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Smat, 18_pc, 13_nc, 23);
circuit.addGate(dd::Xmat, 18_pc, 5);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Ymat, 11_nc, 20_pc, 13);
circuit.addGate(dd::Smat, 12_nc, 25);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tmat, 6_pc, 8);
circuit.addGate(dd::Smat, 8_nc, 2_nc, 23);
circuit.addGate(dd::Smat, 25_pc, 9_nc, 22);
circuit.addGate(dd::Ymat, 2_pc, 25_pc, 27);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 11_nc, 12_pc, 19);
circuit.addGate(dd::Ymat, 18_pc, 19);
circuit.addGate(dd::Ymat, 10_pc, 20);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Ymat, 21_nc, 14_pc, 11);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Smat, 1_pc, 14_pc, 27);
circuit.addGate(dd::Xmat, 19_nc, 14_pc, 20);
circuit.addGate(dd::Hmat, 6_pc, 12_nc, 8);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Ymat, 10_pc, 27);
circuit.addGate(dd::Hmat, 16_nc, 12_nc, 22);
circuit.addGate(dd::Zmat, 3_nc, 11_pc, 24);
circuit.addGate(dd::Tmat, 22_pc, 8);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Hmat, 26_nc, 24);
circuit.addGate(dd::Tdagmat, 6_nc, 9_nc, 19);
circuit.addGate(dd::Tdagmat, 0_pc, 11_pc, 26);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Zmat, 16_nc, 19);
circuit.addGate(dd::Zmat, 5_pc, 7);
circuit.addGate(dd::Hmat, 13_nc, 6);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Smat, 28_pc, 23);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Xmat, 21_pc, 27_pc, 12);
circuit.addGate(dd::Xmat, 21_nc, 17);
circuit.addGate(dd::Xmat, 28);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Smat, 2_pc, 9);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 26_nc, 2_pc, 6);
circuit.addGate(dd::Xmat, 18_nc, 16_nc, 21);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Ymat, 24_pc, 20_pc, 22);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Ymat, 28_nc, 7);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Ymat, 25_nc, 8_pc, 0);
circuit.addGate(dd::Smat, 0_nc, 5);
circuit.addGate(dd::Tdagmat, 21_nc, 23_nc, 22);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Smat, 26);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Ymat, 8_pc, 12);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Smat, 26_nc, 13_pc, 20);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 6_pc, 7_nc, 18);
circuit.addGate(dd::Tdagmat, 28_pc, 8_pc, 16);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 6_pc, 4_pc, 26);
circuit.addGate(dd::Hmat, 28_nc, 14_nc, 4);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Tmat, 18_pc, 20_pc, 19);
circuit.addGate(dd::Hmat, 23_nc, 5_nc, 9);
circuit.addGate(dd::Tdagmat, 4_nc, 9_nc, 14);
circuit.addGate(dd::Tdagmat, 26_pc, 0_pc, 8);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Xmat, 6_nc, 0);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 12_nc, 26);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Zmat, 5_nc, 23);
circuit.addGate(dd::Zmat, 7_nc, 6);
circuit.addGate(dd::Tmat, 8_nc, 14_nc, 23);
circuit.addGate(dd::Xmat, 22_pc, 9_nc, 17);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Tdagmat, 15_pc, 18);
circuit.addGate(dd::Xmat, 21_nc, 2_pc, 14);
circuit.addGate(dd::Xmat, 5_pc, 11_nc, 0);
circuit.addGate(dd::Tmat, 24_pc, 23);
circuit.addGate(dd::Ymat, 0_pc, 19);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 5_nc, 20_pc, 21);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Xmat, 17_pc, 24_pc, 10);
circuit.addGate(dd::Ymat, 8_pc, 13);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Tdagmat, 26_pc, 5);
circuit.addGate(dd::Tdagmat, 18_pc, 16_pc, 9);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Smat, 12_nc, 15);
circuit.addGate(dd::Zmat, 0_pc, 3);
circuit.addGate(dd::Xmat, 3_pc, 13_pc, 9);
circuit.addGate(dd::Tmat, 10_nc, 28);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Smat, 28_pc, 15);
circuit.addGate(dd::Smat, 8_pc, 11);
circuit.addGate(dd::Tdagmat, 12_pc, 7_nc, 11);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Xmat, 28);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Zmat, 6_pc, 15_pc, 5);
circuit.addGate(dd::Smat, 9_nc, 26);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Tmat, 0_pc, 23_nc, 26);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Ymat, 15_nc, 0);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Hmat, 4_nc, 25_nc, 24);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Ymat, 14_pc, 21);
circuit.addGate(dd::Hmat, 24_pc, 1);
circuit.addGate(dd::Hmat, 3_nc, 23);
circuit.addGate(dd::Smat, 6_pc, 10);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Smat, 3_pc, 20);
circuit.addGate(dd::Hmat, 13_nc, 3_nc, 15);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Tdagmat, 27_pc, 1_nc, 14);
circuit.addGate(dd::Tmat, 4_pc, 13);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Xmat, 5_pc, 25_pc, 19);
circuit.addGate(dd::Ymat, 18_pc, 4_pc, 26);
circuit.addGate(dd::Hmat, 10_nc, 14);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Smat, 20_nc, 3_pc, 15);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Hmat, 18_pc, 1_pc, 28);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Xmat, 0_nc, 26_nc, 17);
circuit.addGate(dd::Ymat, 16_pc, 11_pc, 13);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Hmat, 10_nc, 18);
circuit.addGate(dd::Tmat, 2_nc, 9_nc, 5);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Ymat, 15_nc, 23_pc, 24);
circuit.addGate(dd::Tmat, 26_pc, 2_pc, 15);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Zmat, 17_pc, 2);
circuit.addGate(dd::Smat, 23_nc, 12);
circuit.addGate(dd::Smat, 26_pc, 5_nc, 19);
circuit.addGate(dd::Zmat, 11_nc, 17_pc, 22);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Ymat, 14_nc, 5_nc, 4);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tdagmat, 0_pc, 13_nc, 8);
circuit.addGate(dd::Ymat, 10_pc, 2_pc, 13);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Smat, 16_pc, 24);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Zmat, 15_pc, 7_pc, 16);
circuit.addGate(dd::Smat, 8_pc, 6_nc, 7);
circuit.addGate(dd::Hmat, 18_pc, 11_nc, 5);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Tdagmat, 5_pc, 17_nc, 1);
circuit.addGate(dd::Smat, 24_nc, 4);
circuit.addGate(dd::Smat, 22_nc, 21_nc, 0);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Zmat, 15_nc, 24_pc, 18);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Hmat, 4_nc, 2_pc, 12);
circuit.addGate(dd::Xmat, 1_pc, 9);
circuit.addGate(dd::Ymat, 1_nc, 22);
circuit.addGate(dd::Smat, 6_pc, 19);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Ymat, 0_nc, 10);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 15_nc, 16_nc, 3);
circuit.addGate(dd::Zmat, 1_nc, 3);
circuit.addGate(dd::Hmat, 0_pc, 17_pc, 4);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Ymat, 25_nc, 15_nc, 22);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Zmat, 12_pc, 19);
circuit.addGate(dd::Xmat, 9_pc, 16);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Tdagmat, 14_pc, 26_nc, 0);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Tdagmat, 0_nc, 22_nc, 17);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Xmat, 6_nc, 26);
circuit.addGate(dd::Hmat, 15_nc, 23);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Zmat, 5_pc, 4_nc, 20);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Ymat, 24_pc, 4);
circuit.addGate(dd::Zmat, 27_pc, 26_pc, 16);
circuit.addGate(dd::Hmat, 20_nc, 8);
circuit.addGate(dd::Tdagmat, 4_pc, 17);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 30 qubis, containing 300 gates.
TEST(LimTest, hardCircuit_30) {
dd::QuantumCircuit circuit(30);

circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Zmat, 27_nc, 29);
circuit.addGate(dd::Smat, 15_pc, 25);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Hmat, 11_pc, 27);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Hmat, 29_nc, 14_pc, 27);
circuit.addGate(dd::Hmat, 14_nc, 11_nc, 29);
circuit.addGate(dd::Smat, 29);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Xmat, 23_nc, 3_nc, 17);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Tmat, 0_nc, 24_nc, 9);
circuit.addGate(dd::Ymat, 26_pc, 4);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 29_pc, 5);
circuit.addGate(dd::Hmat, 23_pc, 4_nc, 11);
circuit.addGate(dd::Tdagmat, 6_nc, 15_pc, 29);
circuit.addGate(dd::Zmat, 28);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Tdagmat, 29_nc, 17);
circuit.addGate(dd::Zmat, 15_nc, 14);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 18_nc, 26);
circuit.addGate(dd::Hmat, 18_nc, 12_pc, 0);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Hmat, 3_pc, 22_nc, 19);
circuit.addGate(dd::Hmat, 5_pc, 23_pc, 17);
circuit.addGate(dd::Zmat, 29_nc, 19_nc, 13);
circuit.addGate(dd::Xmat, 2_pc, 11_pc, 4);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tmat, 20_pc, 5_pc, 1);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Smat, 16_nc, 13_nc, 23);
circuit.addGate(dd::Smat, 26_nc, 25);
circuit.addGate(dd::Xmat, 12_pc, 8);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Ymat, 29_pc, 26_pc, 17);
circuit.addGate(dd::Hmat, 6_pc, 25_pc, 28);
circuit.addGate(dd::Smat, 20_nc, 4);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Tmat, 5_pc, 16);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Smat, 22_pc, 16);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 4_nc, 27_nc, 22);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Ymat, 20_nc, 29_pc, 21);
circuit.addGate(dd::Xmat, 5_pc, 2_nc, 19);
circuit.addGate(dd::Tmat, 15_nc, 18_nc, 4);
circuit.addGate(dd::Zmat, 19_nc, 18_nc, 9);
circuit.addGate(dd::Tdagmat, 19_nc, 12);
circuit.addGate(dd::Zmat, 0_nc, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Zmat, 10_nc, 27);
circuit.addGate(dd::Tdagmat, 0_pc, 12_nc, 11);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Xmat, 6_nc, 15_nc, 19);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Xmat, 27_pc, 25);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Tmat, 12_nc, 0_nc, 1);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Hmat, 0_nc, 24);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Xmat, 28_pc, 15);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Ymat, 21_pc, 15_pc, 17);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 3_pc, 19_nc, 22);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Hmat, 4_pc, 9);
circuit.addGate(dd::Ymat, 16_nc, 29);
circuit.addGate(dd::Smat, 29);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Smat, 25_pc, 6);
circuit.addGate(dd::Zmat, 23_nc, 7_pc, 4);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Hmat, 23_pc, 22_pc, 5);
circuit.addGate(dd::Hmat, 19_nc, 7_pc, 13);
circuit.addGate(dd::Smat, 22_nc, 4_pc, 5);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Ymat, 13_pc, 11);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Zmat, 18_nc, 29);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 13_pc, 23);
circuit.addGate(dd::Tdagmat, 15_pc, 7);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Zmat, 18_nc, 11);
circuit.addGate(dd::Zmat, 28_nc, 26_nc, 9);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Tmat, 14_pc, 19_nc, 16);
circuit.addGate(dd::Smat, 22_nc, 12);
circuit.addGate(dd::Ymat, 21_nc, 23);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Zmat, 2_pc, 0_nc, 26);
circuit.addGate(dd::Tdagmat, 28_pc, 21);
circuit.addGate(dd::Smat, 6_nc, 13_nc, 28);
circuit.addGate(dd::Ymat, 15_nc, 3_pc, 1);
circuit.addGate(dd::Zmat, 6_nc, 29_pc, 7);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Tmat, 14_nc, 0_nc, 23);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Hmat, 1_pc, 16);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Smat, 0_pc, 23);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Ymat, 13_pc, 12_pc, 27);
circuit.addGate(dd::Smat, 21_pc, 0_pc, 23);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Smat, 28_pc, 9_nc, 21);
circuit.addGate(dd::Smat, 24_nc, 28_pc, 4);
circuit.addGate(dd::Xmat, 9_nc, 5);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Smat, 23_nc, 10_pc, 3);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Smat, 10_pc, 0);
circuit.addGate(dd::Ymat, 23_pc, 3);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Smat, 4_pc, 23);
circuit.addGate(dd::Ymat, 17_nc, 15);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tmat, 25_nc, 4_pc, 14);
circuit.addGate(dd::Zmat, 1_nc, 17);
circuit.addGate(dd::Zmat, 6_pc, 17);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tdagmat, 10_pc, 7_pc, 24);
circuit.addGate(dd::Tmat, 7_nc, 2_nc, 12);
circuit.addGate(dd::Smat, 22_pc, 6_nc, 5);
circuit.addGate(dd::Tmat, 10_nc, 14_nc, 29);
circuit.addGate(dd::Hmat, 23_nc, 29_nc, 15);
circuit.addGate(dd::Tdagmat, 14_pc, 4_pc, 20);
circuit.addGate(dd::Ymat, 16_nc, 10);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Smat, 6_nc, 21);
circuit.addGate(dd::Zmat, 25_pc, 21);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Hmat, 0_nc, 21);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Hmat, 11_nc, 3);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Tmat, 5_nc, 1);
circuit.addGate(dd::Xmat, 13_pc, 2_nc, 15);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Tmat, 21_pc, 18);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Smat, 29);
circuit.addGate(dd::Ymat, 7_nc, 13_pc, 5);
circuit.addGate(dd::Tdagmat, 21_pc, 7);
circuit.addGate(dd::Xmat, 25_pc, 29);
circuit.addGate(dd::Ymat, 0_nc, 1_pc, 23);
circuit.addGate(dd::Zmat, 29_nc, 23);
circuit.addGate(dd::Ymat, 15_nc, 24_nc, 28);
circuit.addGate(dd::Smat, 9_pc, 17);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tdagmat, 20_pc, 16_pc, 19);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Hmat, 27_pc, 20);
circuit.addGate(dd::Zmat, 19_nc, 2);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Tmat, 12_pc, 2_nc, 26);
circuit.addGate(dd::Tmat, 6_pc, 19_nc, 20);
circuit.addGate(dd::Hmat, 26_nc, 16_nc, 29);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Tdagmat, 20_nc, 19_pc, 6);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 13_nc, 0_pc, 14);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Smat, 3_pc, 0_nc, 21);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Smat, 12_nc, 28);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 10_nc, 25_pc, 18);
circuit.addGate(dd::Hmat, 4_nc, 1);
circuit.addGate(dd::Zmat, 7_nc, 5);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Tmat, 11_pc, 21);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Tmat, 23_nc, 1);
circuit.addGate(dd::Xmat, 1_pc, 4_pc, 11);
circuit.addGate(dd::Xmat, 17_pc, 2_nc, 11);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Tmat, 3_pc, 2);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Smat, 6_pc, 25_nc, 20);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Hmat, 26_pc, 8);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Hmat, 1_nc, 12_nc, 22);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Zmat, 23_pc, 12_pc, 2);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Smat, 20_nc, 23);
circuit.addGate(dd::Tdagmat, 27_nc, 4);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Tmat, 14_nc, 0);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Ymat, 28_pc, 24_nc, 7);
circuit.addGate(dd::Ymat, 28);
circuit.addGate(dd::Zmat, 28_pc, 23_nc, 18);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Tmat, 10_nc, 8_nc, 26);
circuit.addGate(dd::Hmat, 17_nc, 29_nc, 4);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11_nc, 21);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Ymat, 2_nc, 17);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Tdagmat, 14_pc, 15);
circuit.addGate(dd::Tmat, 29_nc, 22);
circuit.addGate(dd::Smat, 3_nc, 24);
circuit.addGate(dd::Tdagmat, 12_pc, 0_pc, 9);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tmat, 23_pc, 15_pc, 16);
circuit.addGate(dd::Zmat, 19_pc, 21_nc, 3);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Ymat, 10_nc, 5_nc, 27);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Ymat, 20_nc, 25);
circuit.addGate(dd::Hmat, 16_pc, 25_nc, 1);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Zmat, 12_nc, 1);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 31 qubis, containing 310 gates.
TEST(LimTest, hardCircuit_31) {
dd::QuantumCircuit circuit(31);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Tdagmat, 30);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Hmat, 26_pc, 30_pc, 3);
circuit.addGate(dd::Hmat, 16_pc, 20_pc, 15);
circuit.addGate(dd::Xmat, 17_nc, 26_nc, 30);
circuit.addGate(dd::Tmat, 7_nc, 1_pc, 24);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Smat, 9_pc, 12_nc, 13);
circuit.addGate(dd::Xmat, 1_nc, 5);
circuit.addGate(dd::Smat, 23_nc, 19_pc, 8);
circuit.addGate(dd::Hmat, 21_pc, 5);
circuit.addGate(dd::Zmat, 19_pc, 6);
circuit.addGate(dd::Smat, 7_nc, 26);
circuit.addGate(dd::Hmat, 13_pc, 26);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Smat, 27_nc, 17_nc, 24);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Xmat, 9_pc, 3);
circuit.addGate(dd::Ymat, 15_pc, 6_pc, 10);
circuit.addGate(dd::Tdagmat, 21_nc, 10_nc, 27);
circuit.addGate(dd::Tdagmat, 2_nc, 0_pc, 15);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Tdagmat, 16_pc, 3);
circuit.addGate(dd::Ymat, 27_nc, 12_pc, 23);
circuit.addGate(dd::Smat, 19_nc, 6);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Tmat, 19_pc, 5);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 16_nc, 28_pc, 3);
circuit.addGate(dd::Smat, 13_pc, 23_pc, 19);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Hmat, 21_nc, 6);
circuit.addGate(dd::Smat, 2_nc, 10);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Tmat, 3_nc, 2_pc, 12);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Ymat, 11_pc, 16);
circuit.addGate(dd::Smat, 27_pc, 4);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Ymat, 15_pc, 12_nc, 27);
circuit.addGate(dd::Tmat, 23_nc, 27_nc, 26);
circuit.addGate(dd::Tdagmat, 24_pc, 28_nc, 22);
circuit.addGate(dd::Smat, 21_pc, 1);
circuit.addGate(dd::Xmat, 6_nc, 8);
circuit.addGate(dd::Smat, 29_nc, 15_pc, 4);
circuit.addGate(dd::Smat, 16_pc, 27);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Tmat, 4_pc, 1);
circuit.addGate(dd::Ymat, 30);
circuit.addGate(dd::Hmat, 29_pc, 1_pc, 5);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Hmat, 28_pc, 10);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tmat, 3_nc, 21_pc, 10);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Tdagmat, 30_pc, 5_nc, 9);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Smat, 26);
circuit.addGate(dd::Zmat, 5_nc, 4);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Smat, 10_pc, 9);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Hmat, 9_nc, 1);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Smat, 15_pc, 3_nc, 1);
circuit.addGate(dd::Smat, 12_nc, 13);
circuit.addGate(dd::Zmat, 25_pc, 12);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Tdagmat, 1_nc, 11);
circuit.addGate(dd::Tdagmat, 18_pc, 21);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Ymat, 16_nc, 18_pc, 29);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Zmat, 9_pc, 5_nc, 14);
circuit.addGate(dd::Xmat, 14_pc, 0_nc, 26);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Tmat, 15_pc, 21_pc, 28);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Hmat, 7_nc, 1_pc, 29);
circuit.addGate(dd::Zmat, 21_nc, 23_nc, 17);
circuit.addGate(dd::Smat, 25_nc, 24_pc, 5);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tdagmat, 22_nc, 12);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Zmat, 13_nc, 27);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Zmat, 24_pc, 15_nc, 13);
circuit.addGate(dd::Ymat, 12_pc, 1_nc, 15);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Ymat, 17_nc, 26);
circuit.addGate(dd::Xmat, 12_nc, 13_pc, 19);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tdagmat, 15_nc, 30_pc, 8);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Tmat, 2_nc, 16);
circuit.addGate(dd::Hmat, 1_pc, 21);
circuit.addGate(dd::Tmat, 3_pc, 19_pc, 21);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Ymat, 3_pc, 22);
circuit.addGate(dd::Hmat, 1_pc, 22_nc, 29);
circuit.addGate(dd::Tdagmat, 16_nc, 0_nc, 26);
circuit.addGate(dd::Tmat, 17_nc, 27_nc, 0);
circuit.addGate(dd::Ymat, 2_nc, 9_pc, 13);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 25_pc, 4_nc, 26);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Ymat, 9_nc, 6);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Zmat, 2_pc, 25);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Zmat, 26_nc, 21);
circuit.addGate(dd::Xmat, 8_pc, 20);
circuit.addGate(dd::Tdagmat, 1_pc, 30);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Hmat, 21_nc, 17);
circuit.addGate(dd::Zmat, 5_pc, 16_nc, 20);
circuit.addGate(dd::Xmat, 19_pc, 12);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Hmat, 6_nc, 14);
circuit.addGate(dd::Smat, 24_pc, 28);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tmat, 20_pc, 19);
circuit.addGate(dd::Smat, 9_pc, 21_nc, 10);
circuit.addGate(dd::Tdagmat, 24_pc, 14_pc, 26);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Zmat, 16_pc, 15);
circuit.addGate(dd::Ymat, 13_pc, 27_pc, 3);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Xmat, 9_pc, 4_nc, 16);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Xmat, 25);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tmat, 28_nc, 25);
circuit.addGate(dd::Zmat, 0_nc, 14_pc, 9);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Tdagmat, 21_pc, 17_nc, 9);
circuit.addGate(dd::Tmat, 9_nc, 15_pc, 20);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tdagmat, 13_nc, 21_nc, 15);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Zmat, 2_nc, 0_nc, 6);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tmat, 23_pc, 17);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Hmat, 14_nc, 22_nc, 13);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Smat, 27);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tmat, 23_pc, 6);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Zmat, 5_pc, 27_nc, 8);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Tmat, 27_pc, 10);
circuit.addGate(dd::Zmat, 28_nc, 6);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Ymat, 13_pc, 19);
circuit.addGate(dd::Ymat, 30_nc, 12_pc, 13);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Ymat, 13_pc, 21);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Zmat, 22_pc, 11);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tmat, 12_nc, 3_nc, 2);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Zmat, 0_nc, 28);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tdagmat, 5_pc, 21_pc, 2);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Smat, 3_pc, 22);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Xmat, 0_pc, 19_pc, 18);
circuit.addGate(dd::Ymat, 29_nc, 5_nc, 8);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Hmat, 0_nc, 24_pc, 7);
circuit.addGate(dd::Hmat, 24_nc, 25_pc, 20);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tdagmat, 29_pc, 26_nc, 1);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Smat, 13_nc, 15);
circuit.addGate(dd::Smat, 4_pc, 5_pc, 15);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Xmat, 1_nc, 5);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Hmat, 27_pc, 15);
circuit.addGate(dd::Ymat, 27_pc, 14_nc, 12);
circuit.addGate(dd::Zmat, 11_pc, 28);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Zmat, 22_pc, 3_pc, 30);
circuit.addGate(dd::Tdagmat, 1_nc, 22);
circuit.addGate(dd::Zmat, 27_nc, 13);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Tdagmat, 11_pc, 23_nc, 17);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Smat, 8_pc, 22);
circuit.addGate(dd::Tdagmat, 7_nc, 27);
circuit.addGate(dd::Xmat, 11_pc, 1);
circuit.addGate(dd::Ymat, 20_nc, 22);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Smat, 1_nc, 23);
circuit.addGate(dd::Smat, 0_pc, 4_pc, 26);
circuit.addGate(dd::Xmat, 29_pc, 27);
circuit.addGate(dd::Zmat, 14_pc, 16);
circuit.addGate(dd::Tmat, 3_nc, 13);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Xmat, 9_nc, 7);
circuit.addGate(dd::Hmat, 4_nc, 0_pc, 11);
circuit.addGate(dd::Tmat, 24_pc, 2);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Zmat, 10_nc, 16);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Tmat, 30);
circuit.addGate(dd::Hmat, 6_nc, 8_pc, 2);
circuit.addGate(dd::Tdagmat, 15_nc, 4);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Ymat, 26_pc, 21_nc, 16);
circuit.addGate(dd::Tmat, 3_nc, 16_nc, 18);
circuit.addGate(dd::Tdagmat, 25_pc, 19_nc, 18);
circuit.addGate(dd::Xmat, 18_pc, 20_pc, 0);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Tmat, 29_nc, 24_nc, 14);
circuit.addGate(dd::Zmat, 28_nc, 6_nc, 12);
circuit.addGate(dd::Xmat, 0_nc, 16_nc, 9);
circuit.addGate(dd::Tmat, 27_pc, 23);
circuit.addGate(dd::Smat, 27);
circuit.addGate(dd::Ymat, 26_nc, 15_pc, 30);
circuit.addGate(dd::Tmat, 28_pc, 7);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Ymat, 24_nc, 25_nc, 5);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tdagmat, 7_nc, 12);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 32 qubis, containing 320 gates.
TEST(LimTest, hardCircuit_32) {
dd::QuantumCircuit circuit(32);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Smat, 8_pc, 20);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Ymat, 30);
circuit.addGate(dd::Hmat, 20_nc, 24_nc, 16);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Ymat, 12_pc, 5);
circuit.addGate(dd::Hmat, 7_pc, 24_pc, 4);
circuit.addGate(dd::Ymat, 17_nc, 20_nc, 1);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Zmat, 19_pc, 18_pc, 14);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Tdagmat, 26_nc, 2_nc, 23);
circuit.addGate(dd::Smat, 26_pc, 19_pc, 9);
circuit.addGate(dd::Smat, 5_pc, 13);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Tdagmat, 2_pc, 8);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Tmat, 31_nc, 12);
circuit.addGate(dd::Hmat, 3_nc, 5);
circuit.addGate(dd::Tdagmat, 23_pc, 9_pc, 4);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Zmat, 3_pc, 9);
circuit.addGate(dd::Ymat, 30_nc, 6);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Hmat, 31_nc, 14);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Hmat, 3_pc, 30_pc, 1);
circuit.addGate(dd::Smat, 5_pc, 24_nc, 4);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tmat, 0_nc, 8_nc, 1);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Xmat, 15_pc, 20_pc, 27);
circuit.addGate(dd::Tmat, 27_pc, 9_pc, 10);
circuit.addGate(dd::Zmat, 3_nc, 20);
circuit.addGate(dd::Smat, 6_pc, 12);
circuit.addGate(dd::Tmat, 20_pc, 0_pc, 25);
circuit.addGate(dd::Ymat, 14_nc, 4);
circuit.addGate(dd::Tdagmat, 21_pc, 11_nc, 9);
circuit.addGate(dd::Tmat, 27);
circuit.addGate(dd::Tdagmat, 14_pc, 7);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Ymat, 31_pc, 27);
circuit.addGate(dd::Tdagmat, 6_pc, 22);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Xmat, 9_pc, 22_pc, 11);
circuit.addGate(dd::Tmat, 18_pc, 19);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Hmat, 31_pc, 15_nc, 23);
circuit.addGate(dd::Zmat, 29_pc, 9);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Smat, 13_nc, 15);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Zmat, 27_nc, 12);
circuit.addGate(dd::Ymat, 12_pc, 26_pc, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Ymat, 9_pc, 31_nc, 8);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Tmat, 8_nc, 18_nc, 13);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Hmat, 13_nc, 5);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tmat, 21);
circuit.addGate(dd::Xmat, 9_nc, 25);
circuit.addGate(dd::Smat, 27);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Smat, 11_pc, 15);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 26_nc, 2_nc, 29);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Tdagmat, 7_nc, 8_pc, 31);
circuit.addGate(dd::Hmat, 8_nc, 29);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tdagmat, 31_pc, 5);
circuit.addGate(dd::Zmat, 25_nc, 15_nc, 3);
circuit.addGate(dd::Smat, 6_pc, 18_nc, 31);
circuit.addGate(dd::Tdagmat, 8_pc, 0);
circuit.addGate(dd::Tmat, 22_nc, 17);
circuit.addGate(dd::Tdagmat, 25_nc, 10_pc, 22);
circuit.addGate(dd::Ymat, 21_nc, 22);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Xmat, 3_pc, 12);
circuit.addGate(dd::Tmat, 16_nc, 12);
circuit.addGate(dd::Ymat, 28_nc, 25_nc, 18);
circuit.addGate(dd::Ymat, 30_pc, 15);
circuit.addGate(dd::Tdagmat, 30);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Tmat, 25_pc, 10_nc, 2);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Ymat, 14_nc, 18);
circuit.addGate(dd::Smat, 26_pc, 5);
circuit.addGate(dd::Tmat, 14_pc, 3);
circuit.addGate(dd::Smat, 16_pc, 20_nc, 13);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Xmat, 31_pc, 26_nc, 29);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Zmat, 7_pc, 22_nc, 18);
circuit.addGate(dd::Tdagmat, 19_pc, 24_nc, 1);
circuit.addGate(dd::Xmat, 17_pc, 25_nc, 18);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tmat, 3_nc, 23_pc, 18);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Tmat, 26_pc, 4);
circuit.addGate(dd::Zmat, 30_pc, 2_nc, 12);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Xmat, 24_pc, 20);
circuit.addGate(dd::Ymat, 3_nc, 29);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Xmat, 31_nc, 22);
circuit.addGate(dd::Tdagmat, 31_pc, 5_nc, 1);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Smat, 13_nc, 11_pc, 22);
circuit.addGate(dd::Zmat, 5_pc, 12_pc, 30);
circuit.addGate(dd::Hmat, 8_pc, 28_pc, 23);
circuit.addGate(dd::Zmat, 28);
circuit.addGate(dd::Smat, 8_pc, 22);
circuit.addGate(dd::Hmat, 10_nc, 16_nc, 23);
circuit.addGate(dd::Hmat, 26_nc, 21);
circuit.addGate(dd::Tdagmat, 25_nc, 17);
circuit.addGate(dd::Zmat, 3_pc, 0);
circuit.addGate(dd::Tdagmat, 24_nc, 6_pc, 2);
circuit.addGate(dd::Xmat, 30_nc, 11_pc, 22);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Smat, 25_nc, 23_nc, 0);
circuit.addGate(dd::Tmat, 5_pc, 24);
circuit.addGate(dd::Xmat, 6_pc, 18_pc, 26);
circuit.addGate(dd::Hmat, 27_pc, 7_pc, 6);
circuit.addGate(dd::Smat, 16_pc, 7);
circuit.addGate(dd::Xmat, 11_pc, 26_nc, 19);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Ymat, 0_pc, 14_pc, 25);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Hmat, 19_nc, 21_nc, 12);
circuit.addGate(dd::Ymat, 5_pc, 2_nc, 8);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Ymat, 29_nc, 25);
circuit.addGate(dd::Zmat, 9_pc, 30);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tdagmat, 13_pc, 9);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tdagmat, 25_pc, 14_pc, 6);
circuit.addGate(dd::Ymat, 2_pc, 28);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Tdagmat, 24_nc, 0);
circuit.addGate(dd::Ymat, 28);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Tmat, 24_nc, 19);
circuit.addGate(dd::Smat, 2_pc, 26);
circuit.addGate(dd::Hmat, 30_nc, 2_nc, 1);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Xmat, 28);
circuit.addGate(dd::Ymat, 25_nc, 23);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Tdagmat, 8_pc, 30);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Tdagmat, 11_pc, 21);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Smat, 10_pc, 18_pc, 5);
circuit.addGate(dd::Smat, 6_pc, 20_pc, 19);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Xmat, 13_pc, 28_nc, 24);
circuit.addGate(dd::Ymat, 13_nc, 29);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Xmat, 31_pc, 11);
circuit.addGate(dd::Zmat, 20_pc, 5);
circuit.addGate(dd::Tdagmat, 25_nc, 30);
circuit.addGate(dd::Hmat, 24_nc, 8_nc, 22);
circuit.addGate(dd::Xmat, 11_nc, 8_nc, 28);
circuit.addGate(dd::Tmat, 16_nc, 11);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Smat, 28_nc, 9_nc, 3);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tdagmat, 0_nc, 21);
circuit.addGate(dd::Zmat, 16_pc, 27);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Hmat, 4_nc, 15);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Zmat, 29_nc, 10_nc, 1);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Xmat, 28_nc, 2_nc, 14);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Smat, 2_pc, 8_pc, 1);
circuit.addGate(dd::Tmat, 18_pc, 13_nc, 17);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Zmat, 12_pc, 27_nc, 28);
circuit.addGate(dd::Zmat, 19_pc, 31);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 5_nc, 28_pc, 19);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tmat, 12_nc, 8_nc, 0);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tmat, 18_nc, 27_pc, 16);
circuit.addGate(dd::Hmat, 23_nc, 5_pc, 21);
circuit.addGate(dd::Tdagmat, 17_nc, 30_pc, 11);
circuit.addGate(dd::Ymat, 18_nc, 10_pc, 4);
circuit.addGate(dd::Ymat, 22_nc, 23_nc, 21);
circuit.addGate(dd::Tmat, 14_nc, 25_nc, 3);
circuit.addGate(dd::Xmat, 9_nc, 28_nc, 17);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tdagmat, 9_nc, 18);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Tdagmat, 7_pc, 20_pc, 25);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 30_pc, 16);
circuit.addGate(dd::Ymat, 1_nc, 30);
circuit.addGate(dd::Tmat, 6_nc, 15_nc, 24);
circuit.addGate(dd::Xmat, 27_nc, 24_nc, 19);
circuit.addGate(dd::Tdagmat, 0_pc, 22_nc, 15);
circuit.addGate(dd::Xmat, 12_nc, 2);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Xmat, 7_pc, 13);
circuit.addGate(dd::Xmat, 22_pc, 1_nc, 27);
circuit.addGate(dd::Zmat, 1_pc, 2_nc, 21);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Ymat, 5_nc, 14);
circuit.addGate(dd::Zmat, 7_pc, 2);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Ymat, 11_nc, 17);
circuit.addGate(dd::Smat, 12_pc, 3_nc, 10);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Smat, 26_nc, 10_pc, 1);
circuit.addGate(dd::Smat, 18_pc, 3_nc, 1);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tdagmat, 21_pc, 19);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Ymat, 15_pc, 6_nc, 17);
circuit.addGate(dd::Tmat, 0_nc, 23);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Zmat, 31_pc, 2_pc, 0);
circuit.addGate(dd::Tdagmat, 4_nc, 24_pc, 19);
circuit.addGate(dd::Zmat, 21_pc, 30);
circuit.addGate(dd::Tmat, 10_nc, 21);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Zmat, 4_pc, 26_pc, 5);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Zmat, 24_pc, 29_nc, 25);
circuit.addGate(dd::Tmat, 17_pc, 0);
circuit.addGate(dd::Ymat, 29_pc, 7_pc, 15);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Zmat, 30_nc, 29_pc, 1);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Xmat, 2_nc, 17);
circuit.addGate(dd::Xmat, 13_pc, 29_nc, 10);
circuit.addGate(dd::Ymat, 21_nc, 18_nc, 23);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Hmat, 8_pc, 20_pc, 23);
circuit.addGate(dd::Ymat, 22_nc, 9);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Xmat, 20_nc, 12_nc, 8);
circuit.addGate(dd::Tmat, 30_nc, 13_pc, 22);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Xmat, 19_pc, 18);
circuit.addGate(dd::Hmat, 17_nc, 13_pc, 9);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Hmat, 15_pc, 16);
circuit.addGate(dd::Ymat, 23_pc, 24);
circuit.addGate(dd::Xmat, 23);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 33 qubis, containing 330 gates.
TEST(LimTest, hardCircuit_33) {
dd::QuantumCircuit circuit(33);

circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Zmat, 20_nc, 16);
circuit.addGate(dd::Xmat, 13_pc, 2);
circuit.addGate(dd::Zmat, 7_nc, 9);
circuit.addGate(dd::Hmat, 31_nc, 22_pc, 32);
circuit.addGate(dd::Zmat, 22_nc, 8);
circuit.addGate(dd::Tdagmat, 31);
circuit.addGate(dd::Hmat, 16_pc, 2);
circuit.addGate(dd::Hmat, 19_pc, 10_pc, 25);
circuit.addGate(dd::Xmat, 28_pc, 32);
circuit.addGate(dd::Tmat, 7_nc, 21);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tdagmat, 31_nc, 28);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Smat, 0_pc, 29_pc, 2);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Ymat, 27);
circuit.addGate(dd::Zmat, 26_pc, 16);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Xmat, 23_nc, 4_nc, 7);
circuit.addGate(dd::Hmat, 23_nc, 20_nc, 26);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Zmat, 12_pc, 9);
circuit.addGate(dd::Hmat, 31_pc, 24);
circuit.addGate(dd::Zmat, 12_nc, 11_nc, 19);
circuit.addGate(dd::Ymat, 5_nc, 24);
circuit.addGate(dd::Tdagmat, 28_nc, 1);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tdagmat, 29_pc, 7);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Tdagmat, 29_nc, 18);
circuit.addGate(dd::Hmat, 21_nc, 3);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Tmat, 26_pc, 11);
circuit.addGate(dd::Zmat, 31_nc, 24_pc, 2);
circuit.addGate(dd::Xmat, 6_pc, 29);
circuit.addGate(dd::Ymat, 3_nc, 17_pc, 22);
circuit.addGate(dd::Xmat, 20_nc, 9);
circuit.addGate(dd::Xmat, 7_pc, 16_nc, 12);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Tmat, 0_pc, 18_pc, 4);
circuit.addGate(dd::Smat, 21_pc, 27);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Hmat, 12_nc, 3_nc, 5);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Zmat, 17_nc, 26_pc, 13);
circuit.addGate(dd::Smat, 15_pc, 19_nc, 23);
circuit.addGate(dd::Xmat, 10_pc, 12_pc, 32);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Hmat, 17_nc, 9);
circuit.addGate(dd::Tdagmat, 15);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Tmat, 27_pc, 8_pc, 11);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 4_pc, 6_pc, 31);
circuit.addGate(dd::Tmat, 9_pc, 14);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Zmat, 32);
circuit.addGate(dd::Hmat, 22_nc, 19_pc, 7);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Zmat, 28);
circuit.addGate(dd::Smat, 24_nc, 12);
circuit.addGate(dd::Smat, 17_nc, 8);
circuit.addGate(dd::Tmat, 1_nc, 24_pc, 15);
circuit.addGate(dd::Hmat, 24_pc, 4);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Hmat, 12_nc, 22);
circuit.addGate(dd::Hmat, 7_pc, 3);
circuit.addGate(dd::Xmat, 28);
circuit.addGate(dd::Ymat, 30);
circuit.addGate(dd::Hmat, 3_pc, 15_nc, 27);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Xmat, 32_nc, 2_nc, 8);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Hmat, 27_nc, 18);
circuit.addGate(dd::Zmat, 2_nc, 27);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Hmat, 11_nc, 1_nc, 18);
circuit.addGate(dd::Hmat, 25_nc, 12);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Ymat, 6_nc, 15_pc, 26);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Xmat, 27_nc, 26_nc, 19);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Smat, 12_nc, 31_nc, 3);
circuit.addGate(dd::Ymat, 13_nc, 22);
circuit.addGate(dd::Tmat, 23_pc, 17_pc, 7);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Ymat, 25_pc, 26_pc, 4);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Zmat, 29_pc, 19);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Tmat, 3_nc, 12);
circuit.addGate(dd::Smat, 7_pc, 1_pc, 24);
circuit.addGate(dd::Hmat, 1_pc, 0_nc, 28);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Smat, 9_nc, 0);
circuit.addGate(dd::Xmat, 24_pc, 21);
circuit.addGate(dd::Zmat, 21_nc, 20_nc, 15);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Tdagmat, 26_pc, 22);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Xmat, 25_nc, 15_pc, 23);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Tdagmat, 27_pc, 8);
circuit.addGate(dd::Tdagmat, 30_nc, 15);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Tdagmat, 13_nc, 28_pc, 11);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Zmat, 7_pc, 14);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Hmat, 24_nc, 17_nc, 15);
circuit.addGate(dd::Xmat, 8_nc, 30);
circuit.addGate(dd::Xmat, 18_pc, 29);
circuit.addGate(dd::Zmat, 11_nc, 8_pc, 5);
circuit.addGate(dd::Smat, 20_nc, 32_nc, 5);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 9_nc, 1);
circuit.addGate(dd::Ymat, 24_nc, 25_pc, 5);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Tdagmat, 24_pc, 6_pc, 19);
circuit.addGate(dd::Smat, 1_pc, 16_nc, 28);
circuit.addGate(dd::Ymat, 32_nc, 6_pc, 15);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Zmat, 28_pc, 4);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Hmat, 5_pc, 24);
circuit.addGate(dd::Zmat, 12_nc, 32);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tdagmat, 0_nc, 27_nc, 3);
circuit.addGate(dd::Ymat, 10_nc, 19_pc, 3);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Tdagmat, 28_pc, 17);
circuit.addGate(dd::Hmat, 20_nc, 19_nc, 9);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Xmat, 15_nc, 5);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Smat, 10_nc, 21_pc, 23);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Ymat, 21_pc, 20);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Tdagmat, 24_nc, 16);
circuit.addGate(dd::Zmat, 3_nc, 17);
circuit.addGate(dd::Smat, 32);
circuit.addGate(dd::Zmat, 20_nc, 15);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Smat, 8_pc, 25_pc, 20);
circuit.addGate(dd::Zmat, 13_pc, 17_nc, 26);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tdagmat, 30);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Xmat, 22_nc, 5);
circuit.addGate(dd::Ymat, 28_nc, 16_pc, 15);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Zmat, 13_pc, 10_nc, 9);
circuit.addGate(dd::Tmat, 16_pc, 30);
circuit.addGate(dd::Zmat, 19);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Ymat, 21_nc, 15);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Smat, 2_nc, 20_pc, 25);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Xmat, 16_nc, 5_pc, 10);
circuit.addGate(dd::Hmat, 9_pc, 1_nc, 15);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Xmat, 12_nc, 24);
circuit.addGate(dd::Smat, 5_nc, 24);
circuit.addGate(dd::Tmat, 32_pc, 14_pc, 27);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Tmat, 10_pc, 12);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Tmat, 3_nc, 22);
circuit.addGate(dd::Smat, 31_pc, 30);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Xmat, 30_nc, 25_pc, 23);
circuit.addGate(dd::Ymat, 21_nc, 17_nc, 23);
circuit.addGate(dd::Xmat, 11_nc, 13);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 28);
circuit.addGate(dd::Hmat, 0_pc, 3_pc, 12);
circuit.addGate(dd::Xmat, 25_nc, 2);
circuit.addGate(dd::Zmat, 13_pc, 11);
circuit.addGate(dd::Ymat, 21_pc, 20);
circuit.addGate(dd::Tdagmat, 30_nc, 17);
circuit.addGate(dd::Xmat, 2_pc, 6_nc, 32);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Ymat, 2_pc, 4_nc, 3);
circuit.addGate(dd::Smat, 28_pc, 9);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Xmat, 9_nc, 2_pc, 6);
circuit.addGate(dd::Ymat, 0_nc, 32);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Zmat, 19_pc, 17);
circuit.addGate(dd::Xmat, 1_pc, 27);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Tmat, 9_pc, 27_nc, 19);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Tmat, 28_nc, 18_pc, 23);
circuit.addGate(dd::Tmat, 18_nc, 2);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tmat, 6_nc, 31_nc, 29);
circuit.addGate(dd::Smat, 3_nc, 13);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Hmat, 8_nc, 5_nc, 18);
circuit.addGate(dd::Hmat, 17_nc, 13);
circuit.addGate(dd::Hmat, 21_pc, 29);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Xmat, 22_nc, 5);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Hmat, 29_nc, 26);
circuit.addGate(dd::Ymat, 18_nc, 19);
circuit.addGate(dd::Hmat, 29_nc, 15_nc, 17);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 8_nc, 25);
circuit.addGate(dd::Smat, 2_nc, 12_pc, 29);
circuit.addGate(dd::Ymat, 6_nc, 22);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Zmat, 27_pc, 11);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Zmat, 21_pc, 0_nc, 11);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Tmat, 18_pc, 0);
circuit.addGate(dd::Xmat, 21_pc, 27);
circuit.addGate(dd::Xmat, 2_nc, 6_pc, 29);
circuit.addGate(dd::Zmat, 12_pc, 8_pc, 31);
circuit.addGate(dd::Ymat, 5_nc, 11_nc, 25);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Tmat, 32_nc, 15_pc, 18);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 21_nc, 2_nc, 9);
circuit.addGate(dd::Smat, 12_nc, 20_pc, 7);
circuit.addGate(dd::Zmat, 20_pc, 1);
circuit.addGate(dd::Smat, 16_nc, 19);
circuit.addGate(dd::Xmat, 0_nc, 26);
circuit.addGate(dd::Hmat, 2_nc, 22);
circuit.addGate(dd::Tmat, 28_pc, 10);
circuit.addGate(dd::Tdagmat, 31_nc, 11_nc, 17);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 22);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Hmat, 28_pc, 18);
circuit.addGate(dd::Zmat, 25_pc, 14_pc, 2);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Xmat, 18_pc, 27_nc, 5);
circuit.addGate(dd::Xmat, 32);
circuit.addGate(dd::Zmat, 26_nc, 8);
circuit.addGate(dd::Ymat, 21_nc, 26_nc, 19);
circuit.addGate(dd::Tdagmat, 16_pc, 8);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 34 qubis, containing 340 gates.
TEST(LimTest, hardCircuit_34) {
dd::QuantumCircuit circuit(34);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Hmat, 32);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Smat, 32_pc, 4_nc, 29);
circuit.addGate(dd::Zmat, 16_pc, 10);
circuit.addGate(dd::Tdagmat, 26_nc, 17);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Zmat, 5_nc, 2);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 21_pc, 0_pc, 26);
circuit.addGate(dd::Ymat, 13_nc, 7);
circuit.addGate(dd::Hmat, 20_pc, 12_pc, 24);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Smat, 13_pc, 18);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Hmat, 19_pc, 33);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Hmat, 26_nc, 17);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Tmat, 29_pc, 26_pc, 17);
circuit.addGate(dd::Xmat, 3_pc, 13);
circuit.addGate(dd::Smat, 27);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Tmat, 9_pc, 15);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Ymat, 15_pc, 11_pc, 12);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Xmat, 23_pc, 13);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tdagmat, 27_nc, 29_nc, 10);
circuit.addGate(dd::Hmat, 4_nc, 26_nc, 18);
circuit.addGate(dd::Smat, 12_nc, 19_pc, 1);
circuit.addGate(dd::Smat, 16_pc, 27_pc, 6);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Xmat, 28_nc, 21_pc, 25);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Tmat, 30_nc, 16_nc, 6);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Xmat, 1_nc, 4);
circuit.addGate(dd::Smat, 28_nc, 0);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Zmat, 30);
circuit.addGate(dd::Smat, 31_pc, 15_pc, 7);
circuit.addGate(dd::Xmat, 17_pc, 1);
circuit.addGate(dd::Ymat, 16_nc, 14);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Tdagmat, 27_nc, 18_nc, 6);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 32_nc, 28_pc, 33);
circuit.addGate(dd::Zmat, 29_pc, 13_nc, 12);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Xmat, 8_pc, 30_pc, 9);
circuit.addGate(dd::Tdagmat, 10_nc, 12);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 31_nc, 2);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tdagmat, 5_nc, 16_pc, 10);
circuit.addGate(dd::Ymat, 14_nc, 5);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Tdagmat, 1_pc, 28);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Hmat, 10_pc, 18);
circuit.addGate(dd::Zmat, 8_pc, 13);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 11_pc, 20);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Ymat, 5_pc, 1_nc, 4);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Tdagmat, 25_nc, 3_nc, 21);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Tmat, 14);
circuit.addGate(dd::Tmat, 1_pc, 19);
circuit.addGate(dd::Smat, 5_pc, 32_pc, 3);
circuit.addGate(dd::Zmat, 32_pc, 14_pc, 3);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Zmat, 24_nc, 12);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Zmat, 24_nc, 25);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Xmat, 8_pc, 10_pc, 5);
circuit.addGate(dd::Tdagmat, 30_nc, 33_nc, 28);
circuit.addGate(dd::Xmat, 22_pc, 19);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Zmat, 11_pc, 12_nc, 21);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Smat, 16_nc, 27_nc, 21);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Smat, 31_nc, 6_nc, 2);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Tdagmat, 2_nc, 15);
circuit.addGate(dd::Tdagmat, 11_pc, 16_pc, 18);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Hmat, 9_nc, 27);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Ymat, 30_nc, 6_nc, 9);
circuit.addGate(dd::Hmat, 17_nc, 25_pc, 6);
circuit.addGate(dd::Tdagmat, 1_nc, 0);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Hmat, 18_nc, 1);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Xmat, 25_nc, 5_pc, 33);
circuit.addGate(dd::Zmat, 28_pc, 20);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Zmat, 30_pc, 31);
circuit.addGate(dd::Ymat, 25_nc, 21);
circuit.addGate(dd::Smat, 15);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Ymat, 13_nc, 14);
circuit.addGate(dd::Zmat, 1_nc, 6);
circuit.addGate(dd::Smat, 14_nc, 21);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Zmat, 3_pc, 13_pc, 33);
circuit.addGate(dd::Ymat, 16_pc, 27);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Ymat, 7_pc, 27);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 6_pc, 15_nc, 33);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tmat, 19_nc, 29);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Xmat, 14_nc, 24_pc, 0);
circuit.addGate(dd::Xmat, 30_nc, 22);
circuit.addGate(dd::Xmat, 23_nc, 15);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Smat, 33_nc, 14);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Ymat, 13_nc, 23_nc, 22);
circuit.addGate(dd::Xmat, 25);
circuit.addGate(dd::Tmat, 31);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Smat, 19_nc, 13);
circuit.addGate(dd::Hmat, 9_nc, 8);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tmat, 7_nc, 31_pc, 22);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 20_nc, 4_nc, 26);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Ymat, 15_nc, 18);
circuit.addGate(dd::Xmat, 17_nc, 5_pc, 30);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Xmat, 15_pc, 1);
circuit.addGate(dd::Zmat, 9_pc, 1);
circuit.addGate(dd::Zmat, 4_nc, 32);
circuit.addGate(dd::Tmat, 13_pc, 8);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Ymat, 17_pc, 10_pc, 11);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Ymat, 30_nc, 15_nc, 23);
circuit.addGate(dd::Tmat, 27_pc, 25_pc, 6);
circuit.addGate(dd::Tmat, 17_pc, 23_pc, 27);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Ymat, 23_pc, 2_nc, 9);
circuit.addGate(dd::Zmat, 3_pc, 2);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Ymat, 31);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Smat, 14_nc, 15_pc, 26);
circuit.addGate(dd::Zmat, 28);
circuit.addGate(dd::Tdagmat, 20_nc, 18);
circuit.addGate(dd::Ymat, 33);
circuit.addGate(dd::Ymat, 33_nc, 19_nc, 9);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Ymat, 26_nc, 27);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 10_nc, 13_pc, 32);
circuit.addGate(dd::Smat, 32);
circuit.addGate(dd::Tmat, 20_pc, 8_nc, 12);
circuit.addGate(dd::Smat, 32);
circuit.addGate(dd::Zmat, 33);
circuit.addGate(dd::Xmat, 15_pc, 1);
circuit.addGate(dd::Smat, 31_nc, 13);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Zmat, 26_pc, 19_nc, 10);
circuit.addGate(dd::Smat, 18_pc, 31);
circuit.addGate(dd::Zmat, 2_pc, 9_pc, 33);
circuit.addGate(dd::Smat, 9_pc, 0);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Tmat, 33_nc, 6);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Ymat, 13_pc, 8);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Hmat, 19_nc, 17);
circuit.addGate(dd::Hmat, 7_pc, 15_nc, 14);
circuit.addGate(dd::Xmat, 28);
circuit.addGate(dd::Hmat, 19_pc, 9_nc, 18);
circuit.addGate(dd::Smat, 22_nc, 29_pc, 18);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Smat, 31_nc, 19_pc, 28);
circuit.addGate(dd::Ymat, 2_pc, 20_pc, 10);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 17_nc, 0_nc, 28);
circuit.addGate(dd::Xmat, 27_pc, 24_nc, 33);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Smat, 1_nc, 31_pc, 22);
circuit.addGate(dd::Xmat, 11_nc, 18_nc, 8);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 26_nc, 7_nc, 33);
circuit.addGate(dd::Smat, 10_nc, 4_pc, 14);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Zmat, 2_nc, 21_pc, 26);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Hmat, 18_pc, 1_nc, 22);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Ymat, 23_pc, 11_nc, 20);
circuit.addGate(dd::Hmat, 18_nc, 25);
circuit.addGate(dd::Ymat, 15_nc, 11_pc, 24);
circuit.addGate(dd::Smat, 29_pc, 11);
circuit.addGate(dd::Tmat, 0_pc, 23_pc, 13);
circuit.addGate(dd::Xmat, 7_pc, 24_pc, 8);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Smat, 0_pc, 20_nc, 18);
circuit.addGate(dd::Zmat, 31_pc, 33);
circuit.addGate(dd::Zmat, 29_pc, 0_pc, 24);
circuit.addGate(dd::Tdagmat, 20_nc, 15);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Xmat, 29_nc, 31_pc, 21);
circuit.addGate(dd::Hmat, 10_pc, 16_nc, 5);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tmat, 8_pc, 20_pc, 19);
circuit.addGate(dd::Tdagmat, 19_nc, 11_nc, 32);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Hmat, 13_pc, 29);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Ymat, 33_pc, 17);
circuit.addGate(dd::Xmat, 16_nc, 7);
circuit.addGate(dd::Zmat, 1_pc, 15_pc, 16);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Tdagmat, 0_pc, 26_pc, 23);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Zmat, 8_nc, 19);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Tmat, 14_pc, 8_nc, 9);
circuit.addGate(dd::Smat, 3_pc, 32);
circuit.addGate(dd::Xmat, 25);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Xmat, 3_pc, 24);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Smat, 26_nc, 18);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 35 qubis, containing 350 gates.
TEST(LimTest, hardCircuit_35) {
dd::QuantumCircuit circuit(35);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 34);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tmat, 23_pc, 9);
circuit.addGate(dd::Ymat, 33);
circuit.addGate(dd::Tdagmat, 7_pc, 34_nc, 12);
circuit.addGate(dd::Ymat, 12_nc, 20);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Smat, 29);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Smat, 16_nc, 25);
circuit.addGate(dd::Tmat, 17_nc, 13);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Zmat, 4);
circuit.addGate(dd::Tmat, 22_nc, 21_pc, 6);
circuit.addGate(dd::Hmat, 24_nc, 32);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Tdagmat, 10_pc, 2);
circuit.addGate(dd::Tdagmat, 4_pc, 1_pc, 30);
circuit.addGate(dd::Hmat, 24_nc, 27_pc, 2);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Ymat, 3_pc, 7);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Ymat, 28);
circuit.addGate(dd::Xmat, 17_nc, 0);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tmat, 25_pc, 12_nc, 20);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Hmat, 28_nc, 10);
circuit.addGate(dd::Xmat, 22_pc, 9);
circuit.addGate(dd::Hmat, 14_nc, 26_pc, 24);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Xmat, 17_nc, 0);
circuit.addGate(dd::Zmat, 29_pc, 1_nc, 6);
circuit.addGate(dd::Zmat, 24_pc, 26_pc, 2);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Tdagmat, 16_nc, 7_pc, 14);
circuit.addGate(dd::Tmat, 30);
circuit.addGate(dd::Zmat, 30);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Zmat, 23_nc, 21);
circuit.addGate(dd::Smat, 3_nc, 12);
circuit.addGate(dd::Xmat, 20_pc, 5_nc, 9);
circuit.addGate(dd::Xmat, 9_nc, 21);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Hmat, 26_nc, 13_pc, 23);
circuit.addGate(dd::Tmat, 0_pc, 20);
circuit.addGate(dd::Tmat, 32_nc, 18_pc, 7);
circuit.addGate(dd::Tdagmat, 3_pc, 19_nc, 18);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Smat, 7_nc, 26);
circuit.addGate(dd::Xmat, 4_pc, 27);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Hmat, 31_nc, 3);
circuit.addGate(dd::Zmat, 31_pc, 13_nc, 28);
circuit.addGate(dd::Zmat, 0_pc, 19);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Tdagmat, 18_nc, 6_pc, 32);
circuit.addGate(dd::Ymat, 33);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Xmat, 8_pc, 0);
circuit.addGate(dd::Tdagmat, 7_nc, 2_pc, 21);
circuit.addGate(dd::Hmat, 17_nc, 4_nc, 8);
circuit.addGate(dd::Ymat, 19_pc, 21);
circuit.addGate(dd::Tmat, 3_nc, 26);
circuit.addGate(dd::Tdagmat, 10_nc, 24_nc, 11);
circuit.addGate(dd::Tdagmat, 34_nc, 32_pc, 25);
circuit.addGate(dd::Tdagmat, 27_pc, 19_pc, 6);
circuit.addGate(dd::Ymat, 2_pc, 10);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Tdagmat, 9_pc, 16);
circuit.addGate(dd::Ymat, 10_pc, 34);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Tdagmat, 7_pc, 30_nc, 22);
circuit.addGate(dd::Tmat, 26_pc, 31);
circuit.addGate(dd::Hmat, 4_nc, 21_nc, 10);
circuit.addGate(dd::Tdagmat, 28_nc, 18);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tdagmat, 13_pc, 7_pc, 28);
circuit.addGate(dd::Hmat, 34_pc, 21_nc, 23);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Tmat, 13_nc, 20_pc, 7);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 13_nc, 28);
circuit.addGate(dd::Xmat, 12_nc, 1);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Smat, 6_pc, 2);
circuit.addGate(dd::Tmat, 28_pc, 11_pc, 26);
circuit.addGate(dd::Tdagmat, 10_pc, 15_pc, 14);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Tdagmat, 26_nc, 29_pc, 34);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Ymat, 16_pc, 15_pc, 23);
circuit.addGate(dd::Smat, 27);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Tdagmat, 31_nc, 27);
circuit.addGate(dd::Tdagmat, 34_pc, 11);
circuit.addGate(dd::Tmat, 0_nc, 1_pc, 20);
circuit.addGate(dd::Tmat, 31);
circuit.addGate(dd::Tmat, 27_pc, 18);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Ymat, 13_pc, 28_pc, 16);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Tmat, 7);
circuit.addGate(dd::Zmat, 3_nc, 9);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Xmat, 34_pc, 2_nc, 33);
circuit.addGate(dd::Ymat, 15_nc, 23_nc, 25);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Hmat, 26_nc, 22_nc, 10);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Tmat, 11_nc, 31);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Xmat, 3_nc, 9_pc, 23);
circuit.addGate(dd::Zmat, 12_nc, 5);
circuit.addGate(dd::Tmat, 6);
circuit.addGate(dd::Tmat, 18_nc, 20_nc, 21);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Hmat, 14_pc, 32_pc, 10);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Tmat, 9_pc, 23_nc, 26);
circuit.addGate(dd::Smat, 30_pc, 17_nc, 14);
circuit.addGate(dd::Zmat, 16_pc, 5_nc, 22);
circuit.addGate(dd::Tdagmat, 15_pc, 10);
circuit.addGate(dd::Ymat, 27_pc, 6);
circuit.addGate(dd::Xmat, 7_pc, 16);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Ymat, 32);
circuit.addGate(dd::Ymat, 7_pc, 25);
circuit.addGate(dd::Smat, 24_nc, 27);
circuit.addGate(dd::Ymat, 14_pc, 30);
circuit.addGate(dd::Tmat, 34);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Tmat, 0_nc, 34);
circuit.addGate(dd::Ymat, 8_nc, 13);
circuit.addGate(dd::Ymat, 12_nc, 16);
circuit.addGate(dd::Zmat, 13_nc, 16_nc, 32);
circuit.addGate(dd::Ymat, 16_pc, 15_pc, 25);
circuit.addGate(dd::Smat, 23_pc, 5_pc, 32);
circuit.addGate(dd::Hmat, 13_nc, 24);
circuit.addGate(dd::Tmat, 0_pc, 23_nc, 10);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Ymat, 33);
circuit.addGate(dd::Tmat, 31);
circuit.addGate(dd::Ymat, 14_nc, 31);
circuit.addGate(dd::Zmat, 32);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Smat, 23_nc, 34);
circuit.addGate(dd::Tdagmat, 17_nc, 3);
circuit.addGate(dd::Tmat, 27);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Xmat, 18_nc, 33_pc, 1);
circuit.addGate(dd::Hmat, 29_nc, 26_nc, 15);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Xmat, 4_nc, 11_pc, 26);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tmat, 34_nc, 28);
circuit.addGate(dd::Tmat, 7_nc, 15_nc, 21);
circuit.addGate(dd::Xmat, 4_pc, 11_nc, 0);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Smat, 26);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Tmat, 30_pc, 31);
circuit.addGate(dd::Zmat, 1_nc, 17);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Ymat, 5_pc, 17_pc, 26);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Tdagmat, 10_nc, 7);
circuit.addGate(dd::Hmat, 2_pc, 27);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Zmat, 1_pc, 7);
circuit.addGate(dd::Xmat, 9_pc, 21);
circuit.addGate(dd::Smat, 10_nc, 9_pc, 29);
circuit.addGate(dd::Tdagmat, 17_nc, 6);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 1_pc, 33);
circuit.addGate(dd::Smat, 4_nc, 18_nc, 28);
circuit.addGate(dd::Tmat, 1_pc, 15_pc, 26);
circuit.addGate(dd::Ymat, 20);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Xmat, 28_nc, 0);
circuit.addGate(dd::Tmat, 6_pc, 29_nc, 10);
circuit.addGate(dd::Tmat, 5_pc, 22_nc, 7);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Zmat, 21_pc, 23);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Hmat, 14_nc, 27);
circuit.addGate(dd::Tmat, 9_pc, 32);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Ymat, 22_pc, 1);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Hmat, 17_pc, 15_nc, 10);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Smat, 8_pc, 5);
circuit.addGate(dd::Hmat, 32);
circuit.addGate(dd::Xmat, 9_nc, 26);
circuit.addGate(dd::Tmat, 27_nc, 14_nc, 18);
circuit.addGate(dd::Zmat, 4_nc, 20);
circuit.addGate(dd::Tdagmat, 33_pc, 23_nc, 14);
circuit.addGate(dd::Tdagmat, 31);
circuit.addGate(dd::Xmat, 21_nc, 0);
circuit.addGate(dd::Hmat, 8_nc, 16);
circuit.addGate(dd::Zmat, 32);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Tmat, 31_pc, 30_pc, 7);
circuit.addGate(dd::Tmat, 10_pc, 13_pc, 0);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Tmat, 12);
circuit.addGate(dd::Ymat, 32);
circuit.addGate(dd::Smat, 7_nc, 28);
circuit.addGate(dd::Tdagmat, 12_nc, 11);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tmat, 21_pc, 9);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Xmat, 6_nc, 0);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Smat, 27_pc, 8_nc, 34);
circuit.addGate(dd::Zmat, 18);
circuit.addGate(dd::Zmat, 12_nc, 34);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Hmat, 1_nc, 34);
circuit.addGate(dd::Ymat, 16_nc, 21);
circuit.addGate(dd::Tdagmat, 32);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tdagmat, 29_nc, 32);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Zmat, 9_pc, 18_nc, 21);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Tmat, 3_pc, 18);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Smat, 31_pc, 33_pc, 21);
circuit.addGate(dd::Hmat, 8_pc, 31_nc, 13);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Ymat, 20_pc, 24);
circuit.addGate(dd::Tmat, 17_nc, 6_nc, 30);
circuit.addGate(dd::Hmat, 31_pc, 0_pc, 5);
circuit.addGate(dd::Hmat, 31_pc, 5);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 3_pc, 30_nc, 18);
circuit.addGate(dd::Tmat, 25_pc, 18_pc, 28);
circuit.addGate(dd::Zmat, 33_nc, 8_nc, 1);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tmat, 10_nc, 5_nc, 9);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Zmat, 24_nc, 27_pc, 10);
circuit.addGate(dd::Tmat, 2_nc, 15);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Ymat, 30);
circuit.addGate(dd::Tdagmat, 14_nc, 5);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Ymat, 21_pc, 28_nc, 32);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Zmat, 7_pc, 33_pc, 19);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Zmat, 31_pc, 23);
circuit.addGate(dd::Xmat, 13_nc, 20);
circuit.addGate(dd::Hmat, 16_nc, 24);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Zmat, 11_nc, 1_nc, 12);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Xmat, 6_pc, 31_pc, 22);
circuit.addGate(dd::Hmat, 32_pc, 0_nc, 20);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Xmat, 34_nc, 32);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 21);
circuit.addGate(dd::Xmat, 23_pc, 15);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Tdagmat, 23_pc, 32_nc, 11);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Hmat, 22_pc, 34_pc, 11);
circuit.addGate(dd::Smat, 29_pc, 26_nc, 1);
circuit.addGate(dd::Smat, 13_nc, 7);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Ymat, 30);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 36 qubis, containing 360 gates.
TEST(LimTest, hardCircuit_36) {
dd::QuantumCircuit circuit(36);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Hmat, 35);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Zmat, 32_nc, 28_pc, 21);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Tdagmat, 15_nc, 28_nc, 32);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Xmat, 3);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Smat, 6_nc, 29);
circuit.addGate(dd::Tmat, 32_pc, 15);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Xmat, 16_nc, 20);
circuit.addGate(dd::Ymat, 35);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tmat, 23_nc, 11_pc, 17);
circuit.addGate(dd::Hmat, 15_nc, 31);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tdagmat, 17_pc, 33);
circuit.addGate(dd::Tdagmat, 23_pc, 29_nc, 21);
circuit.addGate(dd::Zmat, 16_nc, 5);
circuit.addGate(dd::Hmat, 13_nc, 19);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Smat, 19_pc, 13);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Zmat, 27_nc, 0);
circuit.addGate(dd::Tmat, 19_nc, 10_pc, 21);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Smat, 30_pc, 21_pc, 26);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Tdagmat, 9_pc, 26);
circuit.addGate(dd::Tmat, 15_pc, 4);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Zmat, 29_pc, 3_pc, 0);
circuit.addGate(dd::Xmat, 34);
circuit.addGate(dd::Tdagmat, 25_pc, 20_pc, 8);
circuit.addGate(dd::Zmat, 10_nc, 28_nc, 8);
circuit.addGate(dd::Zmat, 14_pc, 34);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Smat, 3_nc, 5_nc, 18);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Zmat, 5_pc, 6_nc, 19);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Xmat, 4_pc, 8_nc, 19);
circuit.addGate(dd::Hmat, 35_pc, 15);
circuit.addGate(dd::Ymat, 21_pc, 22);
circuit.addGate(dd::Ymat, 6_pc, 26);
circuit.addGate(dd::Tmat, 27_nc, 10_nc, 26);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Xmat, 18_nc, 35_pc, 17);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Hmat, 15_pc, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Smat, 32_pc, 30_nc, 21);
circuit.addGate(dd::Xmat, 11_pc, 2_pc, 17);
circuit.addGate(dd::Ymat, 26_pc, 22_pc, 31);
circuit.addGate(dd::Ymat, 13_pc, 3_nc, 22);
circuit.addGate(dd::Smat, 13_pc, 20);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Ymat, 22);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Hmat, 25_pc, 34);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Xmat, 35_nc, 15);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Tdagmat, 2);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Smat, 31);
circuit.addGate(dd::Zmat, 27_pc, 12);
circuit.addGate(dd::Xmat, 3_nc, 9);
circuit.addGate(dd::Tmat, 32_pc, 33_pc, 12);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Tdagmat, 29_nc, 20);
circuit.addGate(dd::Tmat, 30_nc, 6);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Xmat, 6_pc, 21_nc, 31);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tmat, 21_nc, 12_pc, 35);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 25_nc, 30);
circuit.addGate(dd::Xmat, 15_nc, 31);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Smat, 24_pc, 28);
circuit.addGate(dd::Tmat, 20_pc, 22_pc, 0);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Ymat, 29_nc, 13);
circuit.addGate(dd::Tdagmat, 1_nc, 0_pc, 25);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Ymat, 12_pc, 34_pc, 28);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Tdagmat, 35_nc, 17);
circuit.addGate(dd::Tdagmat, 0_pc, 20);
circuit.addGate(dd::Tmat, 9_nc, 30_pc, 11);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Tmat, 35_pc, 27);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Xmat, 32);
circuit.addGate(dd::Ymat, 27_pc, 33_pc, 22);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Zmat, 25_nc, 23);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Xmat, 32_pc, 18_nc, 8);
circuit.addGate(dd::Ymat, 19_nc, 15_nc, 12);
circuit.addGate(dd::Tdagmat, 35);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Hmat, 25_nc, 33_nc, 19);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Smat, 35);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Tmat, 19_nc, 32);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Xmat, 25_nc, 11_pc, 0);
circuit.addGate(dd::Zmat, 34_nc, 20);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Tmat, 11_nc, 31_nc, 19);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Hmat, 24_pc, 14_pc, 34);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Tmat, 27_pc, 30_pc, 16);
circuit.addGate(dd::Ymat, 21_pc, 9_pc, 22);
circuit.addGate(dd::Hmat, 21_pc, 14_pc, 32);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Zmat, 34_pc, 13_nc, 6);
circuit.addGate(dd::Tdagmat, 35_nc, 0_pc, 3);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Ymat, 29_pc, 20);
circuit.addGate(dd::Smat, 9_nc, 22);
circuit.addGate(dd::Ymat, 25_pc, 23);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Tmat, 8_nc, 4);
circuit.addGate(dd::Ymat, 3_nc, 16);
circuit.addGate(dd::Ymat, 16_nc, 26);
circuit.addGate(dd::Zmat, 0_nc, 17_nc, 11);
circuit.addGate(dd::Ymat, 30_pc, 6_pc, 10);
circuit.addGate(dd::Smat, 28_pc, 27_pc, 31);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Tmat, 24_pc, 28_nc, 8);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Ymat, 31);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Ymat, 28_nc, 19);
circuit.addGate(dd::Zmat, 13);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Smat, 13_nc, 20);
circuit.addGate(dd::Tdagmat, 17_nc, 5);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Xmat, 34_nc, 0_pc, 4);
circuit.addGate(dd::Hmat, 4_nc, 25_nc, 14);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Xmat, 10_nc, 19_pc, 20);
circuit.addGate(dd::Xmat, 31);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Tmat, 23_nc, 3);
circuit.addGate(dd::Tmat, 17_nc, 31_nc, 27);
circuit.addGate(dd::Xmat, 24_pc, 20_nc, 14);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Zmat, 11);
circuit.addGate(dd::Tmat, 17_pc, 30);
circuit.addGate(dd::Zmat, 6_nc, 9);
circuit.addGate(dd::Tmat, 30);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Ymat, 28_pc, 14_pc, 11);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Tdagmat, 31_nc, 18);
circuit.addGate(dd::Hmat, 5_pc, 30);
circuit.addGate(dd::Zmat, 35);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Zmat, 15_pc, 21);
circuit.addGate(dd::Xmat, 0_pc, 12);
circuit.addGate(dd::Smat, 20_nc, 31_pc, 19);
circuit.addGate(dd::Tdagmat, 12_nc, 3);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 22_pc, 9);
circuit.addGate(dd::Smat, 6_nc, 31_nc, 5);
circuit.addGate(dd::Tmat, 5_pc, 34_pc, 21);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Xmat, 32_nc, 27);
circuit.addGate(dd::Tmat, 7_pc, 33_nc, 19);
circuit.addGate(dd::Tmat, 3_pc, 13_nc, 8);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Zmat, 29_pc, 25);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Hmat, 32_nc, 33);
circuit.addGate(dd::Tmat, 29_pc, 19);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Ymat, 19_pc, 31);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 19_pc, 24_nc, 29);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Smat, 20_nc, 7);
circuit.addGate(dd::Zmat, 4_pc, 28);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Smat, 3_nc, 5_nc, 9);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Zmat, 34_nc, 26);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Xmat, 24_nc, 32);
circuit.addGate(dd::Hmat, 18_nc, 13);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Tmat, 12_pc, 7_pc, 30);
circuit.addGate(dd::Tmat, 13_pc, 9_pc, 35);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Smat, 3_nc, 2);
circuit.addGate(dd::Xmat, 35);
circuit.addGate(dd::Smat, 1_nc, 8);
circuit.addGate(dd::Ymat, 35);
circuit.addGate(dd::Hmat, 32_nc, 9_pc, 22);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Xmat, 1_nc, 26);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Smat, 7_nc, 19_pc, 2);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Hmat, 15_nc, 2);
circuit.addGate(dd::Tmat, 32);
circuit.addGate(dd::Ymat, 32_nc, 21_nc, 12);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Hmat, 18_nc, 10);
circuit.addGate(dd::Ymat, 33_nc, 35);
circuit.addGate(dd::Tdagmat, 22);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Zmat, 35);
circuit.addGate(dd::Tdagmat, 9_nc, 8);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Zmat, 15_pc, 7_nc, 11);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Tmat, 1_pc, 13);
circuit.addGate(dd::Tmat, 21_nc, 23);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Hmat, 7_pc, 29);
circuit.addGate(dd::Hmat, 3_pc, 32_nc, 16);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Ymat, 10_pc, 11);
circuit.addGate(dd::Tmat, 13_nc, 11_nc, 12);
circuit.addGate(dd::Hmat, 26_pc, 2_pc, 29);
circuit.addGate(dd::Hmat, 32_pc, 14);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Ymat, 15_pc, 23_nc, 5);
circuit.addGate(dd::Tmat, 2_pc, 33_pc, 16);
circuit.addGate(dd::Zmat, 15_nc, 31_nc, 26);
circuit.addGate(dd::Xmat, 6);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tmat, 19_nc, 1_nc, 6);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Xmat, 30);
circuit.addGate(dd::Zmat, 4_nc, 13_pc, 33);
circuit.addGate(dd::Tmat, 17_nc, 10);
circuit.addGate(dd::Tmat, 30);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Tdagmat, 21_nc, 35);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Ymat, 35_pc, 34_nc, 23);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Zmat, 1_pc, 27_pc, 0);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Zmat, 12_pc, 26);
circuit.addGate(dd::Xmat, 19_nc, 21);
circuit.addGate(dd::Hmat, 25_nc, 8);
circuit.addGate(dd::Smat, 23_nc, 27_pc, 22);
circuit.addGate(dd::Tdagmat, 28_nc, 22);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Ymat, 25_pc, 5);
circuit.addGate(dd::Zmat, 1_nc, 11_nc, 13);
circuit.addGate(dd::Xmat, 12_pc, 32_pc, 8);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Xmat, 19_pc, 14);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Tdagmat, 4_pc, 16_nc, 34);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Hmat, 28_pc, 14_pc, 6);
circuit.addGate(dd::Smat, 7_nc, 1_nc, 12);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Tdagmat, 6_pc, 1_nc, 2);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 37 qubis, containing 370 gates.
TEST(LimTest, hardCircuit_37) {
dd::QuantumCircuit circuit(37);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 21);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Hmat, 32);
circuit.addGate(dd::Hmat, 34);
circuit.addGate(dd::Hmat, 35);
circuit.addGate(dd::Hmat, 36);
circuit.addGate(dd::Smat, 28_pc, 10_nc, 1);
circuit.addGate(dd::Zmat, 24_nc, 8_pc, 27);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Ymat, 6);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Zmat, 10_pc, 12_pc, 32);
circuit.addGate(dd::Tmat, 21_nc, 18_pc, 26);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Tmat, 0_nc, 14_pc, 19);
circuit.addGate(dd::Zmat, 1_nc, 33);
circuit.addGate(dd::Hmat, 35);
circuit.addGate(dd::Hmat, 0_nc, 33);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Xmat, 21);
circuit.addGate(dd::Xmat, 35);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Tmat, 25_pc, 12_pc, 13);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Zmat, 8_pc, 18);
circuit.addGate(dd::Hmat, 5_nc, 20);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Smat, 3);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Hmat, 26_pc, 36);
circuit.addGate(dd::Xmat, 14_nc, 12);
circuit.addGate(dd::Smat, 11_nc, 22_nc, 1);
circuit.addGate(dd::Tdagmat, 17_nc, 3);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Zmat, 16_pc, 9_nc, 18);
circuit.addGate(dd::Hmat, 35_pc, 21);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Zmat, 32_nc, 23_nc, 4);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tdagmat, 19_pc, 20_pc, 14);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Ymat, 16_nc, 25_pc, 15);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Tmat, 28_nc, 8_pc, 16);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Tdagmat, 29_pc, 13_nc, 10);
circuit.addGate(dd::Smat, 12_pc, 18);
circuit.addGate(dd::Tmat, 31_pc, 11);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Zmat, 23_nc, 19);
circuit.addGate(dd::Xmat, 36);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Ymat, 33_pc, 11);
circuit.addGate(dd::Zmat, 34_pc, 29_nc, 11);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Smat, 15_pc, 4_nc, 18);
circuit.addGate(dd::Tdagmat, 22_pc, 8_pc, 20);
circuit.addGate(dd::Zmat, 9_nc, 25);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Ymat, 1_pc, 6_nc, 22);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tdagmat, 35_pc, 31);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Smat, 15_pc, 21_nc, 33);
circuit.addGate(dd::Ymat, 0_nc, 3);
circuit.addGate(dd::Ymat, 5_pc, 6);
circuit.addGate(dd::Ymat, 15_nc, 13_pc, 26);
circuit.addGate(dd::Tmat, 7_nc, 17);
circuit.addGate(dd::Hmat, 23_nc, 18_pc, 29);
circuit.addGate(dd::Xmat, 18_pc, 33);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Zmat, 28_nc, 15_nc, 24);
circuit.addGate(dd::Xmat, 35_nc, 2_nc, 17);
circuit.addGate(dd::Smat, 1_pc, 9);
circuit.addGate(dd::Ymat, 36);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Tdagmat, 34);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Xmat, 24_nc, 9_pc, 21);
circuit.addGate(dd::Tdagmat, 10_pc, 26);
circuit.addGate(dd::Smat, 19_pc, 14_pc, 12);
circuit.addGate(dd::Smat, 15_nc, 28_nc, 31);
circuit.addGate(dd::Tdagmat, 34);
circuit.addGate(dd::Tmat, 7_pc, 18_nc, 21);
circuit.addGate(dd::Zmat, 3_pc, 6);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Smat, 16_nc, 22);
circuit.addGate(dd::Xmat, 25_pc, 15_nc, 32);
circuit.addGate(dd::Xmat, 25_nc, 16_nc, 17);
circuit.addGate(dd::Smat, 27_pc, 24);
circuit.addGate(dd::Tmat, 35_nc, 20_nc, 12);
circuit.addGate(dd::Ymat, 6_nc, 14_pc, 2);
circuit.addGate(dd::Tmat, 12_nc, 9);
circuit.addGate(dd::Ymat, 26_nc, 35_pc, 11);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Smat, 4_nc, 1);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Hmat, 32_nc, 2_nc, 18);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Tdagmat, 1_pc, 28);
circuit.addGate(dd::Hmat, 28_pc, 30_nc, 3);
circuit.addGate(dd::Zmat, 0);
circuit.addGate(dd::Tdagmat, 13_nc, 18);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Smat, 9_pc, 35);
circuit.addGate(dd::Tdagmat, 35_pc, 18_pc, 16);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Smat, 8_pc, 12_nc, 18);
circuit.addGate(dd::Smat, 24);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Hmat, 0_nc, 28);
circuit.addGate(dd::Zmat, 30_pc, 19_pc, 32);
circuit.addGate(dd::Ymat, 29_nc, 33);
circuit.addGate(dd::Xmat, 15);
circuit.addGate(dd::Tdagmat, 14_pc, 29);
circuit.addGate(dd::Ymat, 24_nc, 13_pc, 32);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Smat, 30_pc, 33_pc, 15);
circuit.addGate(dd::Hmat, 5_nc, 10_nc, 27);
circuit.addGate(dd::Hmat, 18);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Smat, 26_nc, 13);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Tmat, 35_nc, 25_nc, 27);
circuit.addGate(dd::Ymat, 26_nc, 1);
circuit.addGate(dd::Zmat, 32_pc, 21_nc, 12);
circuit.addGate(dd::Tdagmat, 30_nc, 31);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Hmat, 17_pc, 36_pc, 8);
circuit.addGate(dd::Tdagmat, 6_nc, 20_nc, 31);
circuit.addGate(dd::Tdagmat, 19_nc, 25);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Tmat, 22_nc, 32_pc, 35);
circuit.addGate(dd::Xmat, 34_pc, 29);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tmat, 22_nc, 27);
circuit.addGate(dd::Zmat, 28);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tmat, 15_nc, 16);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Xmat, 20_nc, 15_pc, 13);
circuit.addGate(dd::Hmat, 36_nc, 7);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Smat, 32);
circuit.addGate(dd::Tdagmat, 33);
circuit.addGate(dd::Tdagmat, 19_pc, 9_nc, 22);
circuit.addGate(dd::Xmat, 5_nc, 2_nc, 12);
circuit.addGate(dd::Ymat, 31);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Zmat, 8_pc, 17);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Xmat, 27_pc, 16);
circuit.addGate(dd::Hmat, 15_nc, 35_pc, 5);
circuit.addGate(dd::Hmat, 3_nc, 11_pc, 20);
circuit.addGate(dd::Tdagmat, 26);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Smat, 28_nc, 8);
circuit.addGate(dd::Smat, 20_nc, 14_pc, 7);
circuit.addGate(dd::Tmat, 26_pc, 0_pc, 3);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Smat, 0_nc, 12_nc, 18);
circuit.addGate(dd::Tmat, 8);
circuit.addGate(dd::Tdagmat, 7_pc, 28_nc, 15);
circuit.addGate(dd::Tmat, 15_nc, 35);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Tdagmat, 8);
circuit.addGate(dd::Hmat, 9_nc, 23_pc, 8);
circuit.addGate(dd::Tdagmat, 12_pc, 21_nc, 5);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Zmat, 9_pc, 2_pc, 21);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tmat, 9_pc, 11_nc, 1);
circuit.addGate(dd::Ymat, 24_pc, 12);
circuit.addGate(dd::Tmat, 18_pc, 8_nc, 31);
circuit.addGate(dd::Smat, 14_pc, 32_pc, 13);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Smat, 30_nc, 5);
circuit.addGate(dd::Xmat, 21_pc, 24);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Smat, 23_pc, 17);
circuit.addGate(dd::Tmat, 17);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Smat, 21_pc, 17_nc, 10);
circuit.addGate(dd::Tmat, 13_nc, 3_pc, 36);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Tmat, 23_pc, 28);
circuit.addGate(dd::Smat, 30_pc, 10);
circuit.addGate(dd::Tdagmat, 3_nc, 0_nc, 4);
circuit.addGate(dd::Zmat, 15_pc, 24);
circuit.addGate(dd::Hmat, 36);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Ymat, 18_pc, 25_pc, 34);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Tmat, 17_pc, 28);
circuit.addGate(dd::Smat, 0_nc, 23);
circuit.addGate(dd::Tdagmat, 21_nc, 23);
circuit.addGate(dd::Zmat, 21);
circuit.addGate(dd::Ymat, 14_pc, 28_nc, 9);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Tdagmat, 26_pc, 30_nc, 35);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Zmat, 32_nc, 28_nc, 33);
circuit.addGate(dd::Xmat, 36);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Smat, 0_pc, 2);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Ymat, 28_pc, 30_nc, 18);
circuit.addGate(dd::Smat, 18_pc, 23);
circuit.addGate(dd::Smat, 17_pc, 14_nc, 13);
circuit.addGate(dd::Zmat, 15_pc, 17_pc, 0);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Xmat, 21_pc, 32);
circuit.addGate(dd::Hmat, 4_nc, 7);
circuit.addGate(dd::Smat, 17);
circuit.addGate(dd::Tmat, 34);
circuit.addGate(dd::Zmat, 13_nc, 24_pc, 10);
circuit.addGate(dd::Ymat, 12);
circuit.addGate(dd::Zmat, 32_pc, 0);
circuit.addGate(dd::Hmat, 9_pc, 32);
circuit.addGate(dd::Smat, 12_pc, 6);
circuit.addGate(dd::Zmat, 34_pc, 21_pc, 10);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Tdagmat, 33);
circuit.addGate(dd::Zmat, 7_nc, 12_nc, 28);
circuit.addGate(dd::Hmat, 15_pc, 21_nc, 26);
circuit.addGate(dd::Tmat, 19_nc, 4_nc, 21);
circuit.addGate(dd::Xmat, 29_pc, 5_nc, 11);
circuit.addGate(dd::Tdagmat, 6);
circuit.addGate(dd::Ymat, 34);
circuit.addGate(dd::Tmat, 34);
circuit.addGate(dd::Tdagmat, 29_pc, 18);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Xmat, 0_pc, 33_nc, 29);
circuit.addGate(dd::Xmat, 23_pc, 12_nc, 33);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Tdagmat, 33_nc, 4);
circuit.addGate(dd::Zmat, 35_nc, 15_pc, 24);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Hmat, 6_nc, 32);
circuit.addGate(dd::Tdagmat, 26_pc, 29);
circuit.addGate(dd::Zmat, 9_nc, 10);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Tmat, 27_nc, 23);
circuit.addGate(dd::Zmat, 7_nc, 22);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Zmat, 15_pc, 34_nc, 29);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Zmat, 15_pc, 28);
circuit.addGate(dd::Hmat, 29);
circuit.addGate(dd::Smat, 4_nc, 16_nc, 30);
circuit.addGate(dd::Ymat, 12_pc, 25_pc, 18);
circuit.addGate(dd::Zmat, 17_nc, 27);
circuit.addGate(dd::Tmat, 17_pc, 8_pc, 23);
circuit.addGate(dd::Smat, 34_nc, 27);
circuit.addGate(dd::Tdagmat, 23);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Smat, 13_pc, 20_nc, 16);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Smat, 16_nc, 7);
circuit.addGate(dd::Tdagmat, 18_nc, 29_nc, 33);
circuit.addGate(dd::Tmat, 4);
circuit.addGate(dd::Tdagmat, 12_nc, 36);
circuit.addGate(dd::Xmat, 18_nc, 2);
circuit.addGate(dd::Ymat, 14_pc, 31_pc, 1);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Tmat, 21_pc, 2_nc, 26);
circuit.addGate(dd::Ymat, 3_pc, 21_nc, 13);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Tmat, 34_nc, 0);
circuit.addGate(dd::Smat, 31_nc, 1_pc, 5);
circuit.addGate(dd::Tdagmat, 22_pc, 9);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Smat, 5_pc, 29_nc, 25);
circuit.addGate(dd::Tmat, 16_nc, 15_nc, 4);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Xmat, 13_pc, 4);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Tmat, 7_pc, 33_nc, 11);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Smat, 21_nc, 12);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Hmat, 33_nc, 1_pc, 5);
circuit.addGate(dd::Zmat, 18_nc, 11);
circuit.addGate(dd::Hmat, 6_pc, 2_nc, 19);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Hmat, 2_pc, 18);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Ymat, 12_nc, 33_nc, 18);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Smat, 7);
circuit.addGate(dd::Tmat, 18_nc, 10);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Ymat, 12_nc, 32_nc, 26);
circuit.addGate(dd::Smat, 29);
circuit.addGate(dd::Ymat, 7);
circuit.addGate(dd::Zmat, 33);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 38 qubis, containing 380 gates.
TEST(LimTest, hardCircuit_38) {
dd::QuantumCircuit circuit(38);

circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Hmat, 9);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Hmat, 35);
circuit.addGate(dd::Tdagmat, 22_pc, 16_nc, 26);
circuit.addGate(dd::Tdagmat, 14_nc, 22_nc, 9);
circuit.addGate(dd::Tmat, 26_pc, 23);
circuit.addGate(dd::Ymat, 16_nc, 4_nc, 25);
circuit.addGate(dd::Hmat, 36);
circuit.addGate(dd::Xmat, 16);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Zmat, 3_pc, 9_pc, 10);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Tdagmat, 14_pc, 26);
circuit.addGate(dd::Smat, 18_pc, 5_nc, 30);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Xmat, 34_pc, 8_pc, 15);
circuit.addGate(dd::Xmat, 4_pc, 17_nc, 15);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Smat, 31);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Smat, 23_nc, 37_nc, 26);
circuit.addGate(dd::Smat, 28);
circuit.addGate(dd::Ymat, 6_pc, 32);
circuit.addGate(dd::Ymat, 10);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Tdagmat, 31);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Smat, 22);
circuit.addGate(dd::Tmat, 10);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Tdagmat, 28);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 31_pc, 29_nc, 21);
circuit.addGate(dd::Xmat, 24_pc, 0);
circuit.addGate(dd::Zmat, 17);
circuit.addGate(dd::Tdagmat, 10_pc, 35);
circuit.addGate(dd::Zmat, 3_nc, 7_pc, 36);
circuit.addGate(dd::Tdagmat, 15_pc, 22_pc, 5);
circuit.addGate(dd::Zmat, 13_nc, 27);
circuit.addGate(dd::Tdagmat, 6_nc, 8);
circuit.addGate(dd::Tmat, 30_nc, 16_pc, 32);
circuit.addGate(dd::Ymat, 4_nc, 20);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Smat, 1_pc, 2);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Zmat, 11_pc, 27);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Smat, 18_pc, 33_nc, 5);
circuit.addGate(dd::Ymat, 4_pc, 31);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Tdagmat, 33);
circuit.addGate(dd::Tdagmat, 4_pc, 24_nc, 11);
circuit.addGate(dd::Smat, 4_nc, 28);
circuit.addGate(dd::Hmat, 26_pc, 14);
circuit.addGate(dd::Zmat, 33_nc, 21_nc, 0);
circuit.addGate(dd::Tdagmat, 11_pc, 14_nc, 30);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Xmat, 14_nc, 32);
circuit.addGate(dd::Tdagmat, 17_nc, 29);
circuit.addGate(dd::Zmat, 29_nc, 34);
circuit.addGate(dd::Tdagmat, 31);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Zmat, 4_pc, 34_nc, 25);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Smat, 26_pc, 9);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Ymat, 22_nc, 11_nc, 1);
circuit.addGate(dd::Xmat, 37);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tmat, 5);
circuit.addGate(dd::Smat, 17_nc, 7_pc, 25);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Tdagmat, 33_pc, 28_nc, 6);
circuit.addGate(dd::Ymat, 26_pc, 22);
circuit.addGate(dd::Smat, 4);
circuit.addGate(dd::Ymat, 16_nc, 0_pc, 10);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Zmat, 13_nc, 7);
circuit.addGate(dd::Smat, 25);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Smat, 37);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Hmat, 5_pc, 7_pc, 4);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Zmat, 19_nc, 6);
circuit.addGate(dd::Ymat, 7_nc, 37);
circuit.addGate(dd::Xmat, 6_pc, 34_nc, 2);
circuit.addGate(dd::Smat, 6_nc, 34_pc, 23);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Smat, 23_pc, 27_pc, 26);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Xmat, 34_pc, 21_nc, 15);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tmat, 29);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Zmat, 17_nc, 16);
circuit.addGate(dd::Xmat, 27_pc, 2);
circuit.addGate(dd::Hmat, 37);
circuit.addGate(dd::Tmat, 11_nc, 10);
circuit.addGate(dd::Tmat, 13_pc, 22);
circuit.addGate(dd::Smat, 35_nc, 3);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Tdagmat, 37_pc, 22);
circuit.addGate(dd::Tdagmat, 10);
circuit.addGate(dd::Tmat, 35_nc, 33_pc, 20);
circuit.addGate(dd::Zmat, 12_nc, 5);
circuit.addGate(dd::Xmat, 10);
circuit.addGate(dd::Smat, 11);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Zmat, 28_nc, 33);
circuit.addGate(dd::Hmat, 26_nc, 25);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Smat, 0);
circuit.addGate(dd::Ymat, 26);
circuit.addGate(dd::Tmat, 37);
circuit.addGate(dd::Smat, 8);
circuit.addGate(dd::Xmat, 19_pc, 20_pc, 24);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Smat, 12_pc, 22_pc, 26);
circuit.addGate(dd::Tdagmat, 11_nc, 25);
circuit.addGate(dd::Xmat, 11_pc, 14);
circuit.addGate(dd::Zmat, 20_nc, 4);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Zmat, 32_nc, 36_nc, 3);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Tdagmat, 10_nc, 28);
circuit.addGate(dd::Smat, 24_nc, 26_pc, 37);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Tmat, 37_pc, 26);
circuit.addGate(dd::Ymat, 31);
circuit.addGate(dd::Xmat, 33_nc, 27_pc, 14);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Ymat, 21_nc, 6);
circuit.addGate(dd::Zmat, 11_nc, 19);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Tdagmat, 7);
circuit.addGate(dd::Hmat, 25_nc, 30_nc, 14);
circuit.addGate(dd::Tdagmat, 16_pc, 8);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 11_nc, 3_pc, 9);
circuit.addGate(dd::Hmat, 12_pc, 5);
circuit.addGate(dd::Tdagmat, 4);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Tmat, 20_pc, 37);
circuit.addGate(dd::Tdagmat, 32_nc, 36);
circuit.addGate(dd::Tdagmat, 6_nc, 25);
circuit.addGate(dd::Ymat, 1_pc, 19);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Smat, 37_pc, 17);
circuit.addGate(dd::Tdagmat, 27_pc, 5);
circuit.addGate(dd::Ymat, 27_pc, 28_pc, 3);
circuit.addGate(dd::Xmat, 0_pc, 27);
circuit.addGate(dd::Zmat, 29_nc, 6_pc, 23);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Tdagmat, 1_nc, 7_pc, 34);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Ymat, 0_nc, 33);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Hmat, 31_pc, 1);
circuit.addGate(dd::Zmat, 36);
circuit.addGate(dd::Ymat, 29_pc, 23_nc, 0);
circuit.addGate(dd::Zmat, 32_nc, 36_pc, 6);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Xmat, 24);
circuit.addGate(dd::Hmat, 35_nc, 4);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Tdagmat, 11);
circuit.addGate(dd::Ymat, 33_nc, 18);
circuit.addGate(dd::Zmat, 14);
circuit.addGate(dd::Hmat, 12);
circuit.addGate(dd::Hmat, 4_pc, 34);
circuit.addGate(dd::Ymat, 19_pc, 4_nc, 9);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Zmat, 23_nc, 16_pc, 4);
circuit.addGate(dd::Zmat, 22_pc, 16_nc, 32);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 28_pc, 13);
circuit.addGate(dd::Zmat, 15_pc, 29);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Tdagmat, 5_pc, 12_pc, 26);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Smat, 11_pc, 17_nc, 23);
circuit.addGate(dd::Xmat, 28_nc, 14_pc, 12);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Tdagmat, 3);
circuit.addGate(dd::Smat, 14_pc, 8);
circuit.addGate(dd::Xmat, 17_nc, 28_nc, 15);
circuit.addGate(dd::Xmat, 37);
circuit.addGate(dd::Ymat, 1_pc, 11);
circuit.addGate(dd::Xmat, 35_nc, 27);
circuit.addGate(dd::Smat, 31);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Xmat, 19_nc, 10_pc, 33);
circuit.addGate(dd::Hmat, 2_pc, 24_pc, 16);
circuit.addGate(dd::Smat, 16);
circuit.addGate(dd::Hmat, 34_nc, 26_pc, 21);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Zmat, 20_nc, 27);
circuit.addGate(dd::Hmat, 30);
circuit.addGate(dd::Ymat, 26_nc, 25_pc, 8);
circuit.addGate(dd::Smat, 22_nc, 0);
circuit.addGate(dd::Smat, 34);
circuit.addGate(dd::Zmat, 18_nc, 8_pc, 2);
circuit.addGate(dd::Hmat, 22);
circuit.addGate(dd::Ymat, 30);
circuit.addGate(dd::Ymat, 26_nc, 0);
circuit.addGate(dd::Hmat, 8_nc, 37);
circuit.addGate(dd::Smat, 15_pc, 5_nc, 36);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Zmat, 8);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Tdagmat, 31_pc, 8);
circuit.addGate(dd::Ymat, 31_pc, 13_pc, 3);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Hmat, 23_pc, 8);
circuit.addGate(dd::Zmat, 19_pc, 30_pc, 21);
circuit.addGate(dd::Zmat, 15_pc, 26);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Ymat, 11_nc, 29_nc, 7);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Xmat, 16_pc, 17);
circuit.addGate(dd::Ymat, 7_pc, 36);
circuit.addGate(dd::Xmat, 16_pc, 27_pc, 7);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Zmat, 13_nc, 17_pc, 32);
circuit.addGate(dd::Tmat, 24_nc, 33_pc, 29);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Ymat, 14);
circuit.addGate(dd::Tmat, 6_nc, 28_nc, 9);
circuit.addGate(dd::Smat, 10);
circuit.addGate(dd::Hmat, 29_nc, 0_nc, 23);
circuit.addGate(dd::Ymat, 24);
circuit.addGate(dd::Ymat, 32_pc, 24);
circuit.addGate(dd::Ymat, 33_nc, 28_pc, 24);
circuit.addGate(dd::Xmat, 14);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Tdagmat, 33_pc, 26);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Ymat, 30_pc, 37_nc, 3);
circuit.addGate(dd::Smat, 27_nc, 32);
circuit.addGate(dd::Tmat, 19_nc, 35_pc, 23);
circuit.addGate(dd::Tdagmat, 1);
circuit.addGate(dd::Hmat, 22_nc, 27_pc, 34);
circuit.addGate(dd::Zmat, 31);
circuit.addGate(dd::Hmat, 1);
circuit.addGate(dd::Tmat, 0_nc, 9_pc, 33);
circuit.addGate(dd::Tmat, 25);
circuit.addGate(dd::Tdagmat, 23_pc, 22);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Tmat, 19);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Xmat, 19);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Smat, 16_pc, 6);
circuit.addGate(dd::Zmat, 28_pc, 4);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Xmat, 18_pc, 19_nc, 30);
circuit.addGate(dd::Tdagmat, 16_nc, 18_nc, 8);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Ymat, 7_pc, 4_pc, 2);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Tdagmat, 13);
circuit.addGate(dd::Hmat, 10);
circuit.addGate(dd::Ymat, 18);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Zmat, 23_nc, 11_nc, 27);
circuit.addGate(dd::Tmat, 20_pc, 30_pc, 7);
circuit.addGate(dd::Ymat, 2_pc, 30_nc, 11);
circuit.addGate(dd::Smat, 22_pc, 29);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Smat, 16_pc, 15_pc, 8);
circuit.addGate(dd::Smat, 15_nc, 5_nc, 30);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Smat, 20_pc, 33);
circuit.addGate(dd::Zmat, 3);
circuit.addGate(dd::Zmat, 30);
circuit.addGate(dd::Hmat, 35_nc, 19);
circuit.addGate(dd::Tmat, 0);
circuit.addGate(dd::Zmat, 33_pc, 0_nc, 28);
circuit.addGate(dd::Smat, 35_pc, 20_nc, 10);
circuit.addGate(dd::Tmat, 11);
circuit.addGate(dd::Ymat, 3);
circuit.addGate(dd::Smat, 36_pc, 0);
circuit.addGate(dd::Hmat, 4_pc, 14);
circuit.addGate(dd::Tdagmat, 34_pc, 33_pc, 0);
circuit.addGate(dd::Tmat, 10_nc, 4);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Xmat, 33_pc, 16_pc, 18);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Tmat, 6_pc, 9_pc, 23);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Tdagmat, 25_nc, 15);
circuit.addGate(dd::Xmat, 36_pc, 16_nc, 17);
circuit.addGate(dd::Tdagmat, 34_pc, 6);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 1_pc, 0_pc, 4);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Smat, 9_nc, 14);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Ymat, 4_nc, 14_nc, 7);
circuit.addGate(dd::Zmat, 6);
circuit.addGate(dd::Zmat, 9);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Tdagmat, 33_nc, 27_pc, 10);
circuit.addGate(dd::Tmat, 34);
circuit.addGate(dd::Smat, 35_pc, 5);
circuit.addGate(dd::Ymat, 5_nc, 21);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Zmat, 5);
circuit.addGate(dd::Tdagmat, 3_nc, 17_nc, 31);
circuit.addGate(dd::Tdagmat, 9);
circuit.addGate(dd::Xmat, 17_nc, 0_nc, 9);
circuit.addGate(dd::Ymat, 23);
circuit.addGate(dd::Smat, 6);
circuit.addGate(dd::Tdagmat, 36);
circuit.addGate(dd::Tdagmat, 19);
circuit.addGate(dd::Tdagmat, 31_nc, 12);
circuit.addGate(dd::Zmat, 31_nc, 1);
circuit.addGate(dd::Xmat, 37_pc, 17);
circuit.addGate(dd::Xmat, 22_pc, 0);
circuit.addGate(dd::Tdagmat, 1_pc, 20);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Zmat, 33_pc, 2);
circuit.addGate(dd::Xmat, 23_nc, 28);
circuit.addGate(dd::Tdagmat, 7_pc, 25);
circuit.addGate(dd::Smat, 14);
circuit.addGate(dd::Tdagmat, 28_pc, 1_nc, 25);
circuit.addGate(dd::Ymat, 21);
circuit.addGate(dd::Tmat, 24);
circuit.addGate(dd::Zmat, 28_pc, 13_pc, 19);
circuit.addGate(dd::Zmat, 10);
circuit.addGate(dd::Zmat, 10_pc, 9_pc, 33);
circuit.addGate(dd::Ymat, 1_pc, 18);

raceCircuitQMDDvsLIMDD(circuit);
}

// Randomly generated circuit on 39 qubis, containing 390 gates.
TEST(LimTest, hardCircuit_39) {
dd::QuantumCircuit circuit(39);

circuit.addGate(dd::Hmat, 3);
circuit.addGate(dd::Hmat, 4);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Hmat, 14);
circuit.addGate(dd::Hmat, 15);
circuit.addGate(dd::Hmat, 16);
circuit.addGate(dd::Hmat, 20);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 24);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Hmat, 28);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Hmat, 35);
circuit.addGate(dd::Hmat, 37);
circuit.addGate(dd::Hmat, 38);
circuit.addGate(dd::Smat, 36_nc, 15_nc, 32);
circuit.addGate(dd::Ymat, 2);
circuit.addGate(dd::Tmat, 17_nc, 6);
circuit.addGate(dd::Hmat, 34_nc, 18_nc, 28);
circuit.addGate(dd::Hmat, 11);
circuit.addGate(dd::Ymat, 14_pc, 20);
circuit.addGate(dd::Xmat, 17_pc, 23_nc, 0);
circuit.addGate(dd::Tmat, 1_pc, 17_nc, 34);
circuit.addGate(dd::Ymat, 0);
circuit.addGate(dd::Hmat, 3_pc, 14_pc, 31);
circuit.addGate(dd::Tdagmat, 34_pc, 16_pc, 13);
circuit.addGate(dd::Zmat, 33_nc, 17_nc, 32);
circuit.addGate(dd::Tdagmat, 26_nc, 7_nc, 18);
circuit.addGate(dd::Hmat, 31_nc, 28);
circuit.addGate(dd::Xmat, 31);
circuit.addGate(dd::Smat, 9);
circuit.addGate(dd::Tdagmat, 18);
circuit.addGate(dd::Ymat, 33_pc, 11);
circuit.addGate(dd::Ymat, 8);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Ymat, 34);
circuit.addGate(dd::Hmat, 15_pc, 34);
circuit.addGate(dd::Zmat, 3_pc, 21);
circuit.addGate(dd::Hmat, 2);
circuit.addGate(dd::Tdagmat, 25_pc, 24);
circuit.addGate(dd::Ymat, 11_pc, 28);
circuit.addGate(dd::Tdagmat, 10_pc, 9);
circuit.addGate(dd::Zmat, 12_pc, 35);
circuit.addGate(dd::Smat, 23);
circuit.addGate(dd::Zmat, 23_pc, 27_pc, 12);
circuit.addGate(dd::Tmat, 30);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Smat, 34);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Xmat, 14_nc, 10_nc, 16);
circuit.addGate(dd::Smat, 38);
circuit.addGate(dd::Smat, 23_nc, 27_pc, 11);
circuit.addGate(dd::Smat, 25_nc, 6);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Smat, 8_nc, 31);
circuit.addGate(dd::Tmat, 22);
circuit.addGate(dd::Tmat, 2_pc, 6);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Hmat, 31_nc, 1);
circuit.addGate(dd::Tmat, 18_pc, 3);
circuit.addGate(dd::Zmat, 25_nc, 34_pc, 2);
circuit.addGate(dd::Tmat, 7_nc, 34_nc, 35);
circuit.addGate(dd::Hmat, 18_nc, 11);
circuit.addGate(dd::Zmat, 20);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Ymat, 11);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Smat, 11_pc, 16);
circuit.addGate(dd::Tmat, 7_pc, 9);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Tmat, 27_nc, 37);
circuit.addGate(dd::Xmat, 26_pc, 20);
circuit.addGate(dd::Xmat, 30_nc, 16);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Smat, 2_nc, 25);
circuit.addGate(dd::Tmat, 8_nc, 9_nc, 12);
circuit.addGate(dd::Xmat, 27_nc, 15_pc, 23);
circuit.addGate(dd::Hmat, 2_pc, 11);
circuit.addGate(dd::Smat, 30_nc, 15);
circuit.addGate(dd::Ymat, 34_pc, 26_pc, 21);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 5_nc, 17);
circuit.addGate(dd::Tmat, 23);
circuit.addGate(dd::Zmat, 36_pc, 15);
circuit.addGate(dd::Smat, 28_nc, 11_pc, 38);
circuit.addGate(dd::Hmat, 17);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Zmat, 19_pc, 10);
circuit.addGate(dd::Tmat, 22_nc, 36_pc, 5);
circuit.addGate(dd::Hmat, 8);
circuit.addGate(dd::Tmat, 35);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Smat, 27_nc, 7);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Smat, 33_nc, 21);
circuit.addGate(dd::Smat, 30);
circuit.addGate(dd::Tmat, 15_pc, 25_nc, 32);
circuit.addGate(dd::Hmat, 35_pc, 34_nc, 12);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Hmat, 3_nc, 35_nc, 20);
circuit.addGate(dd::Xmat, 32);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Ymat, 11_nc, 31);
circuit.addGate(dd::Tmat, 9_pc, 8_pc, 23);
circuit.addGate(dd::Ymat, 5);
circuit.addGate(dd::Tdagmat, 1_pc, 16);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tdagmat, 17);
circuit.addGate(dd::Tmat, 27);
circuit.addGate(dd::Xmat, 13);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Tmat, 19_pc, 22);
circuit.addGate(dd::Zmat, 11_pc, 37_pc, 24);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Hmat, 26);
circuit.addGate(dd::Xmat, 8_pc, 21);
circuit.addGate(dd::Ymat, 8_nc, 35);
circuit.addGate(dd::Smat, 5_nc, 28);
circuit.addGate(dd::Smat, 26);
circuit.addGate(dd::Ymat, 2_pc, 18_pc, 13);
circuit.addGate(dd::Tdagmat, 12_pc, 29_pc, 21);
circuit.addGate(dd::Tmat, 9);
circuit.addGate(dd::Ymat, 24_pc, 16_nc, 6);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Xmat, 35_pc, 10_pc, 8);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Smat, 4_nc, 30);
circuit.addGate(dd::Hmat, 37_nc, 28_pc, 2);
circuit.addGate(dd::Tdagmat, 33_pc, 24);
circuit.addGate(dd::Tmat, 26_pc, 2);
circuit.addGate(dd::Ymat, 36_nc, 21_nc, 31);
circuit.addGate(dd::Zmat, 16);
circuit.addGate(dd::Tmat, 5_nc, 38_pc, 7);
circuit.addGate(dd::Tdagmat, 29);
circuit.addGate(dd::Tmat, 24_pc, 36);
circuit.addGate(dd::Ymat, 8_nc, 23);
circuit.addGate(dd::Ymat, 29);
circuit.addGate(dd::Xmat, 17);
circuit.addGate(dd::Ymat, 32);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Xmat, 12);
circuit.addGate(dd::Smat, 18);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Zmat, 24);
circuit.addGate(dd::Hmat, 16_pc, 13_nc, 2);
circuit.addGate(dd::Xmat, 34_nc, 15);
circuit.addGate(dd::Smat, 37_pc, 2_pc, 8);
circuit.addGate(dd::Zmat, 10_pc, 21);
circuit.addGate(dd::Tdagmat, 34);
circuit.addGate(dd::Zmat, 13_pc, 37_pc, 36);
circuit.addGate(dd::Xmat, 35);
circuit.addGate(dd::Smat, 16_nc, 19);
circuit.addGate(dd::Tmat, 5_nc, 15);
circuit.addGate(dd::Tmat, 1);
circuit.addGate(dd::Xmat, 27);
circuit.addGate(dd::Xmat, 1);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Xmat, 3_pc, 24);
circuit.addGate(dd::Hmat, 32);
circuit.addGate(dd::Tdagmat, 36);
circuit.addGate(dd::Zmat, 28_pc, 30);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Xmat, 33_pc, 31_pc, 9);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Xmat, 32);
circuit.addGate(dd::Xmat, 11);
circuit.addGate(dd::Tdagmat, 37);
circuit.addGate(dd::Tmat, 31_nc, 1);
circuit.addGate(dd::Ymat, 4);
circuit.addGate(dd::Ymat, 9_nc, 27_nc, 7);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Tmat, 22_pc, 21_pc, 4);
circuit.addGate(dd::Hmat, 9_pc, 32_nc, 7);
circuit.addGate(dd::Xmat, 36_nc, 29_pc, 16);
circuit.addGate(dd::Zmat, 33_pc, 4_pc, 17);
circuit.addGate(dd::Ymat, 13);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Ymat, 20_nc, 23_nc, 11);
circuit.addGate(dd::Smat, 1);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Tmat, 8_nc, 7_pc, 30);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Zmat, 2_pc, 28_nc, 18);
circuit.addGate(dd::Xmat, 26);
circuit.addGate(dd::Hmat, 34);
circuit.addGate(dd::Tmat, 13_pc, 24);
circuit.addGate(dd::Xmat, 30_pc, 32);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Hmat, 22_pc, 12);
circuit.addGate(dd::Xmat, 0);
circuit.addGate(dd::Hmat, 31);
circuit.addGate(dd::Smat, 36);
circuit.addGate(dd::Zmat, 26_nc, 33);
circuit.addGate(dd::Ymat, 4_pc, 13);
circuit.addGate(dd::Hmat, 6);
circuit.addGate(dd::Tmat, 13);
circuit.addGate(dd::Ymat, 4_pc, 27);
circuit.addGate(dd::Ymat, 1);
circuit.addGate(dd::Tdagmat, 20);
circuit.addGate(dd::Tmat, 15);
circuit.addGate(dd::Zmat, 19_nc, 26);
circuit.addGate(dd::Smat, 12);
circuit.addGate(dd::Tdagmat, 38_pc, 3);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Smat, 20);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Zmat, 30);
circuit.addGate(dd::Tdagmat, 22_pc, 0_nc, 7);
circuit.addGate(dd::Tmat, 7_nc, 37);
circuit.addGate(dd::Hmat, 0);
circuit.addGate(dd::Tdagmat, 16);
circuit.addGate(dd::Tmat, 27_pc, 28);
circuit.addGate(dd::Smat, 10_nc, 4_pc, 1);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Zmat, 13_pc, 24_nc, 14);
circuit.addGate(dd::Zmat, 26);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Tmat, 14_pc, 31);
circuit.addGate(dd::Ymat, 17);
circuit.addGate(dd::Ymat, 16);
circuit.addGate(dd::Ymat, 38);
circuit.addGate(dd::Hmat, 29_nc, 16_pc, 12);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Zmat, 37);
circuit.addGate(dd::Zmat, 1_pc, 14);
circuit.addGate(dd::Hmat, 37);
circuit.addGate(dd::Tdagmat, 37_pc, 23);
circuit.addGate(dd::Tdagmat, 22_nc, 28);
circuit.addGate(dd::Smat, 37_pc, 5_pc, 19);
circuit.addGate(dd::Tmat, 27);
circuit.addGate(dd::Xmat, 7);
circuit.addGate(dd::Tdagmat, 29_pc, 4_pc, 1);
circuit.addGate(dd::Hmat, 5);
circuit.addGate(dd::Smat, 33_pc, 9_pc, 22);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Smat, 24_pc, 8);
circuit.addGate(dd::Tmat, 21_nc, 17_pc, 31);
circuit.addGate(dd::Xmat, 5);
circuit.addGate(dd::Hmat, 21_nc, 12_pc, 10);
circuit.addGate(dd::Zmat, 15);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Smat, 4_nc, 30);
circuit.addGate(dd::Ymat, 18_nc, 13_pc, 36);
circuit.addGate(dd::Smat, 21);
circuit.addGate(dd::Tmat, 3_pc, 17_pc, 21);
circuit.addGate(dd::Xmat, 35);
circuit.addGate(dd::Xmat, 18);
circuit.addGate(dd::Hmat, 37);
circuit.addGate(dd::Xmat, 2);
circuit.addGate(dd::Tdagmat, 27);
circuit.addGate(dd::Hmat, 7);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Ymat, 15);
circuit.addGate(dd::Hmat, 38_nc, 20);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Xmat, 26_nc, 37);
circuit.addGate(dd::Tmat, 17_nc, 22_nc, 28);
circuit.addGate(dd::Tmat, 26);
circuit.addGate(dd::Xmat, 0_nc, 14_pc, 8);
circuit.addGate(dd::Xmat, 18_pc, 36);
circuit.addGate(dd::Zmat, 7);
circuit.addGate(dd::Xmat, 33);
circuit.addGate(dd::Smat, 17_nc, 11);
circuit.addGate(dd::Hmat, 31_nc, 30);
circuit.addGate(dd::Zmat, 0_pc, 25);
circuit.addGate(dd::Tdagmat, 33_pc, 25_pc, 3);
circuit.addGate(dd::Hmat, 32_pc, 13_pc, 9);
circuit.addGate(dd::Zmat, 14_pc, 33);
circuit.addGate(dd::Smat, 20_pc, 6);
circuit.addGate(dd::Tmat, 20);
circuit.addGate(dd::Zmat, 12);
circuit.addGate(dd::Xmat, 8_pc, 19_pc, 6);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Hmat, 33);
circuit.addGate(dd::Tmat, 28);
circuit.addGate(dd::Zmat, 18_nc, 30_nc, 11);
circuit.addGate(dd::Xmat, 29_nc, 19_pc, 4);
circuit.addGate(dd::Hmat, 27);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Hmat, 19_pc, 27_nc, 18);
circuit.addGate(dd::Hmat, 29_pc, 21);
circuit.addGate(dd::Zmat, 1);
circuit.addGate(dd::Xmat, 16_pc, 29_pc, 26);
circuit.addGate(dd::Tmat, 8_nc, 7_nc, 10);
circuit.addGate(dd::Ymat, 25);
circuit.addGate(dd::Tdagmat, 14_pc, 1_nc, 20);
circuit.addGate(dd::Zmat, 17_nc, 16_pc, 30);
circuit.addGate(dd::Tmat, 0_pc, 25_pc, 29);
circuit.addGate(dd::Tmat, 12_nc, 22);
circuit.addGate(dd::Tmat, 2);
circuit.addGate(dd::Smat, 13);
circuit.addGate(dd::Tmat, 3);
circuit.addGate(dd::Tmat, 1_nc, 29_nc, 33);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Zmat, 11_pc, 38);
circuit.addGate(dd::Zmat, 15_pc, 29);
circuit.addGate(dd::Xmat, 36);
circuit.addGate(dd::Ymat, 9);
circuit.addGate(dd::Zmat, 37_nc, 26);
circuit.addGate(dd::Tdagmat, 26_pc, 2_pc, 17);
circuit.addGate(dd::Xmat, 4);
circuit.addGate(dd::Smat, 33);
circuit.addGate(dd::Hmat, 25);
circuit.addGate(dd::Smat, 19);
circuit.addGate(dd::Tmat, 36_nc, 0_pc, 26);
circuit.addGate(dd::Zmat, 22_nc, 31_nc, 5);
circuit.addGate(dd::Xmat, 29);
circuit.addGate(dd::Tmat, 33);
circuit.addGate(dd::Zmat, 27);
circuit.addGate(dd::Tdagmat, 14);
circuit.addGate(dd::Zmat, 22);
circuit.addGate(dd::Tmat, 35_pc, 21_nc, 10);
circuit.addGate(dd::Hmat, 23);
circuit.addGate(dd::Tdagmat, 35);
circuit.addGate(dd::Zmat, 6_pc, 33);
circuit.addGate(dd::Tmat, 10_nc, 31_pc, 19);
circuit.addGate(dd::Hmat, 36);
circuit.addGate(dd::Xmat, 31_pc, 38_pc, 7);
circuit.addGate(dd::Tmat, 37);
circuit.addGate(dd::Smat, 31_pc, 3_nc, 8);
circuit.addGate(dd::Smat, 17_nc, 27_pc, 6);
circuit.addGate(dd::Hmat, 31_pc, 35);
circuit.addGate(dd::Zmat, 23);
circuit.addGate(dd::Tmat, 18_pc, 32_nc, 31);
circuit.addGate(dd::Zmat, 23_pc, 14_nc, 36);
circuit.addGate(dd::Xmat, 37);
circuit.addGate(dd::Tmat, 36);
circuit.addGate(dd::Xmat, 24_pc, 27_nc, 32);
circuit.addGate(dd::Hmat, 27_nc, 37_pc, 30);
circuit.addGate(dd::Xmat, 23);
circuit.addGate(dd::Tdagmat, 0);
circuit.addGate(dd::Smat, 2);
circuit.addGate(dd::Ymat, 26_pc, 4_nc, 29);
circuit.addGate(dd::Ymat, 20_pc, 28_nc, 22);
circuit.addGate(dd::Tdagmat, 25);
circuit.addGate(dd::Xmat, 8);
circuit.addGate(dd::Xmat, 8_nc, 15_nc, 16);
circuit.addGate(dd::Tmat, 27_nc, 12);
circuit.addGate(dd::Tdagmat, 36);
circuit.addGate(dd::Tmat, 18_pc, 9);
circuit.addGate(dd::Tmat, 18);
circuit.addGate(dd::Hmat, 34_pc, 23_pc, 5);
circuit.addGate(dd::Zmat, 25);
circuit.addGate(dd::Tdagmat, 31_pc, 5);
circuit.addGate(dd::Xmat, 13_pc, 33);
circuit.addGate(dd::Zmat, 22_pc, 3);
circuit.addGate(dd::Ymat, 31_nc, 26_pc, 37);
circuit.addGate(dd::Tdagmat, 12);
circuit.addGate(dd::Hmat, 30_pc, 13);
circuit.addGate(dd::Xmat, 9);
circuit.addGate(dd::Hmat, 19);
circuit.addGate(dd::Tdagmat, 24);
circuit.addGate(dd::Xmat, 20);
circuit.addGate(dd::Smat, 19_pc, 32);
circuit.addGate(dd::Tdagmat, 28_nc, 14_pc, 34);
circuit.addGate(dd::Hmat, 33_pc, 27);
circuit.addGate(dd::Tmat, 15_pc, 8_pc, 37);
circuit.addGate(dd::Zmat, 13_pc, 16_pc, 20);
circuit.addGate(dd::Zmat, 35);
circuit.addGate(dd::Tmat, 35_nc, 2_nc, 25);
circuit.addGate(dd::Ymat, 5_nc, 35_pc, 38);
circuit.addGate(dd::Zmat, 2);
circuit.addGate(dd::Hmat, 13_nc, 34_nc, 11);
circuit.addGate(dd::Tmat, 6_pc, 12_nc, 19);
circuit.addGate(dd::Zmat, 29);
circuit.addGate(dd::Smat, 22_pc, 17);
circuit.addGate(dd::Hmat, 13);
circuit.addGate(dd::Tdagmat, 5);
circuit.addGate(dd::Smat, 5);
circuit.addGate(dd::Ymat, 19);
circuit.addGate(dd::Hmat, 21_nc, 3);
circuit.addGate(dd::Xmat, 38_nc, 34);
circuit.addGate(dd::Ymat, 12_pc, 5);
circuit.addGate(dd::Tmat, 16);
circuit.addGate(dd::Zmat, 14);

raceCircuitQMDDvsLIMDD(circuit);
}